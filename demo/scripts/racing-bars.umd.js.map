{"version":3,"file":"racing-bars.umd.js","sources":["../../src/lib/utils.ts","../../src/lib/dates.ts","../../src/lib/load-data.ts","../../src/lib/race.ts","../../src/lib/styles/style-inject.ts","../../src/lib/renderer.ts","../../src/lib/ticker.ts","../../src/lib/data-utils.ts"],"sourcesContent":["import * as d3 from './d3';\n\nimport { Data } from './models';\n\nexport function getColor(d: Data, disableGroupColors: boolean, colorSeed: string) {\n  const nameseed = d.group && !disableGroupColors ? d.group : d.name;\n  const seed = nameseed + colorSeed;\n  return d3.hsl(random(seed) * 360, 0.75, 0.75);\n}\n\nexport function zeroPad(n: string, w: number) {\n  while (n.toString().length < w) {\n    n = '0' + n;\n  }\n  return n;\n}\n\nexport function random(seedStr: string) {\n  function toNumbers(s: string) {\n    let nums = '';\n    for (let i = 0; i < s.length; i++) {\n      nums += zeroPad(String(s.charCodeAt(i)), 3);\n    }\n    return nums;\n  }\n\n  const seed = toNumbers(seedStr);\n  const x = Math.sin(+seed) * 10000;\n  return x - Math.floor(x);\n}\n\nexport function randomString(prefix: string, n: number) {\n  const rnd = Array(3)\n    .fill(null)\n    .map(() => Math.random().toString(36).substr(2))\n    .join('');\n  return prefix + rnd.slice(-n);\n}\n\nexport function generateId(prefix = 'racingbars', n = 8) {\n  return randomString(prefix, n);\n}\n\nexport function getHeight(element: HTMLElement, minHeight: number, height?: string) {\n  let newHeight;\n  if (!height) {\n    newHeight = element.getBoundingClientRect().height;\n  } else if (String(height).startsWith('window')) {\n    const scale = +height.split('*')[1] || 1;\n    newHeight = window.innerHeight * scale;\n  } else {\n    newHeight = +height;\n  }\n  return newHeight > minHeight ? newHeight : minHeight;\n}\n\nexport function getWidth(element: HTMLElement, minWidth: number, width?: string) {\n  let newWidth;\n  if (!width) {\n    newWidth = element.getBoundingClientRect().width;\n  } else if (String(width).startsWith('window')) {\n    const scale = +width.split('*')[1] || 1;\n    newWidth = window.innerWidth * scale;\n  } else {\n    newWidth = +width;\n  }\n  return newWidth > minWidth ? newWidth : minWidth;\n}\n","import { Data } from './models';\nimport { zeroPad } from './utils';\n\nexport function getDates(data: Data[]) {\n  const uniqueDates = new Set<string>();\n  data.forEach((d) => {\n    uniqueDates.add(d.date);\n  });\n  return Array.from(uniqueDates).sort();\n}\n\nexport function filterDates(data: Data[], startDate: string, endDate: string) {\n  return data\n    .filter((d) => (startDate ? d.date >= startDate : true))\n    .filter((d) => (endDate ? d.date <= endDate : true));\n}\n\nexport function getDateString(inputDate: string | Date) {\n  const date = new Date(inputDate);\n  if (isNaN(+date)) {\n    throw new Error(`\"${inputDate}\" is not a valid date`);\n  }\n\n  const year = date.getFullYear();\n\n  let month = (1 + date.getMonth()).toString();\n  month = zeroPad(month, 2);\n\n  let day = date.getDate().toString();\n  day = zeroPad(day, 2);\n\n  return `${year}${month}${day}`;\n}\n\nexport function formatDate(dateStr: string, format: string) {\n  const year = dateStr.slice(0, 4);\n  const month = dateStr.slice(4, 6);\n  const day = dateStr.slice(6, 8);\n  const date = new Date(`${year}-${month}-${day}`);\n  const weekDayIndex = String(date.getDay());\n  const monthNames: { [key: string]: string } = {\n    '01': 'Jan',\n    '02': 'Feb',\n    '03': 'Mar',\n    '04': 'Apr',\n    '05': 'May',\n    '06': 'Jun',\n    '07': 'Jul',\n    '08': 'Aug',\n    '09': 'Sep',\n    '10': 'Oct',\n    '11': 'Nov',\n    '12': 'Dec',\n  };\n\n  const weekDays: { [key: string]: string } = {\n    '0': 'Sun',\n    '1': 'Mon',\n    '2': 'Tue',\n    '3': 'Wed',\n    '4': 'Thu',\n    '5': 'Fri',\n    '6': 'Sat',\n  };\n\n  return format\n    .replace('MMM', monthNames[month])\n    .replace('DDD', weekDays[weekDayIndex])\n    .replace('YYYY', year)\n    .replace('MM', month)\n    .replace('DD', day);\n}\n","import * as d3 from './d3';\r\n\r\nexport function loadData(URL: string, type: 'json' | 'csv' | 'tsv' | 'xml' = 'json') {\r\n  switch (type) {\r\n    case 'json':\r\n      return d3.json(URL);\r\n    case 'csv':\r\n      return d3.csv(URL);\r\n    case 'tsv':\r\n      return d3.tsv(URL);\r\n    case 'xml':\r\n      return d3.xml(URL);\r\n    default:\r\n      throw new Error(`Unsupported data type: ${type}`);\r\n  }\r\n}\r\n","import { fillGaps, getDateSlice, prepareData } from './data-utils';\nimport { filterDates, formatDate, getDateString, getDates } from './dates';\nimport {\n  Controls,\n  Data,\n  LastValues,\n  Options,\n  Overlays,\n  RenderOptions,\n  TickerOptions,\n} from './models';\nimport { createRenderer } from './renderer';\nimport { createTicker } from './ticker';\nimport * as styles from './styles';\n\nexport function race(data: Data[], options: Options = {}) {\n  // ********************\n  // User-defined options\n  // ********************\n\n  const dataShape = options.dataShape || 'long';\n  const fillDateGaps = options.fillDateGaps;\n  // const fillDateGapsValue = options.fillDateGapsValue || \"last\";\n  const selector = options.selector || '#race';\n  const startDate = options.startDate ? getDateString(options.startDate) : '';\n  const endDate = options.endDate ? getDateString(options.endDate) : '';\n  const colorSeed = options.colorSeed || '';\n  const disableGroupColors = options.disableGroupColors || false;\n  const tickDuration = Number(options.tickDuration) || 500;\n  const topN = Number(options.topN) || 10;\n  const disableClickEvents = options.disableClickEvents !== false;\n  const disableKeyboardEvents = options.disableKeyboardEvents;\n  const autorun = options.autorun !== false;\n  const injectStyles = options.injectStyles !== false;\n\n  const renderOptions: RenderOptions = {\n    selector,\n    title: options.title || '18 years of Top Global Brands',\n    subTitle: options.subTitle || 'Brand value, $m',\n    caption: options.caption || 'Source: Interbrand',\n    dateCounterFormat: options.dateCounterFormat || 'YYYY',\n    labelsOnBars: options.labelsOnBars !== false,\n    labelsWidth: options.labelsWidth || 100,\n    showControls: options.showControls || 'all',\n    showOverlays: options.showOverlays || 'all',\n    inputHeight: options.height,\n    inputWidth: options.width,\n    minHeight: 300,\n    minWidth: 500,\n    tickDuration,\n    topN,\n  };\n\n  const tickerOptions: TickerOptions = {\n    loop: options.loop || false,\n    tickDuration,\n  };\n\n  const element = document.querySelector(selector) as HTMLElement;\n  if (!element) {\n    throw new Error('Cannot find element with this selector: ' + selector);\n  }\n\n  if (injectStyles) {\n    styles.styleInject(selector, 'top');\n  }\n\n  // ********************\n  //  Stateful functions\n  // ********************\n\n  const renderer = createRenderer(selector, renderOptions);\n  const ticker = createTicker(notifyRenderer);\n\n  // ********************\n  //   Create the chart\n  // ********************\n\n  let lastValues: LastValues;\n\n  data = filterDates(data, startDate, endDate);\n  data = prepareData(data, dataShape, disableGroupColors, colorSeed);\n\n  const dates = getDates(data);\n\n  if (fillDateGaps) {\n    data = fillGaps(data, dates, fillDateGaps);\n  }\n\n  const tickerDate = ticker.tickerDateFactory(dates, tickerOptions, updateDate, renderFrame);\n\n  let dateSlice: Data[];\n  initialize();\n\n  renderInitalView();\n  renderFrame();\n\n  ticker.start();\n\n  if (!autorun) {\n    ticker.stop();\n  }\n\n  if (!disableClickEvents) {\n    registerClickEvents();\n  }\n  if (!disableKeyboardEvents) {\n    registerKeyboardEvents();\n  }\n\n  window.addEventListener('resize', resize);\n\n  // ********************\n  //   Helper functions\n  // ********************\n\n  function renderInitalView() {\n    element.innerHTML = '';\n    renderer.renderInitalView(dateSlice);\n    ticker.stop();\n    const controls = renderer.getControls();\n    registerControlButtonEvents(controls);\n    registerOverlayEvents(controls);\n  }\n\n  function renderFrame() {\n    renderer.renderFrame(dateSlice);\n  }\n\n  function notifyRenderer(running: boolean, position: 'first' | 'last' | '') {\n    renderer.updateControls(running, position);\n  }\n\n  function registerControlButtonEvents(controls: Controls) {\n    if (!controls) {\n      return;\n    }\n    controls.skipBack.addEventListener('click', ticker.rewind);\n    controls.play.addEventListener('click', ticker.toggle);\n    controls.pause.addEventListener('click', ticker.toggle);\n    controls.skipForward.addEventListener('click', ticker.fastForward);\n  }\n\n  function registerOverlayEvents(controls: Overlays) {\n    if (!controls) {\n      return;\n    }\n    controls.overlayPlay.addEventListener('click', ticker.start);\n    controls.overlayRepeat.addEventListener('click', () => {\n      ticker.rewind();\n      ticker.start();\n    });\n  }\n\n  function resize() {\n    renderer.resize(reset);\n\n    function reset() {\n      const currentlyRunning = ticker.isRunning();\n      tickerDate.update();\n      renderInitalView();\n\n      if (currentlyRunning) {\n        ticker.start();\n      }\n    }\n  }\n\n  function updateDate(currentDate: string) {\n    dateSlice = getDateSlice(data, tickerDate.getDate(), lastValues, topN);\n    renderFrame();\n    element.dispatchEvent(\n      new CustomEvent('dateChanged', {\n        detail: { date: formatDate(currentDate, 'YYYY-MM-DD') },\n      }),\n    );\n  }\n\n  function initialize() {\n    initializeLastValues();\n    tickerDate.setFirst();\n\n    function initializeLastValues() {\n      lastValues = {};\n      data.forEach((d) => {\n        d.lastValue = d.value;\n        if (!lastValues[d.name] || d.date < lastValues[d.name].date) {\n          lastValues[d.name] = {\n            date: d.date,\n            value: d.value,\n          };\n        }\n      });\n    }\n  }\n\n  function createScroller() {\n    prepareDOM();\n\n    const step = document.body.clientHeight / dates.length;\n\n    subscribeToEvents();\n\n    function prepareDOM() {\n      element.style.position = 'fixed';\n      element.style.top = '0';\n\n      const scrollElement = document.createElement('div');\n      scrollElement.style.height = window.innerHeight * 10 + 'px';\n      document.body.appendChild(scrollElement);\n    }\n\n    function subscribeToEvents() {\n      window.addEventListener('scroll', goToDate);\n      // element.addEventListener(\"dateChanged\", scrollToPosition);\n    }\n\n    // function scrollToPosition(e: CustomEvent) {\n    //   let currentDate = getDateString(e.detail.date);\n    //   let index = dates.indexOf(currentDate);\n    //   ignoreNextScrollEvent = true;\n    //   window.scroll({\n    //     top: index * step,\n    //     behavior: \"smooth\",\n    //   });\n    // }\n\n    function goToDate() {\n      const index = Math.ceil(window.pageYOffset / step);\n      if (index < dates.length) {\n        tickerDate.setDate(dates[index]);\n      } else {\n        tickerDate.setLast();\n      }\n    }\n  }\n\n  function registerClickEvents() {\n    const svg = element.querySelector('svg') as SVGSVGElement;\n    svg.addEventListener('click', ticker.toggle);\n    element.addEventListener('dblclick', ticker.fastForward);\n  }\n\n  function registerKeyboardEvents() {\n    document.addEventListener('keypress', function (e) {\n      const keyCodes = {\n        spacebar: 32,\n        a: 97,\n        d: 100,\n        s: 115,\n      };\n\n      // TODO: keyCode is deprecated\n      switch (e.keyCode) {\n        case keyCodes.spacebar:\n          ticker.toggle();\n          break;\n        case keyCodes.a:\n          ticker.rewind();\n          break;\n        case keyCodes.s:\n          ticker.toggle();\n          break;\n        case keyCodes.d:\n          ticker.fastForward();\n          break;\n      }\n    });\n  }\n\n  // ********************\n  //      Public API\n  // ********************\n\n  return {\n    // TODO: validate user input\n    start: () => {\n      if (!ticker.isRunning()) {\n        ticker.start();\n      }\n    },\n    stop: () => {\n      ticker.stop();\n    },\n    rewind: () => {\n      ticker.rewind();\n    },\n    fastforward: () => {\n      ticker.fastForward();\n    },\n    loop: () => {\n      ticker.loop();\n    },\n    inc: (value = 1) => {\n      tickerDate.inc(value);\n    },\n    dec: (value = 1) => {\n      tickerDate.dec(value);\n    },\n    getDate: () => tickerDate.getDate(),\n    setDate: (inputDate: string | Date) => {\n      tickerDate.setDate(getDateString(inputDate));\n    },\n    getAllDates: () => dates.map((date: string) => formatDate(date, 'YYYY-MM-DD')),\n    createScroller: () => {\n      createScroller();\n    },\n  };\n}\n","import { styles } from './styles';\n\n// slightly modifed from https://github.com/egoist/style-inject\nexport function styleInject(selector: string, insertAt = 'top', css = styles) {\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  // replace with selector\n  css = css.split('#selector').join(selector);\n\n  const head = document.head || document.getElementsByTagName('head')[0];\n  const style = document.createElement('style') as HTMLStyleElement | any;\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n","import * as d3 from './d3';\n\nimport { formatDate } from './dates';\nimport { icons } from './icons';\nimport { Controls, Data, Options, Overlays, RenderOptions } from './models';\nimport { getHeight, getWidth } from './utils';\n\nexport function createRenderer(selector: string, renderOptions: RenderOptions) {\n  let margin: { top: number; right: number; bottom: number; left: number };\n  let svg: any;\n  let x: d3.ScaleLinear<number, number>;\n  let y: d3.ScaleLinear<number, number>;\n  let xAxis: d3.Axis<number | { valueOf(): number }>;\n  let barPadding: number;\n  let dateCounterText: any;\n  let labelX: number | ((d: Data) => number);\n  let height: number;\n  let width: number;\n  let controls: Controls;\n  let showOverlays: Options['showOverlays'];\n  let overlays: Overlays;\n\n  function renderInitalView(dateSlice: Data[]) {\n    const {\n      selector,\n      title,\n      subTitle,\n      caption,\n      dateCounterFormat,\n      labelsOnBars,\n      labelsWidth,\n      showControls,\n      inputHeight,\n      inputWidth,\n      minHeight,\n      minWidth,\n      topN,\n    } = renderOptions;\n\n    showOverlays = renderOptions.showOverlays;\n\n    const currentDate = dateSlice.length > 0 ? dateSlice[0].date : '';\n    const element = document.querySelector(selector) as HTMLElement;\n\n    height = getHeight(element, minHeight, inputHeight);\n    width = getWidth(element, minWidth, inputWidth);\n\n    renderInitialFrame();\n    renderControls();\n    renderOverlays();\n\n    function renderInitialFrame() {\n      svg = d3.select(selector).append('svg').attr('width', width).attr('height', height);\n\n      const labelsArea = labelsOnBars ? 0 : labelsWidth;\n\n      margin = {\n        top: 80,\n        right: 0,\n        bottom: 5,\n        left: 0 + labelsArea,\n      };\n\n      barPadding = (height - (margin.bottom + margin.top)) / (topN * 5);\n\n      svg.append('text').attr('class', 'title').attr('y', 24).html(title);\n\n      svg.append('text').attr('class', 'subTitle').attr('y', 55).html(subTitle);\n\n      x = d3\n        .scaleLinear()\n        .domain([0, d3.max(dateSlice, (d: Data) => d.value) as number])\n        .range([margin.left, width - margin.right - 65]);\n\n      y = d3\n        .scaleLinear()\n        .domain([topN, 0])\n        .range([height - margin.bottom, margin.top]);\n\n      xAxis = d3\n        .axisTop(x)\n        // .scale()\n        .ticks(width > 500 ? 5 : 2)\n        .tickSize(-(height - margin.top - margin.bottom))\n        .tickFormat((n: number | { valueOf(): number }) => d3.format(',')(n));\n\n      svg\n        .append('g')\n        .attr('class', 'axis xAxis')\n        .attr('transform', `translate(0, ${margin.top})`)\n        .call(xAxis)\n        .selectAll('.tick line')\n        .classed('origin', (d: number) => d === 0);\n\n      svg\n        .selectAll('rect.bar')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('x', x(0) + 1)\n        .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n        .attr('y', (d: Data) => y(d.rank as number) + 5)\n        .attr('height', y(1) - y(0) - barPadding)\n        .style('fill', (d: Data) => d.color);\n\n      labelX = labelsOnBars ? (d: Data) => x(d.value) - 8 : margin.left - 8;\n\n      svg\n        .selectAll('text.label')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('text')\n        .attr('class', 'label')\n        .attr('x', labelX)\n        .attr('y', (d: Data) => y(d.rank as number) + 5 + (y(1) - y(0)) / 2 + 1)\n        .style('text-anchor', 'end')\n        .html((d: Data) => d.name);\n      svg\n        .selectAll('text.valueLabel')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('text')\n        .attr('class', 'valueLabel')\n        .attr('x', (d: Data) => x(d.value) + 5)\n        .attr('y', (d: Data) => y(d.rank as number) + 5 + (y(1) - y(0)) / 2 + 1)\n        .text((d: Data) => d3.format(',.0f')(d.lastValue as number));\n\n      const strokeWidth = 10;\n      dateCounterText = svg\n        .append('text')\n        .attr('class', 'dateCounterText')\n        .attr('x', width - margin.right - barPadding)\n        .attr('y', height - 40)\n        .style('text-anchor', 'end')\n        .html(formatDate(currentDate, dateCounterFormat))\n        .call(halo, strokeWidth);\n\n      svg\n        .append('text')\n        .attr('class', 'caption')\n        .attr('x', width - margin.right - barPadding - strokeWidth)\n        .attr('y', height - margin.bottom - barPadding)\n        .style('text-anchor', 'end')\n        .html(caption);\n\n      // TODO: animate halo\n      function halo(text: any, strokeWidth: number) {\n        text\n          .select(function () {\n            return this.parentNode.insertBefore(this.cloneNode(true), this);\n          })\n          .style('fill', '#ffffff')\n          .style('stroke', '#ffffff')\n          .style('stroke-width', strokeWidth)\n          .style('stroke-linejoin', 'round')\n          .style('opacity', 1);\n      }\n    }\n\n    function renderControls() {\n      const controlIcons = [\n        { skipBack: icons.skipBack },\n        { play: icons.play },\n        { pause: icons.pause },\n        { skipForward: icons.skipForward },\n      ];\n\n      const elements: any = {};\n      const elementWidth = element.getBoundingClientRect().width;\n\n      d3.select(selector)\n        .append('div')\n        .classed('controls', true)\n        .style('width', width)\n        .style('right', elementWidth - width + margin.right + barPadding + 'px')\n        .call(function (sel) {\n          elements.container = sel.node() as HTMLElement;\n        })\n        .selectAll('div')\n        .data(controlIcons)\n        .enter()\n        .append('div')\n        .html((d) => Object.values(d)[0] as string)\n        .attr('class', (d) => Object.keys(d)[0])\n        .each(function (d) {\n          elements[Object.keys(d)[0]] = this;\n        });\n      controls = elements;\n\n      if (showControls === 'play') {\n        controls.skipBack.style.visibility = 'hidden';\n        controls.skipForward.style.visibility = 'hidden';\n      }\n      if (showControls === 'none') {\n        d3.select(selector + ' .controls').style('display', 'none');\n      }\n    }\n\n    function renderOverlays() {\n      const overlayIcons = [\n        { overlayPlay: icons.overlayPlay },\n        { overlayRepeat: icons.overlayRepeat },\n      ];\n\n      const elements: any = {};\n\n      d3.select(selector)\n        .append('div')\n        .classed('overlay', true)\n        .style('minHeight', minHeight + 'px')\n        .style('minWidth', minWidth + 'px')\n        .call(function (overlay) {\n          elements.container = overlay.node() as HTMLElement;\n        })\n        .selectAll('div')\n        .data(overlayIcons)\n        .enter()\n        .append('div')\n        .html((d) => Object.values(d)[0] as string)\n        .attr('class', (d) => Object.keys(d)[0])\n        .each(function (d) {\n          elements[Object.keys(d)[0]] = this;\n        });\n      overlays = elements;\n\n      updateControls(false, 'first');\n    }\n  }\n\n  function renderFrame(dateSlice: Data[]) {\n    if (!x) {\n      return;\n    }\n\n    const { tickDuration, topN, dateCounterFormat } = renderOptions;\n    const currentDate = dateSlice.length > 0 ? dateSlice[0].date : '';\n\n    x.domain([0, d3.max(dateSlice, (d: Data) => d.value) as number]);\n\n    svg.select('.xAxis').transition().duration(tickDuration).ease(d3.easeLinear).call(xAxis);\n\n    const bars = svg.selectAll('.bar').data(dateSlice, (d: Data) => d.name);\n\n    bars\n      .enter()\n      .append('rect')\n      .attr('class', (d: Data) => `bar ${d.name.replace(/\\s/g, '_')}`)\n      .attr('x', x(0) + 1)\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n      .attr('y', () => y(topN + 1) + 5)\n      .attr('height', y(1) - y(0) - barPadding)\n      .style('fill', (d: Data) => d.color)\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('y', (d: Data) => y(d.rank as number) + 5);\n\n    bars\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n      .attr('y', (d: Data) => y(d.rank as number) + 5);\n\n    bars\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n      .attr('y', () => y(topN + 1) + 5)\n      .remove();\n\n    const labels = svg.selectAll('.label').data(dateSlice, (d: Data) => d.name);\n\n    labels\n      .enter()\n      .append('text')\n      .attr('class', 'label')\n      .attr('x', labelX)\n      .attr('y', () => y(topN + 1) + 5 + (y(1) - y(0)) / 2)\n      .style('text-anchor', 'end')\n      .html((d: Data) => d.name)\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('y', (d: Data) => y(d.rank as number) + 5 + (y(1) - y(0)) / 2 + 1);\n\n    labels\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', labelX)\n      .attr('y', (d: Data) => y(d.rank as number) + 5 + (y(1) - y(0)) / 2 + 1);\n\n    labels\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', labelX)\n      .attr('y', () => y(topN + 1) + 5)\n      .remove();\n\n    const valueLabels = svg.selectAll('.valueLabel').data(dateSlice, (d: Data) => d.name);\n\n    valueLabels\n      .enter()\n      .append('text')\n      .attr('class', 'valueLabel')\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', () => y(topN + 1) + 5)\n      .text((d: Data) => d3.format(',.0f')(d.lastValue as number))\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('y', (d: Data) => y(d.rank as number) + 5 + (y(1) - y(0)) / 2 + 1);\n\n    valueLabels\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', (d: Data) => y(d.rank as number) + 5 + (y(1) - y(0)) / 2 + 1)\n      .tween('text', function (d: Data) {\n        const i = d3.interpolateRound(d.lastValue as number, d.value);\n        return function (t: number) {\n          this.textContent = d3.format(',')(i(t));\n        };\n      });\n\n    valueLabels\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', () => y(topN + 1) + 5)\n      .remove();\n\n    dateCounterText.html(formatDate(currentDate, dateCounterFormat));\n  }\n\n  function resize(resetFn: () => void) {\n    if (\n      (!renderOptions.inputHeight && !renderOptions.inputWidth) ||\n      String(renderOptions.inputHeight).startsWith('window') ||\n      String(renderOptions.inputWidth).startsWith('window')\n    ) {\n      const element = document.querySelector(selector) as HTMLElement;\n\n      height = getHeight(element, renderOptions.minHeight, renderOptions.inputHeight);\n      width = getWidth(element, renderOptions.minWidth, renderOptions.inputWidth);\n\n      const currentPosition = element.style.position; // \"fixed\" if scrolling\n      resetFn();\n      element.style.position = currentPosition;\n    }\n  }\n\n  function updateControls(running: boolean, position: 'first' | 'last' | '' = '') {\n    if (running) {\n      controls.play.style.display = 'none';\n      controls.pause.style.display = 'unset';\n    } else {\n      controls.play.style.display = 'unset';\n      controls.pause.style.display = 'none';\n    }\n\n    if (position === 'first' && (showOverlays === 'all' || showOverlays === 'play')) {\n      controls.container.style.visibility = 'hidden';\n      overlays.container.style.display = 'flex';\n      overlays.overlayPlay.style.display = 'flex';\n      overlays.overlayRepeat.style.display = 'none';\n    } else if (position === 'last' && (showOverlays === 'all' || showOverlays === 'repeat')) {\n      controls.container.style.visibility = 'hidden';\n      overlays.container.style.display = 'flex';\n      overlays.overlayPlay.style.display = 'none';\n      overlays.overlayRepeat.style.display = 'flex';\n    } else {\n      controls.container.style.visibility = 'unset';\n      overlays.container.style.display = 'none';\n    }\n  }\n\n  return {\n    renderInitalView,\n    renderFrame,\n    resize,\n    updateControls,\n    getRenderedHeight: () => height,\n    getRenderedWidth: () => width,\n    getControls: () => ({ ...controls, ...overlays }),\n  };\n}\n","import * as d3 from './d3';\n\nimport { TickerDate, TickerOptions } from './models';\n\nexport function createTicker(\n  runningCallback: (running: boolean, position: 'first' | 'last' | '') => void,\n) {\n  let ticker: d3.Timer;\n  let tickerDate: TickerDate;\n  let running: boolean;\n  let tickDuration: number;\n  let loopOption: boolean;\n  let renderFrame: () => void;\n\n  function tickerDateFactory(\n    dates: string[],\n    tickerOptions: TickerOptions,\n    updateDateCallback: (currentDate: string) => void,\n    renderFrameCallback: () => void,\n  ) {\n    tickDuration = tickerOptions.tickDuration;\n    loopOption = tickerOptions.loop;\n    renderFrame = renderFrameCallback;\n\n    let dateCounter = 0;\n    let currentDate: string;\n    const lastIndex = dates.length - 1;\n    const maxDate = dates[lastIndex];\n\n    function updateDate() {\n      currentDate = dates[dateCounter];\n      updateDateCallback(currentDate);\n    }\n\n    tickerDate = {\n      inc: (value = 1) => {\n        const newValue = dateCounter + value;\n        dateCounter = newValue > lastIndex ? lastIndex : newValue;\n        updateDate();\n      },\n      dec: (value = 1) => {\n        const newValue = dateCounter - value;\n        dateCounter = newValue < 0 ? 0 : newValue;\n        updateDate();\n      },\n      setFirst: () => {\n        dateCounter = 0;\n        updateDate();\n      },\n      setLast: () => {\n        dateCounter = dates.length - 1;\n        updateDate();\n      },\n      update: () => {\n        updateDate();\n      },\n      getDate: () => currentDate,\n      setDate: (date: string) => {\n        const dateIndex = dates.indexOf(date);\n        if (dateIndex > -1) {\n          dateCounter = dateIndex;\n          updateDate();\n        }\n      },\n      isFirst: () => currentDate === dates[0],\n      isLast: () => currentDate === maxDate,\n    };\n\n    return tickerDate;\n  }\n\n  function start() {\n    setRunning(true);\n    ticker = d3.interval(showRace, tickDuration);\n    runningCallback(running, '');\n\n    function showRace(_: number) {\n      if (tickerDate.isLast()) {\n        renderFrame();\n        if (loopOption) {\n          loop();\n        } else {\n          stop();\n          runningCallback(running, 'last');\n        }\n      } else {\n        tickerDate.inc();\n      }\n    }\n  }\n\n  function stop() {\n    if (ticker) {\n      ticker.stop();\n    }\n    setRunning(false);\n  }\n\n  function rewind() {\n    stop();\n    tickerDate.setFirst();\n    renderFrame();\n    runningCallback(running, 'first');\n  }\n\n  function loop() {\n    tickerDate.setFirst();\n    renderFrame();\n  }\n\n  function fastForward() {\n    stop();\n    tickerDate.setLast();\n    renderFrame();\n    runningCallback(running, 'last');\n  }\n\n  function toggle() {\n    if (tickerDate.isLast()) {\n      rewind();\n      start();\n    } else if (running) {\n      stop();\n    } else {\n      start();\n    }\n  }\n\n  function isRunning() {\n    return running;\n  }\n\n  function setRunning(flag = true) {\n    running = flag;\n    const position = tickerDate.isLast() ? 'last' : tickerDate.isFirst() ? 'first' : '';\n    runningCallback(running, position);\n  }\n\n  return {\n    tickerDateFactory,\n    start,\n    stop,\n    rewind,\n    loop,\n    fastForward,\n    toggle,\n    isRunning,\n  };\n}\n","import { formatDate, getDateString } from './dates';\nimport { Data, LastValues } from './models';\nimport { getColor } from './utils';\n\nexport function prepareData(\n  data: Data[],\n  dataShape: string,\n  disableGroupColors: boolean,\n  colorSeed: string,\n) {\n  if (dataShape === 'wide') {\n    data = wideDataToLong(data);\n  }\n  return data.map((item) => {\n    const d = { ...item };\n    d.value = isNaN(+d.value) ? 0 : +d.value;\n    d.date = getDateString(d.date);\n    d.color = getColor(d, disableGroupColors, colorSeed);\n    return d;\n  });\n}\n\nexport function wideDataToLong(wide: any) {\n  const long = [] as Data[];\n  wide.forEach((item: any) => {\n    for (const [key, value] of Object.entries(item)) {\n      long.push({\n        date: item.date,\n        name: key,\n        value: Number(value),\n      });\n    }\n  });\n  return long;\n}\n\nexport function fillGaps(data: Data[], dates: string[], period: 'years' | 'months' | 'days') {\n  const minDate = new Date(formatDate(dates[0], 'YYYY-MM-DD'));\n  const maxDate = new Date(formatDate(dates[dates.length - 1], 'YYYY-MM-DD'));\n\n  const next = {\n    years: (dt: Date) => {\n      dt.setFullYear(dt.getFullYear() + 1);\n    },\n    months: (dt: Date) => {\n      dt.setMonth(dt.getMonth() + 1);\n    },\n    days: (dt: Date) => {\n      dt.setDate(dt.getDate() + 1);\n    },\n  };\n  if (!next[period]) {\n    return data;\n  }\n\n  const dateRange: string[] = [];\n  for (const date = minDate; date < maxDate; next[period](date)) {\n    dateRange.push(getDateString(date));\n  }\n\n  dateRange.forEach((date, index) => {\n    if (data.filter((d) => d.date === date).length > 0) {\n      return;\n    }\n\n    const missing = data\n      .filter((d) => d.date === dateRange[index - 1])\n      .map((d) =>\n        // const value = {\n        //   last: d.value,\n        //   zero: 0,\n        // }\n        ({\n          ...d,\n          date,\n          // value: value[fillDateGapsValue],\n        }),\n      );\n\n    data.push(...missing);\n  });\n\n  return data;\n}\n\nexport function getDateSlice(data: Data[], date: string, lastValues: LastValues, topN: number) {\n  return data\n    .filter((d) => d.date === date && !isNaN(d.value))\n    .map((d) => {\n      if (!lastValues[d.name]) {\n        return d;\n      }\n      const lastValue = lastValues[d.name].value;\n      lastValues[d.name].date = d.date;\n      lastValues[d.name].value = d.value;\n      return { ...d, lastValue };\n    })\n    .sort((a, b) => b.value - a.value)\n    .slice(0, topN)\n    .map((d, i) => ({ ...d, rank: i }));\n}\n"],"names":["zeroPad","n","w","toString","length","getHeight","element","minHeight","height","newHeight","String","startsWith","scale","split","window","innerHeight","getBoundingClientRect","getWidth","minWidth","width","newWidth","innerWidth","getDateString","inputDate","date","Date","isNaN","Error","year","getFullYear","month","getMonth","getDate","formatDate","dateStr","format","slice","day","weekDayIndex","getDay","replace","01","02","03","04","05","06","07","08","09","10","11","12","0","1","2","3","4","5","6","prefix","Array","fill","map","Math","random","substr","join","randomString","URL","type","d3","data","options","dataShape","fillDateGaps","selector","startDate","endDate","colorSeed","disableGroupColors","tickDuration","Number","topN","disableClickEvents","disableKeyboardEvents","autorun","injectStyles","renderOptions","title","subTitle","caption","dateCounterFormat","labelsOnBars","labelsWidth","showControls","showOverlays","inputHeight","inputWidth","tickerOptions","loop","document","querySelector","insertAt","css","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","styles","lastValues","renderer","margin","svg","x","y","xAxis","barPadding","dateCounterText","labelX","controls","overlays","updateControls","running","position","play","display","pause","container","visibility","overlayPlay","overlayRepeat","renderInitalView","dateSlice","overlayIcons","elements","currentDate","append","attr","top","right","bottom","left","html","domain","d","value","range","ticks","tickSize","tickFormat","call","selectAll","classed","name","enter","abs","rank","color","text","lastValue","strokeWidth","select","parentNode","this","cloneNode","elementWidth","sel","node","skipBack","skipForward","Object","values","keys","each","renderControls","overlay","renderFrame","transition","duration","ease","bars","exit","remove","labels","valueLabels","tween","i","t","textContent","resize","resetFn","currentPosition","getRenderedHeight","getRenderedWidth","getControls","createRenderer","ticker","runningCallback","tickerDate","loopOption","start","setRunning","_","isLast","stop","inc","rewind","setFirst","flag","isFirst","tickerDateFactory","dates","updateDateCallback","renderFrameCallback","dateCounter","lastIndex","maxDate","updateDate","newValue","dec","setLast","update","setDate","dateIndex","indexOf","fastForward","toggle","isRunning","createTicker","uniqueDates","Set","forEach","add","from","sort","getDates","long","item","entries","push","seed","s","nums","charCodeAt","toNumbers","group","sin","floor","getColor","prepareData","filter","filterDates","period","minDate","next","years","dt","setFullYear","months","setMonth","days","dateRange","index","missing","fillGaps","a","b","getDateSlice","dispatchEvent","CustomEvent","detail","innerHTML","addEventListener","registerControlButtonEvents","registerOverlayEvents","e","keyCode","currentlyRunning","fastforward","getAllDates","createScroller","scrollElement","body","prepareDOM","step","clientHeight","ceil","pageYOffset"],"mappings":"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"}