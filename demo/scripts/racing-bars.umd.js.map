{"version":3,"file":"racing-bars.umd.js","sources":["../../src/lib/load-data.ts","../../src/lib/options/options.actions.ts","../../src/lib/ticker/ticker.actions.ts","../../src/lib/ticker/ticker.reducer.ts","../../src/lib/ticker/ticker.ts","../../src/lib/store/actions.ts","../../src/lib/store/reducer.ts","../../src/lib/store/store.ts","../../src/lib/store/state.ts","../../src/lib/utils.ts","../../src/lib/dates.ts","../../src/lib/options/options.reducer.ts","../../src/lib/data-utils.ts","../../src/lib/icons.ts","../../src/lib/elements.ts","../../src/lib/renderer.ts","../../src/lib/styles/generated-styles.ts","../../src/lib/styles/style-inject.ts","../../src/lib/events.ts","../../src/lib/scroller.ts","../../src/lib/race.ts"],"sourcesContent":["import * as d3 from './d3';\n\nexport function loadData(URL: string, type: 'json' | 'csv' | 'tsv' | 'xml' = 'json') {\n  switch (type) {\n    case 'json':\n      return d3.json(URL);\n    case 'csv':\n      return d3.csv(URL);\n    case 'tsv':\n      return d3.tsv(URL);\n    case 'xml':\n      return d3.xml(URL);\n    default:\n      throw new Error(`Unsupported data type: ${type}`);\n  }\n}\n","import { Options, OptionsAction, RequiredOptions } from './options.models';\r\n\r\nexport const actionTypes = {\r\n  optionsLoaded: 'options/loaded',\r\n  changeOptions: 'options/change',\r\n  optionsChanged: 'options/changed',\r\n};\r\n\r\nexport const optionsLoaded = (options: Options | RequiredOptions): OptionsAction => ({\r\n  type: actionTypes.optionsLoaded,\r\n  payload: options,\r\n});\r\n\r\nexport const changeOptions = (options: Options): OptionsAction => ({\r\n  type: actionTypes.changeOptions,\r\n  payload: options,\r\n});\r\n\r\nexport const optionsChanged = (options: Options): OptionsAction => ({\r\n  type: actionTypes.optionsChanged,\r\n  payload: options,\r\n});\r\n","import { TickerAction } from './ticker.models';\r\n\r\nexport const actionTypes = {\r\n  initialize: 'ticker/initialize',\r\n  updateDate: 'ticker/updateDate',\r\n  setRunning: 'ticker/setRunning',\r\n  setFirst: 'ticker/setFirst',\r\n  setLast: 'ticker/setLast',\r\n  inc: 'ticker/inc',\r\n  dec: 'ticker/dec',\r\n};\r\n\r\nexport const initialize = (dates: string[]): TickerAction => ({\r\n  type: actionTypes.initialize,\r\n  payload: dates,\r\n});\r\n\r\nexport const updateDate = (currentDate: string): TickerAction => ({\r\n  type: actionTypes.updateDate,\r\n  payload: currentDate,\r\n});\r\n\r\nexport const setRunning = (running: boolean): TickerAction => ({\r\n  type: actionTypes.setRunning,\r\n  payload: running,\r\n});\r\n\r\nexport const setFirst = (): TickerAction => ({\r\n  type: actionTypes.setFirst,\r\n});\r\n\r\nexport const setLast = (): TickerAction => ({\r\n  type: actionTypes.setLast,\r\n});\r\n\r\nexport const inc = (value = 1): TickerAction => ({\r\n  type: actionTypes.inc,\r\n  payload: value,\r\n});\r\n\r\nexport const dec = (value = 1): TickerAction => ({\r\n  type: actionTypes.dec,\r\n  payload: value,\r\n});\r\n","import { TickerState, TickerAction } from './ticker.models';\r\nimport { actionTypes } from './ticker.actions';\r\n\r\nconst initialState: TickerState = {\r\n  isRunning: false,\r\n  currentDate: '',\r\n  isFirstDate: true,\r\n  isLastDate: false,\r\n  dates: [],\r\n};\r\n\r\nexport function tickerReducer(state = initialState, action: TickerAction): TickerState {\r\n  switch (action.type) {\r\n    case actionTypes.initialize: {\r\n      const dates = action.payload as string[];\r\n      return {\r\n        ...state,\r\n        isRunning: false,\r\n        currentDate: dates[0],\r\n        isFirstDate: true,\r\n        isLastDate: false,\r\n        dates,\r\n      };\r\n    }\r\n\r\n    case actionTypes.updateDate: {\r\n      const currentDate = action.payload as string;\r\n      if (state.dates.indexOf(currentDate) === -1) {\r\n        return { ...state };\r\n      }\r\n      return {\r\n        ...state,\r\n        currentDate,\r\n        isFirstDate: currentDate === state.dates[0],\r\n        isLastDate: currentDate === state.dates[state.dates.length - 1],\r\n      };\r\n    }\r\n\r\n    case actionTypes.setRunning: {\r\n      return {\r\n        ...state,\r\n        isRunning: action.payload as boolean,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setFirst: {\r\n      return {\r\n        ...state,\r\n        currentDate: state.dates[0],\r\n        isFirstDate: true,\r\n        isLastDate: false,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setLast: {\r\n      return {\r\n        ...state,\r\n        currentDate: state.dates[state.dates.length - 1],\r\n        isFirstDate: false,\r\n        isLastDate: true,\r\n      };\r\n    }\r\n\r\n    case actionTypes.inc: {\r\n      const currentIndex = state.dates.indexOf(state.currentDate);\r\n      const lastIndex = state.dates.length - 1;\r\n      const incValue = action.payload as number;\r\n      const newDate =\r\n        currentIndex + incValue > lastIndex\r\n          ? state.dates[lastIndex]\r\n          : state.dates[currentIndex + incValue];\r\n      return {\r\n        ...state,\r\n        currentDate: newDate,\r\n        isFirstDate: newDate === state.dates[0],\r\n        isLastDate: newDate === state.dates[lastIndex],\r\n      };\r\n    }\r\n\r\n    case actionTypes.dec: {\r\n      const currentIndex = state.dates.indexOf(state.currentDate);\r\n      const decValue = action.payload as number;\r\n      const newDate =\r\n        currentIndex - decValue < 0 ? state.dates[0] : state.dates[currentIndex - decValue];\r\n      return {\r\n        ...state,\r\n        currentDate: newDate,\r\n        isFirstDate: newDate === state.dates[0],\r\n        isLastDate: newDate === state.dates[state.dates.length - 1],\r\n      };\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import * as d3 from '../d3';\r\nimport { store, actions } from '../store';\r\nimport { Ticker } from './ticker.models';\r\n\r\nexport function createTicker(dates: string[]): Ticker {\r\n  store.dispatch(actions.ticker.initialize(dates));\r\n\r\n  let ticker: d3.Timer;\r\n\r\n  function start() {\r\n    ticker = d3.interval(showRace, store.getState().options.tickDuration);\r\n    store.dispatch(actions.ticker.setRunning(true));\r\n\r\n    function showRace(_: number) {\r\n      if (store.getState().ticker.isLastDate) {\r\n        if (store.getState().options.loop) {\r\n          loop();\r\n        } else {\r\n          stop();\r\n        }\r\n      } else {\r\n        store.dispatch(actions.ticker.inc());\r\n      }\r\n    }\r\n  }\r\n\r\n  function stop() {\r\n    if (ticker) {\r\n      ticker.stop();\r\n    }\r\n    store.dispatch(actions.ticker.setRunning(false));\r\n  }\r\n\r\n  function skipBack() {\r\n    stop();\r\n    store.dispatch(actions.ticker.setFirst());\r\n  }\r\n\r\n  function loop() {\r\n    store.dispatch(actions.ticker.setFirst());\r\n  }\r\n\r\n  function skipForward() {\r\n    stop();\r\n    store.dispatch(actions.ticker.setLast());\r\n  }\r\n\r\n  function toggle() {\r\n    if (store.getState().ticker.isLastDate) {\r\n      skipBack();\r\n      start();\r\n    } else if (store.getState().ticker.isRunning) {\r\n      stop();\r\n    } else {\r\n      if (!store.getState().ticker.isFirstDate) {\r\n        // to avoid lastValue flicker\r\n        store.dispatch(actions.ticker.inc());\r\n      }\r\n      start();\r\n    }\r\n  }\r\n\r\n  function goToDate(date: string) {\r\n    store.dispatch(actions.ticker.updateDate(date));\r\n  }\r\n\r\n  return {\r\n    start,\r\n    stop,\r\n    skipBack,\r\n    loop,\r\n    skipForward,\r\n    toggle,\r\n    goToDate,\r\n  };\r\n}\r\n","import * as options from '../options';\r\nimport * as ticker from '../ticker';\r\n\r\nexport const actions = {\r\n  options,\r\n  ticker,\r\n};\r\n","import { optionsReducer, OptionsAction } from '../options';\r\nimport { tickerReducer, TickerAction } from '../ticker';\r\nimport { Action, State } from './models';\r\n\r\nexport function rootReducer(state: State, action: Action): State {\r\n  return {\r\n    options: optionsReducer(state.options, action as OptionsAction),\r\n    ticker: tickerReducer(state.ticker, action as TickerAction),\r\n  };\r\n}\r\n","import { Action, Reducer, State, Subscriber } from './models';\r\nimport { rootReducer } from './reducer';\r\n\r\nexport function createStore(reducer: Reducer = rootReducer, preloadedState?: State) {\r\n  let state = {} as State;\r\n\r\n  if (preloadedState) {\r\n    state = preloadedState;\r\n  }\r\n\r\n  function dispatch(action: Action) {\r\n    state = reducer(state, action);\r\n    notifySubscribers();\r\n    return action;\r\n  }\r\n\r\n  function getState() {\r\n    return state;\r\n  }\r\n\r\n  const subscribers: Subscriber[] = [];\r\n\r\n  function subscribe(fn: Subscriber) {\r\n    subscribers.push(fn);\r\n    const index = subscribers.length - 1;\r\n\r\n    return {\r\n      unsubscribe: () => {\r\n        subscribers.splice(index, 1);\r\n      },\r\n    };\r\n  }\r\n\r\n  function notifySubscribers() {\r\n    subscribers.forEach((fn: Subscriber) => {\r\n      fn();\r\n    });\r\n  }\r\n\r\n  return {\r\n    getState,\r\n    dispatch,\r\n    subscribe,\r\n  };\r\n}\r\n","import { createStore } from './store';\r\nimport { rootReducer } from './reducer';\r\n\r\nexport const store = createStore(rootReducer);\r\n","import * as d3 from './d3';\n\nimport { Data } from './models';\nimport { store } from './store';\nimport { formatDate } from './dates';\nimport { ParamFunction } from './options';\n\nexport function getColor(\n  d: Data,\n  showGroups: boolean,\n  colorSeed: string,\n  colorMap: { [key: string]: string },\n) {\n  if (d.color) {\n    return d.color;\n  }\n\n  if (colorMap) {\n    if (colorMap[d.name]) {\n      return colorMap[d.name];\n    } else if (d.group && showGroups && colorMap[d.group]) {\n      return colorMap[d.group];\n    }\n  }\n\n  const nameseed = d.group && showGroups ? d.group : d.name;\n  const seed = nameseed + colorSeed;\n  return d3.hsl(random(seed) * 360, 0.75, 0.75);\n}\n\nexport function getIconID(d: Data) {\n  return 'icon-' + d.name.toLowerCase().split(' ').join('_');\n}\n\nexport function zeroPad(n: string, w: number) {\n  while (n.toString().length < w) {\n    n = '0' + n;\n  }\n  return n;\n}\n\nexport function random(seedStr: string) {\n  function toNumbers(s: string) {\n    let nums = '';\n    for (let i = 0; i < s.length; i++) {\n      nums += zeroPad(String(s.charCodeAt(i)), 3);\n    }\n    return nums;\n  }\n\n  const seed = toNumbers(seedStr);\n  const x = Math.sin(+seed) * 10000;\n  return x - Math.floor(x);\n}\n\nexport function randomString(prefix: string, n: number) {\n  const rnd = Array(3)\n    .fill(null)\n    .map(() => Math.random().toString(36).substr(2))\n    .join('');\n  return prefix + rnd.slice(-n);\n}\n\nexport function generateId(prefix = 'racingbars', n = 8) {\n  return randomString(prefix, n);\n}\n\nexport function getHeight(element: HTMLElement, minHeight: number, height?: string) {\n  let newHeight;\n  if (!height) {\n    newHeight = element.getBoundingClientRect().height;\n  } else if (String(height).startsWith('window')) {\n    const scale = +height.split('*')[1] || 1;\n    newHeight = window.innerHeight * scale;\n  } else {\n    newHeight = +height;\n  }\n  return newHeight > minHeight ? newHeight : minHeight;\n}\n\nexport function getWidth(element: HTMLElement, minWidth: number, width?: string) {\n  let newWidth;\n  if (!width) {\n    newWidth = element.getBoundingClientRect().width;\n  } else if (String(width).startsWith('window')) {\n    const scale = +width.split('*')[1] || 1;\n    newWidth = window.innerWidth * scale;\n  } else {\n    newWidth = +width;\n  }\n  return newWidth > minWidth ? newWidth : minWidth;\n}\n\nexport function getElement(className: string) {\n  const element = document.querySelector(store.getState().options.selector) as HTMLElement;\n  return element.querySelector('.' + className) as HTMLElement;\n}\n\nexport function showElement(className: string) {\n  const selector = store.getState().options.selector;\n  const element = document.querySelector(selector + ' .' + className) as HTMLElement;\n  if (element) {\n    element.style.display = 'flex';\n  }\n}\n\nexport function hideElement(className: string) {\n  const selector = store.getState().options.selector;\n  const element = document.querySelector(selector + ' .' + className) as HTMLElement;\n  if (element) {\n    element.style.display = 'none';\n  }\n}\n\nexport function removeElement(className: string) {\n  const selector = store.getState().options.selector;\n  const element = document.querySelector(selector + ' .' + className) as HTMLElement;\n  if (element) {\n    element.remove();\n  }\n}\n\nexport function addEventHandler(className: string, event: string, handler: () => void) {\n  const element = getElement(className);\n  if (element) {\n    element.addEventListener(event, handler);\n  }\n}\n\nexport function getText(param: string | ParamFunction, dateSlice: Data[], isDate = false): string {\n  if (typeof param === 'function') {\n    return param(\n      formatDate(store.getState().ticker.currentDate),\n      dateSlice.map((d) => ({ ...d, date: formatDate(d.date) })),\n      store.getState().ticker.dates.map((date) => formatDate(date)),\n    );\n  }\n  if (isDate) {\n    return formatDate(store.getState().ticker.currentDate, param);\n  }\n  return param;\n}\n","import { Data } from './models';\nimport { zeroPad } from './utils';\n\nexport const getDates = (data: Data[]) => Array.from(new Set(data.map((d) => d.date))).sort();\n\nexport function getDateString(inputDate: string | Date) {\n  const date = new Date(inputDate);\n  if (isNaN(+date)) {\n    throw new Error(`\"${inputDate}\" is not a valid date`);\n  }\n\n  const year = date.getFullYear();\n\n  let month = (1 + date.getMonth()).toString();\n  month = zeroPad(month, 2);\n\n  let day = date.getDate().toString();\n  day = zeroPad(day, 2);\n\n  return `${year}${month}${day}`;\n}\n\nexport function formatDate(dateStr: string, format = 'YYYY-MM-DD') {\n  const year = dateStr.slice(0, 4);\n  const month = dateStr.slice(4, 6);\n  const day = dateStr.slice(6, 8);\n  const date = new Date(`${year}-${month}-${day}`);\n  const weekDayIndex = String(date.getDay());\n  const monthNames: { [key: string]: string } = {\n    '01': 'Jan',\n    '02': 'Feb',\n    '03': 'Mar',\n    '04': 'Apr',\n    '05': 'May',\n    '06': 'Jun',\n    '07': 'Jul',\n    '08': 'Aug',\n    '09': 'Sep',\n    '10': 'Oct',\n    '11': 'Nov',\n    '12': 'Dec',\n  };\n\n  const weekDays: { [key: string]: string } = {\n    '0': 'Sun',\n    '1': 'Mon',\n    '2': 'Tue',\n    '3': 'Wed',\n    '4': 'Thu',\n    '5': 'Fri',\n    '6': 'Sat',\n  };\n\n  return format\n    .replace('MMM', monthNames[month])\n    .replace('DDD', weekDays[weekDayIndex])\n    .replace('YYYY', year)\n    .replace('MM', month)\n    .replace('DD', day);\n}\n","import { getDateString } from '../dates';\nimport { Options, OptionsAction } from './options.models';\nimport { actionTypes } from './options.actions';\n\nconst initialState: Options = {\n  selector: '#race',\n  dataShape: 'long',\n  fillDateGaps: false,\n  fillDateGapsValue: 'last',\n  startDate: '',\n  endDate: '',\n  colorSeed: '',\n  showGroups: true,\n  tickDuration: 500,\n  topN: 10,\n  disableClickEvents: true,\n  disableKeyboardEvents: false,\n  autorun: true,\n  loop: false,\n  injectStyles: true,\n  title: '',\n  subTitle: '',\n  caption: '',\n  dateCounter: 'MM/YYYY',\n  labelsOnBars: true,\n  labelsWidth: 100,\n  showIcons: false,\n  showControls: 'all',\n  showOverlays: 'none',\n  inputHeight: '',\n  inputWidth: '',\n  minHeight: 300,\n  minWidth: 500,\n  height: '',\n  width: '',\n  theme: 'light',\n  colorMap: {},\n};\n\nexport function optionsReducer(state = initialState, action: OptionsAction): Options {\n  switch (action.type) {\n    case actionTypes.optionsLoaded:\n      const startDate = action.payload.startDate ? getDateString(action.payload.startDate) : '';\n      const endDate = action.payload.endDate ? getDateString(action.payload.endDate) : '';\n      const inputHeight = action.payload.height;\n      const inputWidth = action.payload.width;\n      return {\n        ...state,\n        ...action.payload,\n        startDate,\n        endDate,\n        inputHeight,\n        inputWidth,\n      };\n\n    case actionTypes.changeOptions:\n      return {\n        ...state,\n        ...action.payload,\n      };\n\n    default:\n      return state;\n  }\n}\n","import { formatDate, getDateString, getDates } from './dates';\nimport { Data, WideData } from './models';\nimport { store } from './store';\nimport { Options } from './options';\n\nexport function prepareData(rawData: Data[]) {\n  const options = store.getState().options;\n\n  let data = rawData\n    .map((d) => ({ ...d, date: getDateString(d.date) }))\n    .filter((d) => (options.startDate ? d.date >= options.startDate : true))\n    .filter((d) => (options.endDate ? d.date <= options.endDate : true));\n\n  if (options.dataShape === 'wide') {\n    data = wideDataToLong(data);\n  }\n\n  if (options.fillDateGaps) {\n    data = fillGaps(data, options.fillDateGaps);\n  }\n\n  data = data.map((d) => {\n    const value = isNaN(+d.value) ? 0 : +d.value;\n    return { ...d, value };\n  });\n\n  data = calculateLastValues(data);\n\n  return data;\n}\n\nfunction calculateLastValues(data: Data[]) {\n  return data\n    .sort((a, b) => a.name.localeCompare(b.name) || a.date.localeCompare(b.date))\n    .reduce((acc: Data[], curr) => {\n      if (acc.length === 0) {\n        curr.lastValue = curr.value;\n      } else {\n        const last = acc[acc.length - 1];\n        if (curr.name === last.name) {\n          curr.lastValue = last.value;\n        } else {\n          curr.lastValue = curr.value;\n        }\n      }\n      return [...acc, curr];\n    }, [])\n    .sort((a, b) => a.date.localeCompare(b.date));\n}\n\nfunction wideDataToLong(wide: WideData[]) {\n  const long = [] as Data[];\n  wide.forEach((item: WideData) => {\n    for (const [key, value] of Object.entries(item)) {\n      long.push({\n        date: item.date,\n        name: key,\n        value: Number(value),\n      });\n    }\n  });\n  return long;\n}\n\nfunction fillGaps(data: Data[], period: Options['fillDateGaps']) {\n  if (!period) {\n    return data;\n  }\n\n  const dates = getDates(data);\n  const minDate = new Date(formatDate(dates[0]));\n  const maxDate = new Date(formatDate(dates[dates.length - 1]));\n\n  const next = {\n    years: (dt: Date) => {\n      dt.setFullYear(dt.getFullYear() + 1);\n    },\n    months: (dt: Date) => {\n      dt.setMonth(dt.getMonth() + 1);\n    },\n    days: (dt: Date) => {\n      dt.setDate(dt.getDate() + 1);\n    },\n  };\n  if (!next[period]) {\n    return data;\n  }\n\n  const dateRange: string[] = [];\n  for (const date = minDate; date < maxDate; next[period](date)) {\n    dateRange.push(getDateString(date));\n  }\n\n  dateRange.forEach((date, index) => {\n    if (data.filter((d) => d.date === date).length > 0) {\n      return;\n    }\n\n    const missing = data\n      .filter((d) => d.date === dateRange[index - 1])\n      .map((d) =>\n        // const value = {\n        //   last: d.value,\n        //   zero: 0,\n        // }\n        ({\n          ...d,\n          date,\n          // value: value[fillDateGapsValue],\n        }),\n      );\n\n    data.push(...missing);\n  });\n\n  return data;\n}\n\nexport function getDateSlice(data: Data[], date: string) {\n  return data\n    .filter((d) => d.date === date && !isNaN(d.value))\n    .sort((a, b) => b.value - a.value)\n    .map((d, i) => ({ ...d, rank: i }));\n}\n","export const icons = {\r\n  skipBack: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M28.46,4a3,3,0,0,0-3,.07l-15.2,9.41A3,3,0,0,0,9,15V5A3,3,0,0,0,6,2H5A3,3,0,0,0,2,5V27a3,3,0,0,0,3,3H6a3,3,0,0,0,3-3V17a3,3,0,0,0,1.22,1.53L25.42,28a3,3,0,0,0,1.58.46,3,3,0,0,0,3-3V6.59A3,3,0,0,0,28.46,4Z\"/></g></svg>`,\r\n  play: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\r\n  pause: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns:svg=\"http://www.w3.org/2000/svg\"><g transform=\"translate(-17)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g><g transform=\"translate(-4)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g></svg>`,\r\n  skipForward: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M27,2H26a3,3,0,0,0-3,3V15a3,3,0,0,0-1.22-1.53L6.58,4A3,3,0,0,0,2,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,6.58,28l15.2-9.41A3,3,0,0,0,23,17V27a3,3,0,0,0,3,3h1a3,3,0,0,0,3-3V5A3,3,0,0,0,27,2Z\"/></g></svg>`,\r\n  overlayPlay: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\r\n  overlayRepeat: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M18,4A12,12,0,0,0,6.05,15H3a1,1,0,0,0-.88.53,1,1,0,0,0,0,1l4,6a1,1,0,0,0,1.66,0l4-6a1,1,0,0,0,.05-1A1,1,0,0,0,11,15H8.05A10,10,0,1,1,18,26a1,1,0,0,0,0,2A12,12,0,0,0,18,4Z\"/></g></svg>`,\r\n};\r\n","export const elements = {\r\n  controls: 'controls',\r\n  skipBack: 'skipBack',\r\n  play: 'play',\r\n  pause: 'pause',\r\n  skipForward: 'skipForward',\r\n  overlay: 'overlay',\r\n  overlayPlay: 'overlayPlay',\r\n  overlayRepeat: 'overlayRepeat',\r\n};\r\n","import * as d3 from './d3';\n\nimport { icons } from './icons';\nimport { elements } from './elements';\nimport { Data, Renderer } from './models';\nimport { store } from './store';\nimport {\n  getHeight,\n  getWidth,\n  getElement,\n  hideElement,\n  showElement,\n  getText,\n  getColor,\n  getIconID,\n} from './utils';\nimport { getDateSlice } from './data-utils';\n\nexport function createRenderer(data: Data[]): Renderer {\n  let margin: { top: number; right: number; bottom: number; left: number };\n  let svg: any;\n  let x: d3.ScaleLinear<number, number>;\n  let y: d3.ScaleLinear<number, number>;\n  let xAxis: d3.Axis<number | { valueOf(): number }>;\n  const titlePadding = 5;\n  let barPadding: number;\n  let labelPadding: number;\n  let barHeight: number;\n  let barHalfHeight: number;\n  let defs: any;\n  let iconSize: number;\n  let iconSpace: number;\n  let titleText: any;\n  let subTitleText: any;\n  let captionText: any;\n  let dateCounterText: any;\n  let labelX: number | ((d: Data) => number);\n  let barY: (d: Data) => number;\n  let height: number;\n  let width: number;\n\n  function renderInitalView() {\n    const {\n      selector,\n      title,\n      subTitle,\n      caption,\n      dateCounter,\n      labelsOnBars,\n      showIcons,\n      labelsWidth,\n      inputHeight,\n      inputWidth,\n      minHeight,\n      minWidth,\n      topN,\n      colorSeed,\n      colorMap,\n    } = store.getState().options;\n\n    const TotalDateSlice = getDateSlice(data, store.getState().ticker.currentDate);\n    const dateSlice = TotalDateSlice.slice(0, store.getState().options.topN);\n    const element = document.querySelector(selector) as HTMLElement;\n    element.innerHTML = '';\n\n    height = getHeight(element, minHeight, inputHeight);\n    width = getWidth(element, minWidth, inputWidth);\n\n    renderInitialFrame();\n    renderControls();\n    renderOverlays();\n    updateControls();\n\n    function renderInitialFrame() {\n      const groups = Array.from(new Set(data.map((d) => d.group)))\n        .filter(Boolean)\n        .sort() as string[];\n      const showGroups = store.getState().options.showGroups && groups.length > 0;\n      const groupsArea = showGroups ? 40 : 0;\n\n      const labelsArea = labelsOnBars ? 0 : labelsWidth;\n\n      margin = {\n        top: 80 + groupsArea,\n        right: 0,\n        bottom: 5,\n        left: 0 + labelsArea,\n      };\n\n      x = d3\n        .scaleLinear()\n        .domain([0, d3.max(dateSlice, (d: Data) => d.value) as number])\n        .range([margin.left, width - margin.right - 65]);\n\n      y = d3\n        .scaleLinear()\n        .domain([topN, 0])\n        .range([height - margin.bottom, margin.top]);\n\n      barPadding = (height - (margin.bottom + margin.top)) / (topN * 5);\n      labelPadding = 8;\n      barHeight = y(1) - y(0) - barPadding;\n      barHalfHeight = (y(1) - y(0)) / 2 + 1;\n      barY = (d: Data) => y(d.rank as number) + 5;\n      iconSize = showIcons ? barHeight * 0.9 : 0;\n      iconSpace = showIcons ? iconSize + labelPadding : 0;\n      labelX = labelsOnBars\n        ? (d: Data) => x(d.value) - labelPadding - iconSpace\n        : margin.left - labelPadding;\n\n      svg = d3 //\n        .select(selector)\n        .append('svg')\n        .attr('width', width)\n        .attr('height', height);\n\n      titleText = svg //\n        .append('text')\n        .attr('class', 'title')\n        .attr('x', titlePadding)\n        .attr('y', 24)\n        .html(getText(title, TotalDateSlice));\n\n      subTitleText = svg //\n        .append('text')\n        .attr('class', 'subTitle')\n        .attr('x', titlePadding)\n        .attr('y', 55)\n        .html(getText(subTitle, TotalDateSlice));\n\n      if (showGroups) {\n        const groupX = d3\n          .scaleLinear()\n          .domain([groups.length, 0])\n          .range([width - margin.right, margin.left]);\n\n        svg\n          .selectAll('rect.group-color')\n          .data(groups)\n          .enter()\n          .append('rect')\n          .attr('class', 'group-color')\n          .attr('width', 10)\n          .attr('height', 10)\n          .attr('x', (_d: string, i: number) => groupX(i))\n          .attr('y', 75)\n          .style('fill', (d: string) => getColor({ group: d } as Data, true, colorSeed, colorMap));\n\n        svg\n          .selectAll('text.group')\n          .data(groups)\n          .enter()\n          .append('text')\n          .attr('class', 'group')\n          .attr('x', (_d: string, i: number) => groupX(i) + 20)\n          .attr('y', 75 + 10)\n          .html((d: string) => d);\n      }\n\n      xAxis = d3\n        .axisTop(x)\n        .ticks(width > 500 ? 5 : 2)\n        .tickSize(-(height - (margin.top + margin.bottom)))\n        .tickFormat((n: number | { valueOf(): number }) => d3.format(',')(n));\n\n      svg\n        .append('g')\n        .attr('class', 'axis xAxis')\n        .attr('transform', `translate(0, ${margin.top})`)\n        .call(xAxis)\n        .selectAll('.tick line')\n        .classed('origin', (d: number) => d === 0);\n\n      svg\n        .selectAll('rect.bar')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('rect')\n        .attr('class', 'bar')\n        .attr('x', x(0) + 1)\n        .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n        .attr('y', barY)\n        .attr('height', barHeight)\n        .style('fill', (d: Data) => getColor(d, showGroups, colorSeed, colorMap));\n\n      svg\n        .selectAll('text.label')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('text')\n        .attr('class', 'label')\n        .attr('x', labelX)\n        .attr('y', (d: Data) => barY(d) + barHalfHeight)\n        .style('text-anchor', 'end')\n        .html((d: Data) => d.name);\n\n      svg\n        .selectAll('text.valueLabel')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('text')\n        .attr('class', 'valueLabel')\n        .attr('x', (d: Data) => x(d.value) + 5)\n        .attr('y', (d: Data) => barY(d) + barHalfHeight)\n        .text((d: Data) => d3.format(',.0f')(d.lastValue as number));\n\n      if (showIcons) {\n        defs = svg.append('svg:defs');\n\n        defs\n          .selectAll('svg')\n          .data(dateSlice, (d: Data) => d.name)\n          .enter()\n          .append('svg:pattern')\n          .attr('class', 'svgpattern')\n          .attr('id', getIconID)\n          .attr('width', iconSize)\n          .attr('height', iconSize)\n          .append('svg:image')\n          .attr('xlink:href', (d: Data) => d.icon)\n          .attr('width', iconSize)\n          .attr('height', iconSize)\n          .attr('x', 0)\n          .attr('y', 0);\n\n        svg\n          .selectAll('circle')\n          .data(dateSlice, (d: Data) => d.name)\n          .enter()\n          .append('circle')\n          .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n          .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight)\n          .attr('r', iconSize / 2)\n          .style('fill', 'transparent')\n          .style('fill', (d: Data) => `url(#${getIconID(d)})`);\n      }\n\n      dateCounterText = svg\n        .append('text')\n        .attr('class', 'dateCounterText')\n        .attr('x', width - margin.right - barPadding)\n        .attr('y', height - 40)\n        .style('text-anchor', 'end')\n        .html(getText(dateCounter, TotalDateSlice, true))\n        .call(halo);\n\n      captionText = svg\n        .append('text')\n        .attr('class', 'caption')\n        .attr('x', width - margin.right - barPadding - 10)\n        .attr('y', height - margin.bottom - barPadding)\n        .style('text-anchor', 'end')\n        .html(getText(caption, TotalDateSlice));\n    }\n\n    function renderControls() {\n      const controlIcons = [\n        { skipBack: icons.skipBack },\n        { play: icons.play },\n        { pause: icons.pause },\n        { skipForward: icons.skipForward },\n      ];\n\n      const elementWidth = element.getBoundingClientRect().width;\n\n      d3.select(selector)\n        .append('div')\n        .classed('controls', true)\n        .style('width', width)\n        .style('right', elementWidth - width + margin.right + barPadding + 'px')\n        .selectAll('div')\n        .data(controlIcons)\n        .enter()\n        .append('div')\n        .html((d) => Object.values(d)[0] as string)\n        .attr('class', (d) => Object.keys(d)[0]);\n\n      if (store.getState().options.showControls === 'play') {\n        hideElement(elements.skipBack);\n        hideElement(elements.skipForward);\n      }\n      if (store.getState().options.showControls === 'none') {\n        hideElement(elements.controls);\n      }\n    }\n\n    function renderOverlays() {\n      const overlayIcons = [\n        { overlayPlay: icons.overlayPlay },\n        { overlayRepeat: icons.overlayRepeat },\n      ];\n\n      d3.select(selector)\n        .append('div')\n        .classed('overlay', true)\n        .style('minHeight', minHeight + 'px')\n        .style('minWidth', minWidth + 'px')\n        .selectAll('div')\n        .data(overlayIcons)\n        .enter()\n        .append('div')\n        .html((d) => Object.values(d)[0] as string)\n        .attr('class', (d) => Object.keys(d)[0]);\n    }\n  }\n\n  function renderFrame() {\n    if (!x) {\n      return;\n    }\n\n    const {\n      tickDuration,\n      topN,\n      title,\n      subTitle,\n      caption,\n      dateCounter,\n      showGroups,\n      colorSeed,\n      colorMap,\n    } = store.getState().options;\n    const TotalDateSlice = getDateSlice(data, store.getState().ticker.currentDate);\n    const dateSlice = TotalDateSlice.slice(0, store.getState().options.topN);\n\n    x.domain([0, d3.max(dateSlice, (d: Data) => d.value) as number]);\n\n    svg //\n      .select('.xAxis')\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .call(xAxis);\n\n    const bars = svg //\n      .selectAll('.bar')\n      .data(dateSlice, (d: Data) => d.name);\n\n    bars\n      .enter()\n      .append('rect')\n      .attr('class', (d: Data) => `bar ${d.name.replace(/\\s/g, '_')}`)\n      .attr('x', x(0) + 1)\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n      .attr('y', () => y(topN + 1) + 5)\n      .attr('height', barHeight)\n      .style('fill', (d: Data) => getColor(d, showGroups, colorSeed, colorMap))\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('y', barY);\n\n    bars\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n      .attr('y', barY);\n\n    bars\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n      .attr('y', () => y(topN + 1) + 5)\n      .remove();\n\n    const labels = svg //\n      .selectAll('.label')\n      .data(dateSlice, (d: Data) => d.name);\n\n    labels\n      .enter()\n      .append('text')\n      .attr('class', 'label')\n      .attr('x', labelX)\n      .attr('y', () => y(topN + 1) + 5 + barHalfHeight)\n      .style('text-anchor', 'end')\n      .html((d: Data) => d.name)\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight);\n\n    labels\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', labelX)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight);\n\n    labels\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', labelX)\n      .attr('y', () => y(topN + 1) + 5)\n      .remove();\n\n    const valueLabels = svg //\n      .selectAll('.valueLabel')\n      .data(dateSlice, (d: Data) => d.name);\n\n    valueLabels\n      .enter()\n      .append('text')\n      .attr('class', 'valueLabel')\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', () => y(topN + 1) + 5)\n      .text((d: Data) => d3.format(',.0f')(d.lastValue as number))\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight);\n\n    valueLabels\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight)\n      .tween('text', function (d: Data) {\n        const i = d3.interpolateRound(d.lastValue as number, d.value);\n        return function (t: number) {\n          this.textContent = d3.format(',')(i(t));\n        };\n      });\n\n    valueLabels\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', () => y(topN + 1) + 5)\n      .remove();\n\n    if (store.getState().options.showIcons) {\n      const iconPatterns = defs.selectAll('.svgpattern').data(dateSlice, (d: Data) => d.name);\n\n      iconPatterns\n        .enter()\n        .append('svg:pattern')\n        .attr('class', 'svgpattern')\n        .attr('id', getIconID)\n        .attr('width', iconSize)\n        .attr('height', iconSize)\n        .append('svg:image')\n        .attr('xlink:href', (d: Data) => d.icon)\n        .attr('width', iconSize)\n        .attr('height', iconSize)\n        .style('z-index', '99')\n        .attr('x', 0)\n        .attr('y', 0);\n\n      iconPatterns.exit().remove();\n\n      const icons = svg //\n        .selectAll('circle')\n        .data(dateSlice, (d: Data) => d.name);\n\n      icons\n        .enter()\n        .append('circle')\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n        .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\n        .attr('r', iconSize / 2)\n        .style('z-index', '99')\n        .style('fill', 'transparent')\n        .style('fill', (d: Data) => `url(#${getIconID(d)})`)\n        .transition()\n        .duration(tickDuration)\n        .ease(d3.easeLinear)\n        .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\n\n      icons\n        .transition()\n        .duration(tickDuration)\n        .ease(d3.easeLinear)\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n        .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\n\n      icons\n        .exit()\n        .transition()\n        .duration(tickDuration)\n        .ease(d3.easeLinear)\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n        .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\n        .remove();\n    }\n\n    titleText.html(getText(title, TotalDateSlice));\n    subTitleText.html(getText(subTitle, TotalDateSlice));\n    captionText.html(getText(caption, TotalDateSlice));\n    dateCounterText.html(getText(dateCounter, TotalDateSlice, true)).call(halo);\n    updateControls();\n  }\n\n  function resize() {\n    if (\n      (!store.getState().options.inputHeight && !store.getState().options.inputWidth) ||\n      String(store.getState().options.inputHeight).startsWith('window') ||\n      String(store.getState().options.inputWidth).startsWith('window')\n    ) {\n      const element = document.querySelector(store.getState().options.selector) as HTMLElement;\n\n      height = getHeight(\n        element,\n        store.getState().options.minHeight,\n        store.getState().options.inputHeight,\n      );\n      width = getWidth(\n        element,\n        store.getState().options.minWidth,\n        store.getState().options.inputWidth,\n      );\n\n      const currentPosition = element.style.position; // \"fixed\" if scrolling\n      renderInitalView();\n      renderFrame();\n      updateControls();\n      element.style.position = currentPosition;\n    }\n  }\n\n  function updateControls() {\n    const showOverlays = store.getState().options.showOverlays;\n\n    if (store.getState().ticker.isRunning) {\n      showElement(elements.pause);\n      hideElement(elements.play);\n    } else {\n      showElement(elements.play);\n      hideElement(elements.pause);\n    }\n\n    if (\n      store.getState().ticker.isFirstDate &&\n      (showOverlays === 'all' || showOverlays === 'play') &&\n      !store.getState().ticker.isRunning\n    ) {\n      getElement(elements.controls).style.visibility = 'hidden';\n      showElement(elements.overlay);\n      showElement(elements.overlayPlay);\n      hideElement(elements.overlayRepeat);\n    } else if (\n      store.getState().ticker.isLastDate &&\n      (showOverlays === 'all' || showOverlays === 'repeat') &&\n      !(store.getState().options.loop && store.getState().ticker.isRunning)\n    ) {\n      getElement(elements.controls).style.visibility = 'hidden';\n      showElement(elements.overlay);\n      showElement(elements.overlayRepeat);\n      hideElement(elements.overlayPlay);\n    } else {\n      getElement(elements.controls).style.visibility = 'unset';\n      getElement(elements.overlay).style.display = 'none';\n    }\n  }\n\n  function halo(text: any) {\n    svg //\n      .selectAll('.halo')\n      .remove();\n\n    text\n      .select(function () {\n        return this.parentNode.insertBefore(this.cloneNode(true), this);\n      })\n      .classed('halo', true);\n  }\n\n  return {\n    renderInitalView,\n    renderFrame,\n    resize,\n  };\n}\n","// This file is auto-generated and will be over-written!\n// Please do NOT edit this file directly\n// You may edit files in this folder instead: src\\lib\\css\n\nexport const styles = `\n__selector__ text {\n  font-size: 16px;\n  font-family: Open Sans, sans-serif;\n}\n\n__selector__ text.title {\n  font-size: 24px;\n  font-weight: 500;\n}\n\n__selector__ text.subTitle {\n  font-weight: 500;\n}\n\n__selector__ text.caption {\n  font-weight: 400;\n  font-size: 24px;\n}\n\n__selector__ text.label {\n  font-weight: 600;\n}\n\n__selector__ text.valueLabel {\n  font-weight: 300;\n}\n\n__selector__ text.dateCounterText {\n  font-size: 64px;\n  font-weight: 700;\n}\n\n__selector__ .xAxis .tick:nth-child(2) text {\n  text-anchor: start;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n}\n\n__selector__ path.domain {\n  display: none;\n}\n\n__selector__ {\n  position: relative;\n}\n\n__selector__ .controls {\n  /*  width and right are set dynamically in renderer.ts */\n  position: absolute;\n  top: 0;\n  display: flex;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  cursor: pointer;\n  font-size: 24px;\n  font-weight: 700;\n  width: 38px;\n  height: 38px;\n  -moz-border-radius: 5px;\n  -webkit-border-radius: 5px;\n  border-radius: 5px;\n  margin: 5px;\n  text-align: center;\n}\n\n__selector__ .controls svg {\n  margin: 5px auto;\n  width: 28px;\n  height: 28px;\n}\n\n__selector__ .overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n__selector__ .overlay div {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 200px;\n  height: 200px;\n  -moz-border-radius: 100px;\n  -webkit-border-radius: 100px;\n  border-radius: 100px;\n}\n__selector__ .overlay svg {\n  height: 50%;\n  width: 50%;\n}\n`;\n\nexport const themes = {\n\"dark\": `\n__selector__ {\n  background-color: #313639;\n}\n\n__selector__ text.title {\n  fill: #fafafa;\n}\n\n__selector__ text.subTitle {\n  fill: #cccccc;\n}\n\n__selector__ text.dateCounterText {\n  fill: #cccccc;\n  opacity: 1;\n}\n\n__selector__ text.caption {\n  fill: #cccccc;\n}\n\n__selector__ .halo {\n  fill: #313639;\n  stroke: #313639;\n  stroke-width: 10;\n  stroke-linejoin: round;\n  opacity: 1;\n}\n\n__selector__ text.label {\n  fill: #313639;\n}\n\n__selector__ text.valueLabel {\n  fill: #fafafa;\n}\n\n__selector__ .tick text {\n  fill: #cccccc;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n  stroke: #dddddd;\n}\n\n__selector__ .tick line.origin {\n  stroke: #aaaaaa;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  color: #ffffff;\n  background: #777777;\n  border: 1px solid black;\n  opacity: 0.5;\n}\n\n__selector__ .controls div:hover,\n__selector__ .overlay div:hover {\n  background: #aaaaaa;\n  color: black;\n}\n\n__selector__ .overlay {\n  background-color: black;\n  opacity: 0.7;\n}\n`,\n\"light\": `\n/* __selector__ {\n  background-color: #ffffff;\n}\n\n__selector__ text.title {\n  fill: #fafafa;\n} */\n\n__selector__ text.subTitle {\n  fill: #777777;\n}\n\n__selector__ text.dateCounterText {\n  fill: #bbbbbb;\n  opacity: 1;\n}\n\n__selector__ text.caption {\n  fill: #777777;\n}\n\n__selector__ .halo {\n  fill: #ffffff;\n  stroke: #ffffff;\n  stroke-width: 10;\n  stroke-linejoin: round;\n  opacity: 1;\n}\n\n__selector__ text.label {\n  fill: #000000;\n}\n\n__selector__ text.valueLabel {\n  fill: #000000;\n}\n\n__selector__ .tick text {\n  fill: #777777;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n  stroke: #dddddd;\n}\n\n__selector__ .tick line.origin {\n  stroke: #aaaaaa;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  color: #ffffff;\n  background: #777777;\n  border: 1px solid black;\n  opacity: 0.5;\n}\n\n__selector__ .controls div:hover,\n__selector__ .overlay div:hover {\n  background: #aaaaaa;\n  color: black;\n}\n\n__selector__ .overlay {\n  background-color: black;\n  opacity: 0.7;\n}\n`,\n};\n","import { store } from '../store';\nimport { styles, themes } from './generated-styles';\n\n// modifed from https://github.com/egoist/style-inject\nexport function styleInject(selector: string, insertAt = 'top') {\n  let css = styles + (themes as any)[store.getState().options.theme];\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  // replace with selector\n  css = css.split('__selector__').join(selector);\n\n  const head = document.head || document.getElementsByTagName('head')[0];\n  const style = document.createElement('style') as HTMLStyleElement | any;\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n","import { elements } from './elements';\nimport { store } from './store';\nimport { Ticker } from './ticker';\nimport { addEventHandler, hideElement } from './utils';\nimport { formatDate } from './dates';\nimport { DOMCustomEvent } from './models';\n\nexport function registerEvents(element: HTMLElement, ticker: Ticker) {\n  registerControlButtonEvents();\n  registerOverlayEvents();\n  registerClickEvents();\n  registerKeyboardEvents();\n\n  function registerControlButtonEvents() {\n    addEventHandler(elements.skipBack, 'click', ticker.skipBack);\n    addEventHandler(elements.play, 'click', ticker.toggle);\n    addEventHandler(elements.pause, 'click', ticker.toggle);\n    addEventHandler(elements.skipForward, 'click', ticker.skipForward);\n  }\n\n  function registerOverlayEvents() {\n    addEventHandler(elements.overlayPlay, 'click', () => {\n      hideElement(elements.overlay);\n      ticker.start();\n    });\n    addEventHandler(elements.overlayRepeat, 'click', () => {\n      hideElement(elements.overlay);\n      ticker.loop();\n      ticker.start();\n    });\n  }\n\n  function registerClickEvents() {\n    if (!store.getState().options.disableClickEvents) {\n      const svg = element.querySelector('svg') as SVGSVGElement;\n      svg.addEventListener('click', ticker.toggle);\n      element.addEventListener('dblclick', ticker.skipForward);\n    }\n  }\n\n  function registerKeyboardEvents() {\n    if (!store.getState().options.disableKeyboardEvents) {\n      document.addEventListener('keypress', function (e) {\n        const keyCodes = {\n          spacebar: 32,\n          a: 97,\n          d: 100,\n          s: 115,\n        };\n\n        // TODO: keyCode is deprecated\n        switch (e.keyCode) {\n          case keyCodes.spacebar:\n            ticker.toggle();\n            break;\n          case keyCodes.a:\n            ticker.skipBack();\n            break;\n          case keyCodes.s:\n            ticker.toggle();\n            break;\n          case keyCodes.d:\n            ticker.skipForward();\n            break;\n        }\n      });\n    }\n  }\n}\n\nfunction dispatchDOMEvent(element: HTMLElement, currentDate: string) {\n  element.dispatchEvent(\n    new CustomEvent('racingBars/dateChanged', {\n      bubbles: true,\n      detail: {\n        date: formatDate(currentDate),\n        isFirst: store.getState().ticker.isFirstDate,\n        isLast: store.getState().ticker.isLastDate,\n      },\n    } as DOMCustomEvent),\n  );\n}\n\nexport function DOMEventSubscriber(element: HTMLElement) {\n  let lastDate = '';\n  return function () {\n    const currentDate = store.getState().ticker.currentDate;\n    if (currentDate !== lastDate) {\n      dispatchDOMEvent(element, currentDate);\n      lastDate = currentDate;\n    }\n  };\n}\n","import { store, actions } from './store';\r\n\r\nexport function createScroller(element: HTMLElement) {\r\n  const dates = store.getState().ticker.dates;\r\n  prepareDOM();\r\n\r\n  const step = document.body.clientHeight / dates.length;\r\n\r\n  subscribeToEvents();\r\n\r\n  function prepareDOM() {\r\n    element.style.position = 'fixed';\r\n    element.style.top = '0';\r\n\r\n    const scrollElement = document.createElement('div');\r\n    scrollElement.style.height = window.innerHeight * 10 + 'px';\r\n    document.body.appendChild(scrollElement);\r\n  }\r\n\r\n  function subscribeToEvents() {\r\n    window.addEventListener('scroll', goToDate);\r\n    // element.addEventListener(\"dateChanged\", scrollToPosition);\r\n  }\r\n\r\n  // function scrollToPosition(e: CustomEvent) {\r\n  //   let currentDate = getDateString(e.detail.date);\r\n  //   let index = dates.indexOf(currentDate);\r\n  //   ignoreNextScrollEvent = true;\r\n  //   window.scroll({\r\n  //     top: index * step,\r\n  //     behavior: \"smooth\",\r\n  //   });\r\n  // }\r\n\r\n  function goToDate() {\r\n    const index = Math.ceil(window.pageYOffset / step);\r\n    if (index < dates.length) {\r\n      store.dispatch(actions.ticker.updateDate(dates[index]));\r\n    } else {\r\n      store.dispatch(actions.ticker.setLast());\r\n    }\r\n  }\r\n}\r\n","import { prepareData } from './data-utils';\r\nimport { getDates, getDateString, formatDate } from './dates';\r\nimport { Data, WideData } from './models';\r\nimport { createRenderer } from './renderer';\r\nimport { createTicker } from './ticker';\r\nimport { styleInject } from './styles';\r\nimport { actions, store } from './store';\r\nimport { Options, RequiredOptions } from './options';\r\nimport { registerEvents, DOMEventSubscriber } from './events';\r\nimport { createScroller } from './scroller';\r\n\r\nexport function race(data: Data[] | WideData[], options: Options | RequiredOptions) {\r\n  store.dispatch(actions.options.optionsLoaded(options));\r\n\r\n  const element = document.querySelector(store.getState().options.selector) as HTMLElement;\r\n  if (!element) {\r\n    throw new Error('Cannot find element with this selector: ' + store.getState().options.selector);\r\n  }\r\n\r\n  if (store.getState().options.injectStyles) {\r\n    styleInject(store.getState().options.selector, 'top');\r\n  }\r\n\r\n  const preparedData = prepareData(data as Data[]);\r\n\r\n  const dates = getDates(preparedData);\r\n\r\n  const ticker = createTicker(dates);\r\n\r\n  const renderer = createRenderer(preparedData);\r\n  renderer.renderInitalView();\r\n\r\n  store.subscribe(renderer.renderFrame);\r\n  store.subscribe(DOMEventSubscriber(element));\r\n\r\n  ticker.start();\r\n\r\n  if (!store.getState().options.autorun) {\r\n    ticker.stop();\r\n  }\r\n\r\n  registerEvents(element, ticker);\r\n  window.addEventListener('resize', resize);\r\n\r\n  function resize() {\r\n    renderer.resize();\r\n    registerEvents(element, ticker);\r\n  }\r\n\r\n  return {\r\n    // TODO: validate user input\r\n    start: () => {\r\n      if (!store.getState().ticker.isRunning) {\r\n        ticker.start();\r\n      }\r\n    },\r\n    stop: () => {\r\n      ticker.stop();\r\n    },\r\n    rewind: () => {\r\n      ticker.skipBack();\r\n    },\r\n    fastforward: () => {\r\n      ticker.skipForward();\r\n    },\r\n    loop: () => {\r\n      ticker.loop();\r\n    },\r\n    inc: (value = 1) => {\r\n      store.dispatch(actions.ticker.inc(value));\r\n    },\r\n    dec: (value = 1) => {\r\n      store.dispatch(actions.ticker.dec(value));\r\n    },\r\n    getDate: () => store.getState().ticker.currentDate,\r\n    setDate: (inputDate: string | Date) => {\r\n      store.dispatch(actions.ticker.updateDate(getDateString(inputDate)));\r\n    },\r\n    getAllDates: () => dates.map((date: string) => formatDate(date)),\r\n    createScroller: () => {\r\n      createScroller(element);\r\n    },\r\n  };\r\n}\r\n"],"names":["loadData","URL","type","d3","Error","actionTypes","optionsLoaded","changeOptions","optionsChanged","options","payload","initialize","updateDate","setRunning","setFirst","setLast","inc","dec","dates","currentDate","running","value","initialState","isRunning","isFirstDate","isLastDate","tickerReducer","state","action","indexOf","length","currentIndex","lastIndex","incValue","newDate","decValue","createTicker","store","dispatch","actions","ticker","start","showRace","getState","tickDuration","_","loop","stop","skipBack","skipForward","toggle","goToDate","date","rootReducer","optionsReducer","createStore","reducer","preloadedState","notifySubscribers","subscribers","subscribe","fn","push","index","unsubscribe","splice","forEach","getColor","d","showGroups","colorSeed","colorMap","color","name","group","nameseed","seed","random","getIconID","toLowerCase","split","join","zeroPad","n","w","toString","seedStr","toNumbers","s","nums","i","String","charCodeAt","x","Math","sin","floor","randomString","prefix","rnd","Array","fill","map","substr","slice","generateId","getHeight","element","minHeight","height","newHeight","getBoundingClientRect","startsWith","scale","window","innerHeight","getWidth","minWidth","width","newWidth","innerWidth","getElement","className","document","querySelector","selector","showElement","style","display","hideElement","addEventHandler","event","handler","addEventListener","getText","param","dateSlice","isDate","formatDate","getDates","data","from","Set","sort","getDateString","inputDate","Date","isNaN","year","getFullYear","month","getMonth","day","getDate","dateStr","format","weekDayIndex","getDay","monthNames","weekDays","replace","dataShape","fillDateGaps","fillDateGapsValue","startDate","endDate","topN","disableClickEvents","disableKeyboardEvents","autorun","injectStyles","title","subTitle","caption","dateCounter","labelsOnBars","labelsWidth","showIcons","showControls","showOverlays","inputHeight","inputWidth","theme","prepareData","rawData","filter","wideDataToLong","fillGaps","calculateLastValues","a","b","localeCompare","reduce","acc","curr","lastValue","last","wide","long","item","Object","entries","key","Number","period","minDate","maxDate","next","years","dt","setFullYear","months","setMonth","days","setDate","dateRange","missing","getDateSlice","rank","icons","play","pause","overlayPlay","overlayRepeat","elements","controls","overlay","createRenderer","margin","svg","y","xAxis","titlePadding","barPadding","labelPadding","barHeight","barHalfHeight","defs","iconSize","iconSpace","titleText","subTitleText","captionText","dateCounterText","labelX","barY","renderInitalView","TotalDateSlice","innerHTML","renderInitialFrame","renderControls","renderOverlays","updateControls","groups","Boolean","groupsArea","labelsArea","top","right","bottom","left","domain","range","append","attr","html","groupX","selectAll","enter","_d","ticks","tickSize","tickFormat","call","classed","abs","text","icon","halo","controlIcons","elementWidth","values","keys","overlayIcons","renderFrame","select","transition","duration","ease","bars","exit","remove","labels","valueLabels","tween","t","textContent","iconPatterns","resize","currentPosition","position","visibility","parentNode","insertBefore","cloneNode","styles","themes","styleInject","insertAt","css","head","getElementsByTagName","createElement","firstChild","appendChild","styleSheet","cssText","createTextNode","registerEvents","registerControlButtonEvents","registerOverlayEvents","registerClickEvents","registerKeyboardEvents","e","keyCodes","spacebar","keyCode","dispatchDOMEvent","dispatchEvent","CustomEvent","bubbles","detail","isFirst","isLast","DOMEventSubscriber","lastDate","createScroller","prepareDOM","step","body","clientHeight","subscribeToEvents","scrollElement","ceil","pageYOffset","race","preparedData","renderer","rewind","fastforward","getAllDates"],"mappings":"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"}