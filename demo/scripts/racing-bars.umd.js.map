{"version":3,"file":"racing-bars.umd.js","sources":["../../src/lib/load-data.ts","../../src/lib/utils.ts","../../src/lib/dates.ts","../../src/lib/data/data.actions.ts","../../src/lib/data/data.reducer.ts","../../src/lib/options/options.actions.ts","../../src/lib/options/options.reducer.ts","../../src/lib/ticker/ticker.actions.ts","../../src/lib/ticker/ticker.reducer.ts","../../src/lib/ticker/ticker.ts","../../src/lib/store/actions.ts","../../src/lib/store/reducer.ts","../../src/lib/store/store.ts","../../src/lib/data-utils.ts","../../src/lib/icons.ts","../../src/lib/elements.ts","../../src/lib/renderer.ts","../../src/lib/styles/generated-styles.ts","../../src/lib/styles/style-inject.ts","../../src/lib/events.ts","../../src/lib/scroller.ts","../../src/lib/race.ts"],"sourcesContent":["import * as d3 from './d3';\n\nexport function loadData(URL: string, type: 'json' | 'csv' | 'tsv' | 'xml' = 'json') {\n  switch (type) {\n    case 'json':\n      return d3.json(URL);\n    case 'csv':\n      return d3.csv(URL);\n    case 'tsv':\n      return d3.tsv(URL);\n    case 'xml':\n      return d3.xml(URL);\n    default:\n      throw new Error(`Unsupported data type: ${type}`);\n  }\n}\n","import * as d3 from './d3';\r\n\r\nimport { Data } from './data';\r\nimport { Store } from './store';\r\nimport { formatDate } from './dates';\r\nimport { ParamFunction } from './options';\r\n\r\nexport function getColor(d: Data, store: Store) {\r\n  const { names, groups } = store.getState().data;\r\n  const { showGroups, colorSeed, colorMap } = store.getState().options;\r\n\r\n  if (d.color) {\r\n    return d.color;\r\n  }\r\n\r\n  const useGroup = Boolean(d.group) && showGroups && groups.length > 0;\r\n  let values = useGroup ? groups : names;\r\n  if (colorSeed) {\r\n    values = shuffle(values, toNumber(colorSeed));\r\n  }\r\n  const currentValue = (useGroup ? d.group : d.name) as string;\r\n  let index = values.indexOf(currentValue);\r\n\r\n  if (colorMap) {\r\n    if (Array.isArray(colorMap)) {\r\n      while (index > colorMap.length - 1) {\r\n        index = index - colorMap.length;\r\n      }\r\n      return colorMap[index];\r\n    } else {\r\n      if (colorMap[currentValue]) {\r\n        return colorMap[currentValue];\r\n      }\r\n    }\r\n  }\r\n\r\n  const negativeIfOdd = index % 2 === 0 ? 1 : -1;\r\n  const lumVariation = (random(currentValue) / 10) * negativeIfOdd;\r\n  const HueSpacing = 360 / (values.length + 1);\r\n  const hue = (values.indexOf(currentValue) + 1) * HueSpacing;\r\n  return d3.hsl(hue, 0.75, 0.75 + lumVariation);\r\n}\r\n\r\nexport function getIconID(d: Data) {\r\n  return 'icon-' + safeName(d.name);\r\n}\r\n\r\nexport function zeroPad(n: string, w: number) {\r\n  while (n.toString().length < w) {\r\n    n = '0' + n;\r\n  }\r\n  return n;\r\n}\r\n\r\nfunction toNumber(s: string | number) {\r\n  s = String(s);\r\n  let nums = '';\r\n  for (let i = 0; i < s.length; i++) {\r\n    nums += zeroPad(String(s.charCodeAt(i)), 3);\r\n  }\r\n  return +nums;\r\n}\r\n\r\nexport function random(InputSeed: string | number) {\r\n  const seed = toNumber(InputSeed);\r\n  const x = Math.sin(seed) * 10000;\r\n  return x - Math.floor(x);\r\n}\r\n\r\nexport function randomString(prefix: string, n: number) {\r\n  const rnd = Array(3)\r\n    .fill(null)\r\n    .map(() => Math.random().toString(36).substr(2))\r\n    .join('');\r\n  return prefix + rnd.slice(-n);\r\n}\r\n\r\nexport function shuffle(arr: any[], seed: number) {\r\n  const array = [...arr];\r\n  let m = array.length;\r\n  let t;\r\n  let i;\r\n\r\n  while (m) {\r\n    i = Math.floor(random(seed) * m--);\r\n    t = array[m];\r\n    array[m] = array[i];\r\n    array[i] = t;\r\n    ++seed;\r\n  }\r\n\r\n  return array;\r\n}\r\n\r\nexport function generateId(prefix = 'racingbars', n = 8) {\r\n  return randomString(prefix, n);\r\n}\r\n\r\nexport function getHeight(element: HTMLElement, minHeight: number, height?: string) {\r\n  let newHeight;\r\n  if (!height) {\r\n    newHeight = element.getBoundingClientRect().height;\r\n  } else if (String(height).startsWith('window')) {\r\n    const scale = +height.split('*')[1] || 1;\r\n    newHeight = window.innerHeight * scale;\r\n  } else {\r\n    newHeight = +height;\r\n  }\r\n  return newHeight > minHeight ? newHeight : minHeight;\r\n}\r\n\r\nexport function getWidth(element: HTMLElement, minWidth: number, width?: string) {\r\n  let newWidth;\r\n  if (!width) {\r\n    newWidth = element.getBoundingClientRect().width;\r\n  } else if (String(width).startsWith('window')) {\r\n    const scale = +width.split('*')[1] || 1;\r\n    newWidth = window.innerWidth * scale;\r\n  } else {\r\n    newWidth = +width;\r\n  }\r\n  return newWidth > minWidth ? newWidth : minWidth;\r\n}\r\n\r\nexport function getElement(root: HTMLElement, className: string) {\r\n  return root.querySelector('.' + className) as HTMLElement;\r\n}\r\n\r\nexport function showElement(root: HTMLElement, className: string) {\r\n  const element = getElement(root, className);\r\n  if (element) {\r\n    element.style.display = 'flex';\r\n  }\r\n}\r\n\r\nexport function hideElement(root: HTMLElement, className: string) {\r\n  const element = getElement(root, className);\r\n  if (element) {\r\n    element.style.display = 'none';\r\n  }\r\n}\r\n\r\nexport function removeElement(root: HTMLElement, className: string) {\r\n  const element = getElement(root, className);\r\n  if (element) {\r\n    element.remove();\r\n  }\r\n}\r\n\r\nexport function addEventHandler(\r\n  root: HTMLElement,\r\n  className: string,\r\n  event: string,\r\n  handler: () => void,\r\n) {\r\n  const element = getElement(root, className);\r\n  if (element) {\r\n    element.addEventListener(event, handler);\r\n  }\r\n}\r\n\r\nexport function getText(\r\n  param: string | ParamFunction,\r\n  dateSlice: Data[],\r\n  dates: string[],\r\n  currentDate: string,\r\n  isDate = false,\r\n): string {\r\n  if (typeof param === 'function') {\r\n    return param(currentDate, dateSlice, dates);\r\n  }\r\n  if (isDate) {\r\n    return formatDate(currentDate, param);\r\n  }\r\n  return param;\r\n}\r\n\r\nexport function safeName(name: string) {\r\n  // replace non-alphanumeric with underscore\r\n  return name.replace(/[\\W]+/g, '_');\r\n}\r\n\r\nexport function toggleClass(root: HTMLElement, selector: string, className: string) {\r\n  d3.select(root)\r\n    .select(selector)\r\n    .classed(className, function () {\r\n      return !d3.select(this).classed(className);\r\n    });\r\n}\r\n\r\nfunction debounce(func: any, wait: number, immediate = false) {\r\n  let timeout: any;\r\n  return function (_clicks: any, _Fn: (clicks: number) => void) {\r\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\r\n    const context = this;\r\n    const args = arguments;\r\n    const later = function () {\r\n      timeout = null;\r\n      if (!immediate) {\r\n        func.apply(context, args);\r\n      }\r\n    };\r\n    const callNow = immediate && !timeout;\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n    if (callNow) {\r\n      func.apply(context, args);\r\n    }\r\n  };\r\n}\r\nexport const getClicks = debounce(function (event: any, Fn: (event: any) => void) {\r\n  Fn(event);\r\n}, 250);\r\n","import { Data } from './data';\nimport { zeroPad } from './utils';\n\nexport const getDates = (data: Data[]) => Array.from(new Set(data.map((d) => d.date))).sort();\n\nexport function getDateString(inputDate: string | Date) {\n  const date = new Date(inputDate);\n  if (isNaN(+date)) {\n    throw new Error(`\"${inputDate}\" is not a valid date`);\n  }\n\n  const year = date.getFullYear().toString();\n  const month = zeroPad((1 + date.getMonth()).toString(), 2);\n  const day = zeroPad(date.getDate().toString(), 2);\n\n  return `${year}-${month}-${day}`;\n}\n\nexport function formatDate(dateStr: string, format = 'YYYY-MM-DD') {\n  const year = dateStr.slice(0, 4);\n  const month = dateStr.slice(5, 7);\n  const day = dateStr.slice(8, 10);\n  const date = new Date(dateStr);\n  const weekDayIndex = String(date.getDay());\n  const monthNames: { [key: string]: string } = {\n    '01': 'Jan',\n    '02': 'Feb',\n    '03': 'Mar',\n    '04': 'Apr',\n    '05': 'May',\n    '06': 'Jun',\n    '07': 'Jul',\n    '08': 'Aug',\n    '09': 'Sep',\n    '10': 'Oct',\n    '11': 'Nov',\n    '12': 'Dec',\n  };\n\n  const weekDays: { [key: string]: string } = {\n    '0': 'Sun',\n    '1': 'Mon',\n    '2': 'Tue',\n    '3': 'Wed',\n    '4': 'Thu',\n    '5': 'Fri',\n    '6': 'Sat',\n  };\n\n  return format\n    .replace('MMM', monthNames[month])\n    .replace('DDD', weekDays[weekDayIndex])\n    .replace('YYYY', year)\n    .replace('MM', month)\n    .replace('DD', day);\n}\n","import { DataAction, DataCollections } from './data.models';\n\nexport const actionTypes = {\n  dataLoaded: 'data/loaded',\n  addFilter: 'data/addFilter',\n  removeFilter: 'data/removeFilter',\n  toggleFilter: 'data/toggleFilter',\n  resetFilters: 'data/resetFilters',\n  allExceptFilter: 'data/allExceptFilter',\n  addSelection: 'data/addSelection',\n  removeSelection: 'data/removeSelection',\n  toggleSelection: 'data/toggleSelection',\n  resetSelections: 'data/resetSelections',\n};\n\nexport const dataLoaded = (dataCollections: DataCollections): DataAction => ({\n  type: actionTypes.dataLoaded,\n  payload: dataCollections,\n});\n\nexport const addFilter = (group: string): DataAction => ({\n  type: actionTypes.addFilter,\n  payload: group,\n});\n\nexport const removeFilter = (group: string): DataAction => ({\n  type: actionTypes.removeFilter,\n  payload: group,\n});\n\nexport const toggleFilter = (group: string): DataAction => ({\n  type: actionTypes.toggleFilter,\n  payload: group,\n});\n\nexport const resetFilters = (): DataAction => ({\n  type: actionTypes.resetFilters,\n});\n\nexport const allExceptFilter = (group: string): DataAction => ({\n  type: actionTypes.allExceptFilter,\n  payload: group,\n});\n\nexport const addSelection = (selection: string): DataAction => ({\n  type: actionTypes.addSelection,\n  payload: selection,\n});\n\nexport const removeSelection = (selection: string): DataAction => ({\n  type: actionTypes.removeSelection,\n  payload: selection,\n});\n\nexport const toggleSelection = (selection: string): DataAction => ({\n  type: actionTypes.toggleSelection,\n  payload: selection,\n});\n\nexport const resetSelections = (): DataAction => ({\n  type: actionTypes.resetSelections,\n});\n","import { actionTypes } from './data.actions';\r\nimport { DataState, DataAction, DataCollections } from './data.models';\r\n\r\nconst initialState: DataState = {\r\n  names: [],\r\n  groups: [],\r\n  groupFilter: [],\r\n  selected: [],\r\n};\r\n\r\nexport function dataReducer(state = initialState, action: DataAction): DataState {\r\n  switch (action.type) {\r\n    case actionTypes.dataLoaded: {\r\n      const collections = action.payload as DataCollections;\r\n      return {\r\n        ...state,\r\n        names: [...collections.names],\r\n        groups: [...collections.groups],\r\n      };\r\n    }\r\n\r\n    case actionTypes.addFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: addToArray(state.groupFilter, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.removeFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: removeFromArray(state.groupFilter, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.toggleFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: toggleItem(state.groupFilter, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.resetFilters:\r\n      return {\r\n        ...state,\r\n        groupFilter: [],\r\n      };\r\n\r\n    case actionTypes.allExceptFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: removeFromArray(state.groups, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.addSelection:\r\n      return {\r\n        ...state,\r\n        selected: addToArray(state.selected, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.removeSelection:\r\n      return {\r\n        ...state,\r\n        selected: removeFromArray(state.selected, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.toggleSelection:\r\n      return {\r\n        ...state,\r\n        selected: toggleItem(state.selected, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.resetSelections:\r\n      return {\r\n        ...state,\r\n        selected: [],\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction addToArray(array: string[], item: string) {\r\n  const arr = [...array];\r\n  if (!arr.includes(item)) {\r\n    arr.push(item);\r\n  }\r\n  return arr;\r\n}\r\n\r\nfunction removeFromArray(array: string[], item: string) {\r\n  return array.filter((x) => x !== item);\r\n}\r\n\r\nfunction toggleItem(array: string[], item: string) {\r\n  return array.includes(item) ? removeFromArray(array, item) : addToArray(array, item);\r\n}\r\n","import { Options, OptionsAction, RequiredOptions } from './options.models';\r\n\r\nexport const actionTypes = {\r\n  optionsLoaded: 'options/loaded',\r\n  changeOptions: 'options/change',\r\n  optionsChanged: 'options/changed',\r\n};\r\n\r\nexport const optionsLoaded = (options: Options | RequiredOptions): OptionsAction => ({\r\n  type: actionTypes.optionsLoaded,\r\n  payload: options,\r\n});\r\n\r\nexport const changeOptions = (options: Options): OptionsAction => ({\r\n  type: actionTypes.changeOptions,\r\n  payload: options,\r\n});\r\n\r\nexport const optionsChanged = (options: Options): OptionsAction => ({\r\n  type: actionTypes.optionsChanged,\r\n  payload: options,\r\n});\r\n","import { getDateString } from '../dates';\nimport { Options, OptionsAction } from './options.models';\nimport { actionTypes } from './options.actions';\n\nconst initialState: Options = {\n  selector: '#race',\n  dataShape: 'long',\n  fillDateGaps: false,\n  fillDateGapsValue: 'interpolate',\n  startDate: '',\n  endDate: '',\n  colorSeed: '',\n  showGroups: true,\n  tickDuration: 500,\n  topN: 10,\n  disableClickEvents: true,\n  disableKeyboardEvents: false,\n  autorun: true,\n  loop: false,\n  // loopDelay: 0,\n  injectStyles: true,\n  title: '',\n  subTitle: '',\n  caption: '',\n  dateCounter: 'MM/YYYY',\n  labelsOnBars: true,\n  labelsWidth: 100,\n  showIcons: false,\n  showControls: 'all',\n  showOverlays: 'none',\n  inputHeight: '',\n  inputWidth: '',\n  minHeight: 300,\n  minWidth: 500,\n  height: '',\n  width: '',\n  theme: 'light',\n  colorMap: {},\n  fixedScale: false,\n  highlightBars: false,\n  selectBars: false,\n};\n\nexport function optionsReducer(state = initialState, action: OptionsAction): Options {\n  switch (action.type) {\n    case actionTypes.optionsLoaded:\n      const startDate = action.payload.startDate ? getDateString(action.payload.startDate) : '';\n      const endDate = action.payload.endDate ? getDateString(action.payload.endDate) : '';\n      const inputHeight = action.payload.height;\n      const inputWidth = action.payload.width;\n      return {\n        ...state,\n        ...action.payload,\n        startDate,\n        endDate,\n        inputHeight,\n        inputWidth,\n      };\n\n    case actionTypes.changeOptions:\n      return {\n        ...state,\n        ...action.payload,\n      };\n\n    default:\n      return state;\n  }\n}\n","import { TickerAction } from './ticker.models';\r\n\r\nexport const actionTypes = {\r\n  initialize: 'ticker/initialize',\r\n  updateDate: 'ticker/updateDate',\r\n  setRunning: 'ticker/setRunning',\r\n  setFirst: 'ticker/setFirst',\r\n  setLast: 'ticker/setLast',\r\n  inc: 'ticker/inc',\r\n  dec: 'ticker/dec',\r\n};\r\n\r\nexport const initialize = (dates: string[]): TickerAction => ({\r\n  type: actionTypes.initialize,\r\n  payload: dates,\r\n});\r\n\r\nexport const updateDate = (currentDate: string): TickerAction => ({\r\n  type: actionTypes.updateDate,\r\n  payload: currentDate,\r\n});\r\n\r\nexport const setRunning = (running: boolean): TickerAction => ({\r\n  type: actionTypes.setRunning,\r\n  payload: running,\r\n});\r\n\r\nexport const setFirst = (): TickerAction => ({\r\n  type: actionTypes.setFirst,\r\n});\r\n\r\nexport const setLast = (): TickerAction => ({\r\n  type: actionTypes.setLast,\r\n});\r\n\r\nexport const inc = (value = 1): TickerAction => ({\r\n  type: actionTypes.inc,\r\n  payload: value,\r\n});\r\n\r\nexport const dec = (value = 1): TickerAction => ({\r\n  type: actionTypes.dec,\r\n  payload: value,\r\n});\r\n","import { TickerState, TickerAction } from './ticker.models';\r\nimport { actionTypes } from './ticker.actions';\r\n\r\nconst initialState: TickerState = {\r\n  isRunning: false,\r\n  currentDate: '',\r\n  isFirstDate: true,\r\n  isLastDate: false,\r\n  dates: [],\r\n};\r\n\r\nexport function tickerReducer(state = initialState, action: TickerAction): TickerState {\r\n  switch (action.type) {\r\n    case actionTypes.initialize: {\r\n      const dates = action.payload as string[];\r\n      return {\r\n        ...state,\r\n        isRunning: false,\r\n        currentDate: dates[0],\r\n        isFirstDate: true,\r\n        isLastDate: false,\r\n        dates,\r\n      };\r\n    }\r\n\r\n    case actionTypes.updateDate: {\r\n      const currentDate = action.payload as string;\r\n      if (state.dates.indexOf(currentDate) === -1) {\r\n        return { ...state };\r\n      }\r\n      return {\r\n        ...state,\r\n        currentDate,\r\n        isFirstDate: currentDate === state.dates[0],\r\n        isLastDate: currentDate === state.dates[state.dates.length - 1],\r\n      };\r\n    }\r\n\r\n    case actionTypes.setRunning: {\r\n      return {\r\n        ...state,\r\n        isRunning: action.payload as boolean,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setFirst: {\r\n      return {\r\n        ...state,\r\n        currentDate: state.dates[0],\r\n        isFirstDate: true,\r\n        isLastDate: false,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setLast: {\r\n      return {\r\n        ...state,\r\n        currentDate: state.dates[state.dates.length - 1],\r\n        isFirstDate: false,\r\n        isLastDate: true,\r\n      };\r\n    }\r\n\r\n    case actionTypes.inc: {\r\n      const currentIndex = state.dates.indexOf(state.currentDate);\r\n      const lastIndex = state.dates.length - 1;\r\n      const incValue = action.payload as number;\r\n      const newDate =\r\n        currentIndex + incValue > lastIndex\r\n          ? state.dates[lastIndex]\r\n          : state.dates[currentIndex + incValue];\r\n      return {\r\n        ...state,\r\n        currentDate: newDate,\r\n        isFirstDate: newDate === state.dates[0],\r\n        isLastDate: newDate === state.dates[lastIndex],\r\n      };\r\n    }\r\n\r\n    case actionTypes.dec: {\r\n      const currentIndex = state.dates.indexOf(state.currentDate);\r\n      const decValue = action.payload as number;\r\n      const newDate =\r\n        currentIndex - decValue < 0 ? state.dates[0] : state.dates[currentIndex - decValue];\r\n      return {\r\n        ...state,\r\n        currentDate: newDate,\r\n        isFirstDate: newDate === state.dates[0],\r\n        isLastDate: newDate === state.dates[state.dates.length - 1],\r\n      };\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import * as d3 from '../d3';\nimport { actions, Store } from '../store';\nimport { Ticker } from './ticker.models';\n\nexport function createTicker(store: Store): Ticker {\n  let ticker: d3.Timer;\n\n  function start() {\n    ticker = d3.interval(showRace, store.getState().options.tickDuration);\n    store.dispatch(actions.ticker.setRunning(true));\n\n    function showRace(_: number) {\n      if (store.getState().ticker.isLastDate) {\n        if (store.getState().options.loop) {\n          loop();\n        } else {\n          stop();\n        }\n      } else {\n        store.dispatch(actions.ticker.inc());\n      }\n    }\n  }\n\n  function stop() {\n    if (ticker) {\n      ticker.stop();\n    }\n    store.dispatch(actions.ticker.setRunning(false));\n  }\n\n  function skipBack() {\n    stop();\n    store.dispatch(actions.ticker.setFirst());\n  }\n\n  function loop() {\n    // const loopDelay = store.getState().options.loopDelay;\n    // if (loopDelay > 0) {\n    //   ticker.stop();\n    //   setTimeout(() => {\n    //     if (store.getState().ticker.isRunning) {\n    //       store.dispatch(actions.ticker.setFirst());\n    //       start();\n    //     }\n    //   }, loopDelay);\n    // } else {\n    store.dispatch(actions.ticker.setFirst());\n    // }\n  }\n\n  function skipForward() {\n    stop();\n    store.dispatch(actions.ticker.setLast());\n  }\n\n  function toggle() {\n    if (store.getState().ticker.isLastDate) {\n      skipBack();\n      start();\n    } else if (store.getState().ticker.isRunning) {\n      stop();\n    } else {\n      if (!store.getState().ticker.isFirstDate) {\n        // to avoid lastValue flicker\n        store.dispatch(actions.ticker.inc());\n      }\n      start();\n    }\n  }\n\n  function goToDate(date: string) {\n    store.dispatch(actions.ticker.updateDate(date));\n  }\n\n  return {\n    start,\n    stop,\n    skipBack,\n    loop,\n    skipForward,\n    toggle,\n    goToDate,\n  };\n}\n","import * as data from '../data';\nimport * as options from '../options';\nimport * as ticker from '../ticker';\n\nexport const actions = {\n  data,\n  options,\n  ticker,\n};\n","import { optionsReducer, OptionsAction } from '../options';\nimport { tickerReducer, TickerAction } from '../ticker';\nimport { dataReducer, DataAction } from '../data';\nimport { Action, State } from './models';\n\nexport function rootReducer(state: State, action: Action): State {\n  return {\n    data: dataReducer(state.data, action as DataAction),\n    options: optionsReducer(state.options, action as OptionsAction),\n    ticker: tickerReducer(state.ticker, action as TickerAction),\n  };\n}\n","import { Action, Reducer, State, Subscriber } from './models';\nimport { rootReducer } from './reducer';\n\nexport function createStore(reducer: Reducer = rootReducer, preloadedState?: State) {\n  let state = {} as State;\n\n  if (preloadedState) {\n    state = preloadedState;\n  }\n\n  function dispatch(action: Action) {\n    state = reducer(state, action);\n    notifySubscribers();\n    return action;\n  }\n\n  function getState() {\n    return state;\n  }\n\n  const subscribers: Subscriber[] = [];\n\n  function subscribe(fn: Subscriber) {\n    subscribers.push(fn);\n    const index = subscribers.length - 1;\n\n    return {\n      unsubscribe: () => {\n        subscribers.splice(index, 1);\n      },\n    };\n  }\n\n  function notifySubscribers() {\n    subscribers.forEach((fn: Subscriber) => {\n      fn();\n    });\n  }\n\n  return {\n    getState,\n    dispatch,\n    subscribe,\n  };\n}\n","import * as d3 from './d3';\n\nimport { getDateString, getDates } from './dates';\nimport { Data, WideData } from './data';\nimport { actions, Store } from './store';\nimport { Options } from './options';\n\nexport function prepareData(rawData: Data[], store: Store) {\n  const options = store.getState().options;\n\n  let data = rawData\n    .map((d) => ({ ...d, date: getDateString(d.date) }))\n    .filter((d) => (options.startDate ? d.date >= options.startDate : true))\n    .filter((d) => (options.endDate ? d.date <= options.endDate : true));\n\n  if (options.dataShape === 'wide') {\n    data = wideDataToLong(data);\n  }\n\n  data = data\n    .map((d) => {\n      const name = d.name ? d.name : '';\n      const value = isNaN(+d.value) ? 0 : +d.value;\n      return { ...d, name, value };\n    })\n    .sort((a, b) => a.date.localeCompare(b.date) || a.name.localeCompare(b.name));\n\n  if (options.fillDateGaps) {\n    data = fillGaps(data, options.fillDateGaps, options.fillDateGapsValue);\n  }\n\n  data = calculateLastValues(data);\n\n  storeDataCollections(data, store);\n\n  return data;\n}\n\nfunction storeDataCollections(data: Data[], store: Store) {\n  const names = Array.from(new Set(data.map((d) => d.name))).sort() as string[];\n  const groups = Array.from(new Set(data.map((d) => d.group)))\n    .filter(Boolean)\n    .sort() as string[];\n  const dates = getDates(data);\n\n  store.dispatch(actions.data.dataLoaded({ names, groups }));\n  store.dispatch(actions.ticker.initialize(dates));\n}\n\nfunction calculateLastValues(data: Data[]) {\n  return data\n    .sort((a, b) => a.name.localeCompare(b.name) || a.date.localeCompare(b.date))\n    .reduce((acc: Data[], curr) => {\n      if (acc.length === 0) {\n        curr.lastValue = curr.value;\n      } else {\n        const last = acc[acc.length - 1];\n        if (curr.name === last.name) {\n          curr.lastValue = last.value;\n        } else {\n          curr.lastValue = curr.value;\n        }\n      }\n      return [...acc, curr];\n    }, []);\n}\n\nfunction wideDataToLong(wide: WideData[], nested = false) {\n  const long = [] as Data[];\n  wide.forEach((row) => {\n    for (const [key, value] of Object.entries(row)) {\n      if (key === 'date') {\n        continue;\n      }\n\n      let item: any = {\n        date: row.date,\n        name: key,\n      };\n      if (nested) {\n        item = {\n          ...item,\n          ...value,\n        };\n      } else {\n        item = {\n          ...item,\n          value,\n        };\n      }\n      long.push(item);\n    }\n  });\n  return long;\n}\n\nfunction longDataToWide(long: Data[]) {\n  const wide = [] as any[];\n  long.forEach((item) => {\n    const dateRow = wide.filter((r) => r.date === item.date);\n    const row = dateRow.length > 0 ? dateRow[0] : {};\n    const { date, ...details } = item;\n    row[item.name] = details;\n    if (dateRow.length === 0) {\n      row.date = item.date;\n      wide.push(row);\n    }\n  });\n  return wide;\n}\n\nfunction fillGaps(\n  data: Data[],\n  period: Options['fillDateGaps'],\n  fillValue: Options['fillDateGapsValue'],\n) {\n  const intervalRange =\n    period === 'years'\n      ? d3.timeYear.range\n      : period === 'months'\n      ? d3.timeMonth.range\n      : period === 'days'\n      ? d3.timeDay.range\n      : null;\n\n  if (!intervalRange) {\n    return data;\n  }\n\n  const wideData = longDataToWide(data).map((d) => ({ ...d, date: new Date(d.date) }));\n\n  const allData = wideData\n    .reduce(\n      (acc: any[], row, i) => {\n        const lastDate = acc[acc.length - 1].date;\n        const range = intervalRange(lastDate, row.date);\n        const rangeStep = 1 / range.length;\n        if (i < wideData.length) {\n          const iData = d3.interpolate(wideData[i - 1], wideData[i]);\n          const newData: any[] = [];\n          range.forEach((_, j) => {\n            const values = fillValue === 'last' ? iData(0) : iData((j + 1) * rangeStep);\n            const newRow: any = { date: range[j] };\n            for (const [key, value] of Object.entries(values)) {\n              if (key !== 'date') {\n                newRow[key] = { ...(value as any) };\n              }\n            }\n            newData.push(getDateString(row.date) === getDateString(newRow.date) ? row : newRow);\n          });\n          return [...acc, ...newData];\n        } else {\n          return [...acc];\n        }\n      },\n      [wideData[0]],\n    )\n    .map((d) => ({ ...d, date: getDateString(d.date) }));\n\n  return wideDataToLong(allData, true);\n}\n\nexport function getDateSlice(data: Data[], date: string, groupFilter: string[]) {\n  const slice = data\n    .filter((d) => d.date === date && !isNaN(d.value))\n    .filter((d) => (!!d.group ? !groupFilter.includes(d.group) : true))\n    .sort((a, b) => b.value - a.value)\n    .map((d, i) => ({ ...d, rank: i }));\n\n  const emptyData = [{ name: '', value: 0, lastValue: 0, date, rank: 1 }];\n\n  return slice.length > 0 ? slice : emptyData;\n}\n","export const icons = {\r\n  skipBack: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M28.46,4a3,3,0,0,0-3,.07l-15.2,9.41A3,3,0,0,0,9,15V5A3,3,0,0,0,6,2H5A3,3,0,0,0,2,5V27a3,3,0,0,0,3,3H6a3,3,0,0,0,3-3V17a3,3,0,0,0,1.22,1.53L25.42,28a3,3,0,0,0,1.58.46,3,3,0,0,0,3-3V6.59A3,3,0,0,0,28.46,4Z\"/></g></svg>`,\r\n  play: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\r\n  pause: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns:svg=\"http://www.w3.org/2000/svg\"><g transform=\"translate(-17)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g><g transform=\"translate(-4)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g></svg>`,\r\n  skipForward: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M27,2H26a3,3,0,0,0-3,3V15a3,3,0,0,0-1.22-1.53L6.58,4A3,3,0,0,0,2,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,6.58,28l15.2-9.41A3,3,0,0,0,23,17V27a3,3,0,0,0,3,3h1a3,3,0,0,0,3-3V5A3,3,0,0,0,27,2Z\"/></g></svg>`,\r\n  overlayPlay: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\r\n  overlayRepeat: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M18,4A12,12,0,0,0,6.05,15H3a1,1,0,0,0-.88.53,1,1,0,0,0,0,1l4,6a1,1,0,0,0,1.66,0l4-6a1,1,0,0,0,.05-1A1,1,0,0,0,11,15H8.05A10,10,0,1,1,18,26a1,1,0,0,0,0,2A12,12,0,0,0,18,4Z\"/></g></svg>`,\r\n};\r\n","export const elements = {\r\n  controls: 'controls',\r\n  skipBack: 'skipBack',\r\n  play: 'play',\r\n  pause: 'pause',\r\n  skipForward: 'skipForward',\r\n  overlay: 'overlay',\r\n  overlayPlay: 'overlayPlay',\r\n  overlayRepeat: 'overlayRepeat',\r\n};\r\n","import * as d3 from './d3';\r\n\r\nimport { icons } from './icons';\r\nimport { elements } from './elements';\r\nimport { Renderer } from './models';\r\nimport { Data } from './data';\r\nimport { actions, Store } from './store';\r\nimport {\r\n  getHeight,\r\n  getWidth,\r\n  getElement,\r\n  hideElement,\r\n  showElement,\r\n  getText,\r\n  getColor,\r\n  getIconID,\r\n  safeName,\r\n  toggleClass,\r\n  getClicks,\r\n} from './utils';\r\nimport { getDateSlice } from './data-utils';\r\n\r\nexport function createRenderer(data: Data[], store: Store): Renderer {\r\n  let margin: { top: number; right: number; bottom: number; left: number };\r\n  let svg: any;\r\n  let x: d3.ScaleLinear<number, number>;\r\n  let y: d3.ScaleLinear<number, number>;\r\n  let xAxis: d3.Axis<number | { valueOf(): number }>;\r\n  const titlePadding = 5;\r\n  let barPadding: number;\r\n  let labelPadding: number;\r\n  let barWidth: (d: Data) => number;\r\n  let barHeight: number;\r\n  let barHalfHeight: number;\r\n  let defs: any;\r\n  let iconSize: number;\r\n  let iconSpace: number;\r\n  let titleText: any;\r\n  let subTitleText: any;\r\n  let captionText: any;\r\n  let dateCounterText: any;\r\n  let labelX: number | ((d: Data) => number);\r\n  let barY: (d: Data) => number;\r\n  let height: number;\r\n  let width: number;\r\n  let maxValue: number;\r\n\r\n  const groups = store.getState().data.groups;\r\n  const dates = store.getState().ticker.dates;\r\n  const { selector, showGroups, highlightBars, selectBars } = store.getState().options;\r\n  const root = document.querySelector(selector) as HTMLElement;\r\n\r\n  function renderInitalView() {\r\n    const {\r\n      title,\r\n      subTitle,\r\n      caption,\r\n      dateCounter,\r\n      labelsOnBars,\r\n      showIcons,\r\n      labelsWidth,\r\n      inputHeight,\r\n      inputWidth,\r\n      minHeight,\r\n      minWidth,\r\n      topN,\r\n      fixedScale,\r\n    } = store.getState().options;\r\n\r\n    const currentDate = store.getState().ticker.currentDate;\r\n    const TotalDateSlice = getDateSlice(data, currentDate, store.getState().data.groupFilter);\r\n    const dateSlice = TotalDateSlice.slice(0, store.getState().options.topN);\r\n    if (dateSlice.length === 0) {\r\n      return;\r\n    }\r\n\r\n    root.innerHTML = '';\r\n    height = getHeight(root, minHeight, inputHeight);\r\n    width = getWidth(root, minWidth, inputWidth);\r\n\r\n    renderInitialFrame();\r\n    renderControls();\r\n    renderOverlays();\r\n    updateControls();\r\n\r\n    function renderInitialFrame() {\r\n      const labelsArea = labelsOnBars ? 0 : labelsWidth;\r\n      const groupsArea = showGroups ? 40 : 0;\r\n\r\n      margin = {\r\n        top: 80 + groupsArea,\r\n        right: 0,\r\n        bottom: 5,\r\n        left: 0 + labelsArea,\r\n      };\r\n\r\n      svg = d3 //\r\n        .select(root)\r\n        .append('svg')\r\n        .attr('width', width)\r\n        .attr('height', height);\r\n\r\n      titleText = svg //\r\n        .append('text')\r\n        .attr('class', 'title')\r\n        .attr('x', titlePadding)\r\n        .attr('y', 24)\r\n        .html(getText(title, TotalDateSlice, dates, currentDate));\r\n\r\n      subTitleText = svg //\r\n        .append('text')\r\n        .attr('class', 'subTitle')\r\n        .attr('x', titlePadding)\r\n        .attr('y', 55)\r\n        .html(getText(subTitle, TotalDateSlice, dates, currentDate));\r\n\r\n      if (showGroups) {\r\n        const legendsWrapper = svg.append('g');\r\n        const legends = legendsWrapper\r\n          .selectAll('.legend-wrapper')\r\n          .data(groups)\r\n          .enter()\r\n          .append('g')\r\n          .attr('class', 'legend-wrapper')\r\n          .style('cursor', 'pointer')\r\n          .style('opacity', (d: string) =>\r\n            store.getState().data.groupFilter.includes(d) ? 0.3 : 1,\r\n          )\r\n          .on('click', legendClick);\r\n\r\n        legends\r\n          .append('rect')\r\n          .attr('class', 'legend-color')\r\n          .attr('width', 10)\r\n          .attr('height', 10)\r\n          .attr('y', 75)\r\n          .style('fill', (d: string) => getColor({ group: d } as Data, store));\r\n\r\n        legends\r\n          .append('text')\r\n          .attr('class', 'legend-text')\r\n          .attr('x', 20)\r\n          .attr('y', 75 + 10)\r\n          .html((d: string) => d);\r\n\r\n        let legendX = margin.left;\r\n        let legendY = 0;\r\n        legends.each(function () {\r\n          const wrapper = d3.select(this);\r\n          const text = wrapper.select('text') as any;\r\n          const bbox = text.node().getBBox();\r\n          if (legendX + bbox.width > width) {\r\n            legendX = margin.left;\r\n            legendY += 30;\r\n          }\r\n          wrapper.attr('transform', 'translate(' + legendX + ', ' + legendY + ')');\r\n          legendX += bbox.width + 40;\r\n        });\r\n\r\n        margin.top += legendY;\r\n      }\r\n\r\n      maxValue = fixedScale\r\n        ? data.map((d) => d.value).reduce((max, val) => (max > val ? max : val), 0)\r\n        : (d3.max(dateSlice, (d: Data) => d.value) as number);\r\n\r\n      x = d3\r\n        .scaleLinear()\r\n        .domain([0, maxValue])\r\n        .range([margin.left, width - margin.right - 65]);\r\n\r\n      y = d3\r\n        .scaleLinear()\r\n        .domain([topN, 0])\r\n        .range([height - margin.bottom, margin.top]);\r\n\r\n      barPadding = (height - (margin.bottom + margin.top)) / (topN * 5);\r\n      labelPadding = 8;\r\n      barWidth = (d: Data) => Math.abs(x(d.value) - x(0) - 1);\r\n      barHeight = y(1) - y(0) - barPadding;\r\n      barHalfHeight = (y(1) - y(0)) / 2 + 1;\r\n      barY = (d: Data) => y(d.rank as number) + 5;\r\n      iconSize = showIcons ? barHeight * 0.9 : 0;\r\n      iconSpace = showIcons ? iconSize + labelPadding : 0;\r\n      labelX = labelsOnBars\r\n        ? (d: Data) => x(d.value) - labelPadding - iconSpace\r\n        : margin.left - labelPadding;\r\n\r\n      xAxis = d3\r\n        .axisTop(x)\r\n        .ticks(width > 500 ? 5 : 2)\r\n        .tickSize(-(height - (margin.top + margin.bottom)))\r\n        .tickFormat((n: number | { valueOf(): number }) => d3.format(',')(n));\r\n\r\n      svg\r\n        .append('g')\r\n        .attr('class', 'axis xAxis')\r\n        .attr('transform', `translate(0, ${margin.top})`)\r\n        .call(xAxis)\r\n        .selectAll('.tick line')\r\n        .classed('origin', (d: number) => d === 0);\r\n\r\n      svg\r\n        .selectAll('rect.bar')\r\n        .data(dateSlice, (d: Data) => d.name)\r\n        .enter()\r\n        .append('rect')\r\n        .attr('class', (d: Data) => 'bar ' + safeName(d.name))\r\n        .classed('selected', (d: Data) => store.getState().data.selected.includes(d.name))\r\n        .attr('x', x(0) + 1)\r\n        .attr('width', barWidth)\r\n        .attr('y', barY)\r\n        .attr('height', barHeight)\r\n        .style('fill', (d: Data) => getColor(d, store))\r\n        .on('click', selectFn)\r\n        .on('mouseover', highlightFn)\r\n        .on('mouseout', highlightFn);\r\n\r\n      svg\r\n        .selectAll('text.label')\r\n        .data(dateSlice, (d: Data) => d.name)\r\n        .enter()\r\n        .append('text')\r\n        .attr('class', 'label')\r\n        .attr('x', labelX)\r\n        .attr('y', (d: Data) => barY(d) + barHalfHeight)\r\n        .style('text-anchor', 'end')\r\n        .html((d: Data) => d.name)\r\n        .on('click', selectFn)\r\n        .on('mouseover', highlightFn)\r\n        .on('mouseout', highlightFn);\r\n\r\n      svg\r\n        .selectAll('text.valueLabel')\r\n        .data(dateSlice, (d: Data) => d.name)\r\n        .enter()\r\n        .append('text')\r\n        .attr('class', 'valueLabel')\r\n        .attr('x', (d: Data) => x(d.value) + 5)\r\n        .attr('y', (d: Data) => barY(d) + barHalfHeight)\r\n        .text((d: Data) => d3.format(',.0f')(d.lastValue as number));\r\n\r\n      if (showIcons) {\r\n        defs = svg.append('svg:defs');\r\n\r\n        defs\r\n          .selectAll('svg')\r\n          .data(dateSlice, (d: Data) => d.name)\r\n          .enter()\r\n          .append('svg:pattern')\r\n          .attr('class', 'svgpattern')\r\n          .attr('id', getIconID)\r\n          .attr('width', iconSize)\r\n          .attr('height', iconSize)\r\n          .append('svg:image')\r\n          .attr('xlink:href', (d: Data) => d.icon)\r\n          .attr('width', iconSize)\r\n          .attr('height', iconSize)\r\n          .attr('x', 0)\r\n          .attr('y', 0);\r\n\r\n        svg\r\n          .selectAll('circle')\r\n          .data(dateSlice, (d: Data) => d.name)\r\n          .enter()\r\n          .append('circle')\r\n          .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n          .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight)\r\n          .attr('r', iconSize / 2)\r\n          .style('fill', 'transparent')\r\n          .style('fill', (d: Data) => `url(#${getIconID(d)})`);\r\n      }\r\n\r\n      dateCounterText = svg\r\n        .append('text')\r\n        .attr('class', 'dateCounterText')\r\n        .attr('x', width - margin.right - barPadding)\r\n        .attr('y', height - 40)\r\n        .style('text-anchor', 'end')\r\n        .html(getText(dateCounter, TotalDateSlice, dates, currentDate, true))\r\n        .call(halo);\r\n\r\n      captionText = svg\r\n        .append('text')\r\n        .attr('class', 'caption')\r\n        .attr('x', width - margin.right - barPadding - 10)\r\n        .attr('y', height - margin.bottom - barPadding)\r\n        .style('text-anchor', 'end')\r\n        .html(getText(caption, TotalDateSlice, dates, currentDate));\r\n    }\r\n\r\n    function renderControls() {\r\n      const controlIcons = [\r\n        { skipBack: icons.skipBack },\r\n        { play: icons.play },\r\n        { pause: icons.pause },\r\n        { skipForward: icons.skipForward },\r\n      ];\r\n\r\n      const elementWidth = root.getBoundingClientRect().width;\r\n\r\n      d3.select(root)\r\n        .append('div')\r\n        .classed('controls', true)\r\n        .style('width', width)\r\n        .style('right', elementWidth - width + margin.right + barPadding + 'px')\r\n        .selectAll('div')\r\n        .data(controlIcons)\r\n        .enter()\r\n        .append('div')\r\n        .html((d) => Object.values(d)[0] as string)\r\n        .attr('class', (d) => Object.keys(d)[0]);\r\n\r\n      if (store.getState().options.showControls === 'play') {\r\n        hideElement(root, elements.skipBack);\r\n        hideElement(root, elements.skipForward);\r\n      }\r\n      if (store.getState().options.showControls === 'none') {\r\n        hideElement(root, elements.controls);\r\n      }\r\n    }\r\n\r\n    function renderOverlays() {\r\n      const overlayIcons = [\r\n        { overlayPlay: icons.overlayPlay },\r\n        { overlayRepeat: icons.overlayRepeat },\r\n      ];\r\n\r\n      d3.select(root)\r\n        .append('div')\r\n        .classed('overlay', true)\r\n        .style('minHeight', minHeight + 'px')\r\n        .style('minWidth', minWidth + 'px')\r\n        .selectAll('div')\r\n        .data(overlayIcons)\r\n        .enter()\r\n        .append('div')\r\n        .html((d) => Object.values(d)[0] as string)\r\n        .attr('class', (d) => Object.keys(d)[0]);\r\n    }\r\n  }\r\n\r\n  function renderFrame() {\r\n    if (!x) {\r\n      return;\r\n    }\r\n\r\n    const {\r\n      tickDuration,\r\n      topN,\r\n      title,\r\n      subTitle,\r\n      caption,\r\n      dateCounter,\r\n      fixedScale,\r\n    } = store.getState().options;\r\n    const currentDate = store.getState().ticker.currentDate;\r\n    const CompleteDateSlice = getDateSlice(data, currentDate, store.getState().data.groupFilter);\r\n    const dateSlice = CompleteDateSlice.slice(0, store.getState().options.topN);\r\n\r\n    if (showGroups) {\r\n      svg\r\n        .selectAll('.legend-wrapper')\r\n        .style('opacity', (d: string) => (store.getState().data.groupFilter.includes(d) ? 0.3 : 1));\r\n    }\r\n\r\n    if (!fixedScale) {\r\n      x.domain([0, d3.max(dateSlice, (d: Data) => d.value) as number]);\r\n\r\n      svg //\r\n        .select('.xAxis')\r\n        .transition()\r\n        .duration(tickDuration)\r\n        .ease(d3.easeLinear)\r\n        .call(xAxis);\r\n    }\r\n\r\n    const bars = svg //\r\n      .selectAll('.bar')\r\n      .data(dateSlice, (d: Data) => d.name);\r\n\r\n    bars\r\n      .enter()\r\n      .append('rect')\r\n      .attr('class', (d: Data) => 'bar ' + safeName(d.name))\r\n      .classed('selected', (d: Data) => store.getState().data.selected.includes(d.name))\r\n      .attr('x', x(0) + 1)\r\n      .attr('width', barWidth)\r\n      .attr('y', () => y(topN + 1) + 5)\r\n      .attr('height', barHeight)\r\n      .style('fill', (d: Data) => getColor(d, store))\r\n      .on('click', selectFn)\r\n      .on('mouseover', highlightFn)\r\n      .on('mouseout', highlightFn)\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('y', barY);\r\n\r\n    bars\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\r\n      .attr('y', barY);\r\n\r\n    bars\r\n      .exit()\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\r\n      .attr('y', () => y(topN + 1) + 5)\r\n      .remove();\r\n\r\n    const labels = svg //\r\n      .selectAll('.label')\r\n      .data(dateSlice, (d: Data) => d.name);\r\n\r\n    labels\r\n      .enter()\r\n      .append('text')\r\n      .attr('class', 'label')\r\n      .attr('x', labelX)\r\n      .attr('y', () => y(topN + 1) + 5 + barHalfHeight)\r\n      .style('text-anchor', 'end')\r\n      .html((d: Data) => d.name)\r\n      .on('click', selectFn)\r\n      .on('mouseover', highlightFn)\r\n      .on('mouseout', highlightFn)\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('y', (d: Data) => barY(d) + barHalfHeight);\r\n\r\n    labels\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('x', labelX)\r\n      .attr('y', (d: Data) => barY(d) + barHalfHeight);\r\n\r\n    labels\r\n      .exit()\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('x', labelX)\r\n      .attr('y', () => y(topN + 1) + 5)\r\n      .remove();\r\n\r\n    const valueLabels = svg //\r\n      .selectAll('.valueLabel')\r\n      .data(dateSlice, (d: Data) => d.name);\r\n\r\n    valueLabels\r\n      .enter()\r\n      .append('text')\r\n      .attr('class', 'valueLabel')\r\n      .attr('x', (d: Data) => x(d.value) + 5)\r\n      .attr('y', () => y(topN + 1) + 5)\r\n      .text((d: Data) => d3.format(',.0f')(d.lastValue as number))\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('y', (d: Data) => barY(d) + barHalfHeight);\r\n\r\n    valueLabels\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('x', (d: Data) => x(d.value) + 5)\r\n      .attr('y', (d: Data) => barY(d) + barHalfHeight)\r\n      .tween('text', function (d: Data) {\r\n        const i = d3.interpolateRound(d.lastValue as number, d.value);\r\n        return function (t: number) {\r\n          this.textContent = d3.format(',')(i(t));\r\n        };\r\n      });\r\n\r\n    valueLabels\r\n      .exit()\r\n      .transition()\r\n      .duration(tickDuration)\r\n      .ease(d3.easeLinear)\r\n      .attr('x', (d: Data) => x(d.value) + 5)\r\n      .attr('y', () => y(topN + 1) + 5)\r\n      .remove();\r\n\r\n    if (store.getState().options.showIcons) {\r\n      const iconPatterns = defs.selectAll('.svgpattern').data(dateSlice, (d: Data) => d.name);\r\n\r\n      iconPatterns\r\n        .enter()\r\n        .append('svg:pattern')\r\n        .attr('class', 'svgpattern')\r\n        .attr('id', getIconID)\r\n        .attr('width', iconSize)\r\n        .attr('height', iconSize)\r\n        .append('svg:image')\r\n        .attr('xlink:href', (d: Data) => d.icon)\r\n        .attr('width', iconSize)\r\n        .attr('height', iconSize)\r\n        .style('z-index', '99')\r\n        .attr('x', 0)\r\n        .attr('y', 0);\r\n\r\n      iconPatterns.exit().remove();\r\n\r\n      const icons = svg //\r\n        .selectAll('circle')\r\n        .data(dateSlice, (d: Data) => d.name);\r\n\r\n      icons\r\n        .enter()\r\n        .append('circle')\r\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n        .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\r\n        .attr('r', iconSize / 2)\r\n        .style('z-index', '99')\r\n        .style('fill', 'transparent')\r\n        .style('fill', (d: Data) => `url(#${getIconID(d)})`)\r\n        .transition()\r\n        .duration(tickDuration)\r\n        .ease(d3.easeLinear)\r\n        .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\r\n\r\n      icons\r\n        .transition()\r\n        .duration(tickDuration)\r\n        .ease(d3.easeLinear)\r\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n        .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\r\n\r\n      icons\r\n        .exit()\r\n        .transition()\r\n        .duration(tickDuration)\r\n        .ease(d3.easeLinear)\r\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\r\n        .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\r\n        .remove();\r\n    }\r\n\r\n    titleText.html(getText(title, CompleteDateSlice, dates, currentDate));\r\n    subTitleText.html(getText(subTitle, CompleteDateSlice, dates, currentDate));\r\n    captionText.html(getText(caption, CompleteDateSlice, dates, currentDate));\r\n    dateCounterText\r\n      .html(getText(dateCounter, CompleteDateSlice, dates, currentDate, true))\r\n      .call(halo);\r\n    updateControls();\r\n  }\r\n\r\n  function resize() {\r\n    if (\r\n      (!store.getState().options.inputHeight && !store.getState().options.inputWidth) ||\r\n      String(store.getState().options.inputHeight).startsWith('window') ||\r\n      String(store.getState().options.inputWidth).startsWith('window')\r\n    ) {\r\n      height = getHeight(\r\n        root,\r\n        store.getState().options.minHeight,\r\n        store.getState().options.inputHeight,\r\n      );\r\n      width = getWidth(\r\n        root,\r\n        store.getState().options.minWidth,\r\n        store.getState().options.inputWidth,\r\n      );\r\n\r\n      const currentPosition = root.style.position; // \"fixed\" if scrolling\r\n      renderInitalView();\r\n      renderFrame();\r\n      updateControls();\r\n      root.style.position = currentPosition;\r\n    }\r\n  }\r\n\r\n  function updateControls() {\r\n    const showOverlays = store.getState().options.showOverlays;\r\n\r\n    if (store.getState().ticker.isRunning) {\r\n      showElement(root, elements.pause);\r\n      hideElement(root, elements.play);\r\n    } else {\r\n      showElement(root, elements.play);\r\n      hideElement(root, elements.pause);\r\n    }\r\n\r\n    if (\r\n      store.getState().ticker.isFirstDate &&\r\n      (showOverlays === 'all' || showOverlays === 'play') &&\r\n      !store.getState().ticker.isRunning\r\n    ) {\r\n      getElement(root, elements.controls).style.visibility = 'hidden';\r\n      showElement(root, elements.overlay);\r\n      showElement(root, elements.overlayPlay);\r\n      hideElement(root, elements.overlayRepeat);\r\n    } else if (\r\n      store.getState().ticker.isLastDate &&\r\n      (showOverlays === 'all' || showOverlays === 'repeat') &&\r\n      !(store.getState().options.loop && store.getState().ticker.isRunning)\r\n    ) {\r\n      getElement(root, elements.controls).style.visibility = 'hidden';\r\n      showElement(root, elements.overlay);\r\n      showElement(root, elements.overlayRepeat);\r\n      hideElement(root, elements.overlayPlay);\r\n    } else {\r\n      getElement(root, elements.controls).style.visibility = 'unset';\r\n      getElement(root, elements.overlay).style.display = 'none';\r\n    }\r\n  }\r\n\r\n  function halo(text: any) {\r\n    svg //\r\n      .selectAll('.halo')\r\n      .remove();\r\n\r\n    text\r\n      .select(function () {\r\n        return this.parentNode.insertBefore(this.cloneNode(true), this);\r\n      })\r\n      .classed('halo', true);\r\n  }\r\n\r\n  function legendClick(d: string) {\r\n    getClicks(d3.event, function (event: any) {\r\n      const clicks = event.detail;\r\n      if (clicks === 3) {\r\n        store.dispatch(actions.data.resetFilters());\r\n      } else if (clicks === 2) {\r\n        store.dispatch(actions.data.allExceptFilter(d));\r\n      } else {\r\n        store.dispatch(actions.data.toggleFilter(d));\r\n      }\r\n    });\r\n  }\r\n\r\n  function highlightFn(d: any) {\r\n    if (highlightBars) {\r\n      toggleClass(root, 'rect.' + safeName(d.name), 'highlight');\r\n    }\r\n  }\r\n\r\n  function selectFn(d: Data) {\r\n    if (selectBars) {\r\n      toggleClass(root, 'rect.' + safeName(d.name), 'selected');\r\n      store.dispatch(actions.data.toggleSelection(d.name));\r\n    }\r\n  }\r\n\r\n  return {\r\n    renderInitalView,\r\n    renderFrame,\r\n    resize,\r\n  };\r\n}\r\n","// This file is auto-generated and will be over-written!\n// Please do NOT edit this file directly\n// You may edit files in this folder instead: src\\lib\\css\n\nexport const styles = `\n__selector__ text {\n  font-size: 16px;\n  font-family: Open Sans, sans-serif;\n}\n\n__selector__ text.title {\n  font-size: 24px;\n  font-weight: 500;\n}\n\n__selector__ text.subTitle {\n  font-weight: 500;\n}\n\n__selector__ text.caption {\n  font-weight: 400;\n  font-size: 24px;\n}\n__selector__ text.legend-text {\n  user-select: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n}\n__selector__ text.label {\n  font-weight: 600;\n}\n\n__selector__ text.valueLabel {\n  font-weight: 300;\n}\n\n__selector__ text.dateCounterText {\n  font-size: 64px;\n  font-weight: 700;\n}\n\n__selector__ .xAxis .tick:nth-child(2) text {\n  text-anchor: start;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n}\n\n__selector__ path.domain {\n  display: none;\n}\n\n__selector__ {\n  position: relative;\n}\n\n__selector__ .controls {\n  /*  width and right are set dynamically in renderer.ts */\n  position: absolute;\n  top: 0;\n  display: flex;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  cursor: pointer;\n  font-size: 24px;\n  font-weight: 700;\n  width: 38px;\n  height: 38px;\n  -moz-border-radius: 5px;\n  -webkit-border-radius: 5px;\n  border-radius: 5px;\n  margin: 5px;\n  text-align: center;\n}\n\n__selector__ .controls svg {\n  margin: 5px auto;\n  width: 28px;\n  height: 28px;\n}\n\n__selector__ .overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n__selector__ .overlay div {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 200px;\n  height: 200px;\n  -moz-border-radius: 100px;\n  -webkit-border-radius: 100px;\n  border-radius: 100px;\n}\n__selector__ .overlay svg {\n  height: 50%;\n  width: 50%;\n}\n`;\n\nexport const themes = {\n\"dark\": `\n__selector__ {\n  background-color: #313639;\n}\n\n__selector__ text.title {\n  fill: #fafafa;\n}\n\n__selector__ text.subTitle {\n  fill: #cccccc;\n}\n\n__selector__ text.dateCounterText {\n  fill: #cccccc;\n  opacity: 1;\n}\n\n__selector__ text.caption {\n  fill: #cccccc;\n}\n\n__selector__ .halo {\n  fill: #313639;\n  stroke: #313639;\n  stroke-width: 10;\n  stroke-linejoin: round;\n  opacity: 1;\n}\n\n__selector__ text.legend-text {\n  fill: #fafafa;\n}\n\n__selector__ text.label {\n  fill: #313639;\n}\n\n__selector__ text.valueLabel {\n  fill: #fafafa;\n}\n\n__selector__ .tick text {\n  fill: #cccccc;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n  stroke: #dddddd;\n}\n\n__selector__ .tick line.origin {\n  stroke: #aaaaaa;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  color: #ffffff;\n  background: #777777;\n  border: 1px solid black;\n  opacity: 0.5;\n}\n\n__selector__ .controls div:hover,\n__selector__ .overlay div:hover {\n  background: #aaaaaa;\n  color: black;\n}\n\n__selector__ .overlay {\n  background-color: black;\n  opacity: 0.7;\n}\n\n__selector__ .highlight {\n  fill: rgb(255, 39, 39) !important;\n}\n\n__selector__ .selected {\n  fill: rgb(209, 32, 32) !important;\n  stroke: #777777 !important;\n  stroke-width: 1 !important;\n}\n`,\n\"light\": `\n/* __selector__ {\n  background-color: #ffffff;\n}\n\n__selector__ text.title {\n  fill: #fafafa;\n} */\n\n__selector__ text.subTitle {\n  fill: #777777;\n}\n\n__selector__ text.dateCounterText {\n  fill: #bbbbbb;\n  opacity: 1;\n}\n\n__selector__ text.caption {\n  fill: #777777;\n}\n\n__selector__ .halo {\n  fill: #ffffff;\n  stroke: #ffffff;\n  stroke-width: 10;\n  stroke-linejoin: round;\n  opacity: 1;\n}\n\n__selector__ text.legend-text {\n  fill: #000000;\n}\n\n__selector__ text.label {\n  fill: #000000;\n}\n\n__selector__ text.valueLabel {\n  fill: #000000;\n}\n\n__selector__ .tick text {\n  fill: #777777;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n  stroke: #dddddd;\n}\n\n__selector__ .tick line.origin {\n  stroke: #aaaaaa;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  color: #ffffff;\n  background: #777777;\n  border: 1px solid black;\n  opacity: 0.5;\n}\n\n__selector__ .controls div:hover,\n__selector__ .overlay div:hover {\n  background: #aaaaaa;\n  color: black;\n}\n\n__selector__ .overlay {\n  background-color: black;\n  opacity: 0.7;\n}\n\n__selector__ .highlight {\n  fill: rgb(255, 39, 39) !important;\n}\n\n__selector__ .selected {\n  fill: rgb(209, 37, 37) !important;\n  stroke: #777777 !important;\n  stroke-width: 1 !important;\n}\n`,\n};\n","import { styles, themes } from './generated-styles';\r\n\r\n// modifed from https://github.com/egoist/style-inject\r\nexport function styleInject(selector: string, theme: string, insertAt = 'top') {\r\n  let css = styles + (themes as any)[theme];\r\n\r\n  if (!css || typeof document === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  // replace with selector\r\n  css = css.split('__selector__').join(selector);\r\n\r\n  const head = document.head || document.getElementsByTagName('head')[0];\r\n  const style = document.createElement('style') as HTMLStyleElement | any;\r\n  style.type = 'text/css';\r\n\r\n  if (insertAt === 'top') {\r\n    if (head.firstChild) {\r\n      head.insertBefore(style, head.firstChild);\r\n    } else {\r\n      head.appendChild(style);\r\n    }\r\n  } else {\r\n    head.appendChild(style);\r\n  }\r\n\r\n  if (style.styleSheet) {\r\n    style.styleSheet.cssText = css;\r\n  } else {\r\n    style.appendChild(document.createTextNode(css));\r\n  }\r\n}\r\n","import { elements } from './elements';\nimport { Store } from './store';\nimport { Ticker } from './ticker';\nimport { addEventHandler, hideElement } from './utils';\nimport { DOMCustomEvent } from './models';\n\nexport function registerEvents(store: Store, ticker: Ticker) {\n  const root = document.querySelector(store.getState().options.selector) as HTMLElement;\n\n  registerControlButtonEvents();\n  registerOverlayEvents();\n  registerClickEvents();\n  registerKeyboardEvents();\n\n  function registerControlButtonEvents() {\n    addEventHandler(root, elements.skipBack, 'click', ticker.skipBack);\n    addEventHandler(root, elements.play, 'click', ticker.start);\n    addEventHandler(root, elements.pause, 'click', ticker.stop);\n    addEventHandler(root, elements.skipForward, 'click', ticker.skipForward);\n  }\n\n  function registerOverlayEvents() {\n    addEventHandler(root, elements.overlayPlay, 'click', () => {\n      hideElement(root, elements.overlay);\n      ticker.start();\n    });\n    addEventHandler(root, elements.overlayRepeat, 'click', () => {\n      hideElement(root, elements.overlay);\n      ticker.loop();\n      ticker.start();\n    });\n  }\n\n  function registerClickEvents() {\n    if (!store.getState().options.disableClickEvents) {\n      const svg = root.querySelector('svg') as SVGSVGElement;\n      svg.addEventListener('click', ticker.toggle);\n      root.addEventListener('dblclick', ticker.skipForward);\n    }\n  }\n\n  function registerKeyboardEvents() {\n    if (!store.getState().options.disableKeyboardEvents) {\n      document.addEventListener('keypress', function (e) {\n        const keyCodes = {\n          spacebar: 32,\n          a: 97,\n          d: 100,\n          s: 115,\n        };\n\n        // TODO: keyCode is deprecated\n        switch (e.keyCode) {\n          case keyCodes.spacebar:\n            ticker.toggle();\n            break;\n          case keyCodes.a:\n            ticker.skipBack();\n            break;\n          case keyCodes.s:\n            ticker.toggle();\n            break;\n          case keyCodes.d:\n            ticker.skipForward();\n            break;\n        }\n      });\n    }\n  }\n}\n\nfunction dispatchDOMEvent(store: Store) {\n  const element = document.querySelector(store.getState().options.selector) as HTMLElement;\n  element.dispatchEvent(\n    new CustomEvent('racingBars/dateChanged', {\n      bubbles: true,\n      detail: {\n        date: store.getState().ticker.currentDate,\n        isFirst: store.getState().ticker.isFirstDate,\n        isLast: store.getState().ticker.isLastDate,\n      },\n    } as DOMCustomEvent),\n  );\n}\n\nexport function DOMEventSubscriber(store: Store) {\n  let lastDate = '';\n  return function () {\n    const currentDate = store.getState().ticker.currentDate;\n    if (currentDate !== lastDate) {\n      dispatchDOMEvent(store);\n      lastDate = currentDate;\n    }\n  };\n}\n","import { actions, Store } from './store';\r\n\r\nexport function createScroller(element: HTMLElement, store: Store) {\r\n  const dates = store.getState().ticker.dates;\r\n  prepareDOM();\r\n\r\n  const step = document.body.clientHeight / dates.length;\r\n\r\n  subscribeToEvents();\r\n\r\n  function prepareDOM() {\r\n    element.style.position = 'fixed';\r\n    element.style.top = '0';\r\n\r\n    const scrollElement = document.createElement('div');\r\n    scrollElement.style.height = window.innerHeight * 10 + 'px';\r\n    document.body.appendChild(scrollElement);\r\n  }\r\n\r\n  function subscribeToEvents() {\r\n    window.addEventListener('scroll', goToDate);\r\n    // element.addEventListener(\"dateChanged\", scrollToPosition);\r\n  }\r\n\r\n  // function scrollToPosition(e: CustomEvent) {\r\n  //   let currentDate = getDateString(e.detail.date);\r\n  //   let index = dates.indexOf(currentDate);\r\n  //   ignoreNextScrollEvent = true;\r\n  //   window.scroll({\r\n  //     top: index * step,\r\n  //     behavior: \"smooth\",\r\n  //   });\r\n  // }\r\n\r\n  function goToDate() {\r\n    const index = Math.ceil(window.pageYOffset / step);\r\n    if (index < dates.length) {\r\n      store.dispatch(actions.ticker.updateDate(dates[index]));\r\n    } else {\r\n      store.dispatch(actions.ticker.setLast());\r\n    }\r\n  }\r\n}\r\n","import * as d3 from './d3';\nimport { prepareData } from './data-utils';\nimport { getDateString } from './dates';\nimport { Data, WideData } from './data';\nimport { createRenderer } from './renderer';\nimport { createTicker } from './ticker';\nimport { styleInject } from './styles';\nimport { actions, createStore, rootReducer } from './store';\nimport { Options, RequiredOptions } from './options';\nimport { registerEvents, DOMEventSubscriber } from './events';\nimport { createScroller } from './scroller';\nimport { safeName } from './utils';\n\nexport function race(data: Data[] | WideData[], options: Options | RequiredOptions) {\n  const store = createStore(rootReducer);\n\n  store.dispatch(actions.options.optionsLoaded(options));\n  const { selector, injectStyles, theme, autorun } = store.getState().options;\n\n  const root = document.querySelector(selector) as HTMLElement;\n  if (!root) {\n    throw new Error('Cannot find element with this selector: ' + selector);\n  }\n\n  if (injectStyles) {\n    styleInject(selector, theme, 'top');\n  }\n\n  const preparedData = prepareData(data as Data[], store);\n\n  const ticker = createTicker(store);\n\n  const renderer = createRenderer(preparedData, store);\n  renderer.renderInitalView();\n\n  store.subscribe(renderer.renderFrame);\n  store.subscribe(DOMEventSubscriber(store));\n\n  ticker.start();\n\n  if (!autorun) {\n    ticker.stop();\n  }\n\n  registerEvents(store, ticker);\n  window.addEventListener('resize', resize);\n\n  function resize() {\n    renderer.resize();\n    registerEvents(store, ticker);\n  }\n\n  return {\n    // TODO: validate user input\n    start: () => {\n      if (!store.getState().ticker.isRunning) {\n        ticker.start();\n      }\n    },\n    stop: () => {\n      ticker.stop();\n    },\n    rewind: () => {\n      ticker.skipBack();\n    },\n    fastforward: () => {\n      ticker.skipForward();\n    },\n    loop: () => {\n      ticker.loop();\n    },\n    inc: (value = 1) => {\n      store.dispatch(actions.ticker.inc(value));\n    },\n    dec: (value = 1) => {\n      store.dispatch(actions.ticker.dec(value));\n    },\n    getDate: () => store.getState().ticker.currentDate,\n    setDate: (inputDate: string | Date) => {\n      store.dispatch(actions.ticker.updateDate(getDateString(inputDate)));\n    },\n    getAllDates: () => [...store.getState().ticker.dates],\n    createScroller: () => {\n      createScroller(root, store);\n    },\n    selections: {\n      select: (name: string) => {\n        d3.select(root)\n          .select('rect.' + safeName(name))\n          .classed('selected', true);\n        store.dispatch(actions.data.addSelection(name));\n      },\n      unselect: (name: string) => {\n        d3.select(root)\n          .select('rect.' + safeName(name))\n          .classed('selected', false);\n        store.dispatch(actions.data.removeSelection(name));\n      },\n      unselectAll: () => {\n        d3.select(root).selectAll('rect').classed('selected', false);\n        store.dispatch(actions.data.resetSelections());\n      },\n    },\n    groups: {\n      hide: (group: string) => {\n        store.dispatch(actions.data.addFilter(group));\n      },\n      show: (group: string) => {\n        store.dispatch(actions.data.removeFilter(group));\n      },\n      showOnly: (group: string) => {\n        store.dispatch(actions.data.allExceptFilter(group));\n      },\n      showAll: () => {\n        store.dispatch(actions.data.resetFilters());\n      },\n    },\n  };\n}\n"],"names":["loadData","URL","type","d3","Error","getColor","d","store","getState","data","names","groups","options","showGroups","colorSeed","colorMap","color","useGroup","Boolean","group","length","values","shuffle","toNumber","currentValue","name","index","indexOf","Array","isArray","negativeIfOdd","lumVariation","random","HueSpacing","hue","getIconID","safeName","zeroPad","n","w","toString","s","String","nums","i","charCodeAt","InputSeed","seed","x","Math","sin","floor","randomString","prefix","rnd","fill","map","substr","join","slice","arr","array","m","t","generateId","getHeight","element","minHeight","height","newHeight","getBoundingClientRect","startsWith","scale","split","window","innerHeight","getWidth","minWidth","width","newWidth","innerWidth","getElement","root","className","querySelector","showElement","style","display","hideElement","addEventHandler","event","handler","addEventListener","getText","param","dateSlice","dates","currentDate","isDate","formatDate","replace","toggleClass","selector","select","classed","debounce","func","wait","immediate","timeout","_clicks","_Fn","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","getClicks","Fn","getDates","from","Set","date","sort","getDateString","inputDate","Date","isNaN","year","getFullYear","month","getMonth","day","getDate","dateStr","format","weekDayIndex","getDay","monthNames","weekDays","actionTypes","dataLoaded","addFilter","removeFilter","toggleFilter","resetFilters","allExceptFilter","addSelection","removeSelection","toggleSelection","resetSelections","dataCollections","payload","selection","initialState","groupFilter","selected","dataReducer","state","action","collections","addToArray","removeFromArray","toggleItem","item","includes","push","filter","optionsLoaded","changeOptions","optionsChanged","dataShape","fillDateGaps","fillDateGapsValue","startDate","endDate","tickDuration","topN","disableClickEvents","disableKeyboardEvents","autorun","loop","injectStyles","title","subTitle","caption","dateCounter","labelsOnBars","labelsWidth","showIcons","showControls","showOverlays","inputHeight","inputWidth","theme","fixedScale","highlightBars","selectBars","optionsReducer","initialize","updateDate","setRunning","setFirst","setLast","inc","dec","running","value","isRunning","isFirstDate","isLastDate","tickerReducer","currentIndex","lastIndex","incValue","newDate","decValue","createTicker","ticker","start","showRace","dispatch","actions","_","stop","skipBack","skipForward","toggle","goToDate","rootReducer","createStore","reducer","preloadedState","notifySubscribers","subscribers","subscribe","fn","unsubscribe","splice","forEach","prepareData","rawData","wideDataToLong","a","b","localeCompare","fillGaps","calculateLastValues","storeDataCollections","reduce","acc","curr","lastValue","last","wide","nested","long","row","Object","entries","key","longDataToWide","dateRow","r","details","period","fillValue","intervalRange","range","wideData","allData","lastDate","rangeStep","iData","newData","j","newRow","getDateSlice","rank","emptyData","icons","play","pause","overlayPlay","overlayRepeat","elements","controls","overlay","createRenderer","margin","svg","y","xAxis","titlePadding","barPadding","labelPadding","barWidth","barHeight","barHalfHeight","defs","iconSize","iconSpace","titleText","subTitleText","captionText","dateCounterText","labelX","barY","maxValue","document","renderInitalView","TotalDateSlice","innerHTML","renderInitialFrame","renderControls","renderOverlays","updateControls","labelsArea","groupsArea","top","right","bottom","left","append","attr","html","legendsWrapper","legends","selectAll","enter","on","legendClick","legendX","legendY","each","wrapper","text","bbox","node","getBBox","max","val","domain","abs","ticks","tickSize","tickFormat","call","selectFn","highlightFn","icon","halo","controlIcons","elementWidth","keys","overlayIcons","renderFrame","CompleteDateSlice","transition","duration","ease","bars","exit","remove","labels","valueLabels","tween","textContent","iconPatterns","resize","currentPosition","position","visibility","parentNode","insertBefore","cloneNode","clicks","detail","styles","themes","styleInject","insertAt","css","head","getElementsByTagName","createElement","firstChild","appendChild","styleSheet","cssText","createTextNode","registerEvents","registerControlButtonEvents","registerOverlayEvents","registerClickEvents","registerKeyboardEvents","e","keyCodes","spacebar","keyCode","dispatchDOMEvent","dispatchEvent","CustomEvent","bubbles","isFirst","isLast","DOMEventSubscriber","createScroller","prepareDOM","step","body","clientHeight","subscribeToEvents","scrollElement","ceil","pageYOffset","race","preparedData","renderer","rewind","fastforward","setDate","getAllDates","selections","unselect","unselectAll","hide","show","showOnly","showAll"],"mappings":"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"}