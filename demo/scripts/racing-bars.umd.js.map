{"version":3,"file":"racing-bars.umd.js","sources":["../../src/lib/load-data.ts","../../src/lib/utils.ts","../../src/lib/dates.ts","../../src/lib/data/data.actions.ts","../../src/lib/data/data.reducer.ts","../../src/lib/options/options.actions.ts","../../src/lib/options/options.reducer.ts","../../src/lib/ticker/ticker.actions.ts","../../src/lib/ticker/ticker.reducer.ts","../../src/lib/ticker/ticker.ts","../../src/lib/store/actions.ts","../../src/lib/store/reducer.ts","../../src/lib/store/store.ts","../../src/lib/data-utils.ts","../../src/lib/renderer/calculate-dimensions.ts","../../src/lib/renderer/helpers.ts","../../src/lib/renderer/render-header.ts","../../src/lib/renderer/elements.ts","../../src/lib/renderer/buttons.ts","../../src/lib/renderer/controls.ts","../../src/lib/renderer/render-initial-view.ts","../../src/lib/renderer/render-frame.ts","../../src/lib/renderer/resize.ts","../../src/lib/renderer/create-renderer.ts","../../src/lib/styles/generated-styles.ts","../../src/lib/styles/style-inject.ts","../../src/lib/events.ts","../../src/lib/scroller.ts","../../src/lib/race.ts"],"sourcesContent":["import * as d3 from './d3';\r\nimport { Data, WideData } from './data';\r\n\r\nexport function loadData(\r\n  URL: string,\r\n  type: 'json' | 'csv' | 'tsv' | 'xml' = 'json',\r\n): Promise<Data[]> | Promise<WideData[]> {\r\n  switch (type) {\r\n    case 'json':\r\n      return d3.json(URL) as Promise<Data[]> | Promise<WideData[]>;\r\n    case 'csv':\r\n      return (d3.csv(URL) as unknown) as Promise<Data[]> | Promise<WideData[]>;\r\n    case 'tsv':\r\n      return (d3.tsv(URL) as unknown) as Promise<Data[]> | Promise<WideData[]>;\r\n    case 'xml':\r\n      return (d3.xml(URL) as unknown) as Promise<Data[]> | Promise<WideData[]>;\r\n    default:\r\n      throw new Error(`Unsupported data type: ${type}`);\r\n  }\r\n}\r\n","import * as d3 from './d3';\n\nimport { Data } from './data';\nimport { Store } from './store';\nimport { formatDate } from './dates';\nimport { ParamFunction } from './options';\n\nexport function getColor(d: Data, store: Store) {\n  const { names, groups } = store.getState().data;\n  const { showGroups, colorSeed, colorMap } = store.getState().options;\n\n  if (d.color) {\n    return d.color;\n  }\n\n  const useGroup = Boolean(d.group) && showGroups && groups.length > 0;\n  let values = useGroup ? groups : names;\n  if (colorSeed) {\n    values = shuffle(values, toNumber(colorSeed));\n  }\n  const currentValue = (useGroup ? d.group : d.name) as string;\n  let index = values.indexOf(currentValue);\n\n  if (colorMap) {\n    if (Array.isArray(colorMap)) {\n      while (index > colorMap.length - 1) {\n        index = index - colorMap.length;\n      }\n      return colorMap[index];\n    } else {\n      if (colorMap[currentValue]) {\n        return colorMap[currentValue];\n      }\n    }\n  }\n\n  const negativeIfOdd = index % 2 === 0 ? 1 : -1;\n  const lumVariation = (random(currentValue) / 10) * negativeIfOdd;\n  const HueSpacing = 360 / (values.length + 1);\n  const hue = (values.indexOf(currentValue) + 1) * HueSpacing;\n  return d3.hsl(hue, 0.75, 0.75 + lumVariation);\n}\n\nexport function getIconID(d: Data) {\n  return 'icon-' + safeName(d.name);\n}\n\nexport function zeroPad(n: string, w: number) {\n  while (n.toString().length < w) {\n    n = '0' + n;\n  }\n  return n;\n}\n\nfunction toNumber(s: string | number) {\n  s = String(s);\n  let nums = '';\n  for (let i = 0; i < s.length; i++) {\n    nums += zeroPad(String(s.charCodeAt(i)), 3);\n  }\n  return +nums;\n}\n\nexport function random(InputSeed: string | number) {\n  const seed = toNumber(InputSeed);\n  const x = Math.sin(seed) * 10000;\n  return x - Math.floor(x);\n}\n\nexport function shuffle(arr: string[], seed: number) {\n  const array = [...arr];\n  let m = array.length;\n  let t: string;\n  let i: number;\n\n  while (m) {\n    i = Math.floor(random(seed) * m--);\n    t = array[m];\n    array[m] = array[i];\n    array[i] = t;\n    ++seed;\n  }\n\n  return array;\n}\n\nexport function getHeight(element: HTMLElement, minHeight: number, height?: string) {\n  let newHeight: number;\n  if (!height) {\n    newHeight = element.getBoundingClientRect().height;\n  } else if (String(height).startsWith('window')) {\n    const scale = +height.split('*')[1] || 1;\n    newHeight = window.innerHeight * scale;\n  } else {\n    newHeight = +height;\n  }\n  return newHeight > minHeight ? newHeight : minHeight;\n}\n\nexport function getWidth(element: HTMLElement, minWidth: number, width?: string) {\n  let newWidth: number;\n  if (!width) {\n    newWidth = element.getBoundingClientRect().width;\n  } else if (String(width).startsWith('window')) {\n    const scale = +width.split('*')[1] || 1;\n    newWidth = window.innerWidth * scale;\n  } else {\n    newWidth = +width;\n  }\n  return newWidth > minWidth ? newWidth : minWidth;\n}\n\nexport function getElement(root: HTMLElement, className: string) {\n  // TODO: fix Cannot read property 'querySelector' of null\n  return root.querySelector('.' + className) as HTMLElement;\n}\n\nexport function showElement(root: HTMLElement, className: string, useVisibility = false) {\n  const element = getElement(root, className);\n  if (element) {\n    if (useVisibility) {\n      element.style.visibility = 'unset';\n    } else {\n      element.style.display = 'flex';\n    }\n  }\n}\n\nexport function hideElement(root: HTMLElement, className: string, useVisibility = false) {\n  const element = getElement(root, className);\n  if (element) {\n    if (useVisibility) {\n      element.style.visibility = 'hidden';\n    } else {\n      element.style.display = 'none';\n    }\n  }\n}\n\nexport function removeElement(root: HTMLElement, className: string) {\n  const element = getElement(root, className);\n  if (element) {\n    element.remove();\n  }\n}\n\nexport function getText(\n  param: string | ParamFunction,\n  currentDate: string,\n  dateSlice: Data[],\n  dates: string[],\n  isDate = false,\n): string {\n  if (typeof param === 'function') {\n    return param(currentDate, dateSlice, dates);\n  }\n  if (isDate) {\n    return formatDate(currentDate, param);\n  }\n  return param;\n}\n\nexport function safeName(name: string) {\n  // replace non-alphanumeric with underscore\n  return name.replace(/[\\W]+/g, '_');\n}\n\nexport function toggleClass(root: HTMLElement, selector: string, className: string) {\n  d3.select(root)\n    .select(selector)\n    .classed(className, function () {\n      return !d3.select(this).classed(className);\n    });\n}\n\nfunction debounce(func: any, wait: number, immediate = false) {\n  let timeout: any;\n  return function (_clicks: any, _Fn: (clicks: number) => void) {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const context = this;\n    const args = arguments;\n    const later = function () {\n      timeout = null;\n      if (!immediate) {\n        func.apply(context, args);\n      }\n    };\n    const callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) {\n      func.apply(context, args);\n    }\n  };\n}\n\nexport const getClicks = debounce(function (event: any, Fn: (event: any) => void) {\n  Fn(event);\n}, 250);\n","import * as d3 from './d3';\r\nimport { Data } from './data';\r\nimport { zeroPad } from './utils';\r\n\r\nexport const getDates = (data: Data[]) => Array.from(new Set(data.map((d) => d.date))).sort();\r\n\r\nexport function getDateString(inputDate: string | Date) {\r\n  const date = new Date(inputDate);\r\n  if (isNaN(+date)) {\r\n    throw new Error(`\"${inputDate}\" is not a valid date`);\r\n  }\r\n\r\n  const year = date.getFullYear().toString();\r\n  const month = zeroPad((1 + date.getMonth()).toString(), 2);\r\n  const day = zeroPad(date.getDate().toString(), 2);\r\n\r\n  return `${year}-${month}-${day}`;\r\n}\r\n\r\nexport function formatDate(dateStr: string, format = 'YYYY-MM-DD') {\r\n  const year = dateStr.slice(0, 4);\r\n  const month = dateStr.slice(5, 7);\r\n  const day = dateStr.slice(8, 10);\r\n  const date = new Date(dateStr);\r\n  const weekDayIndex = String(date.getDay());\r\n  const monthNames: { [key: string]: string } = {\r\n    '01': 'Jan',\r\n    '02': 'Feb',\r\n    '03': 'Mar',\r\n    '04': 'Apr',\r\n    '05': 'May',\r\n    '06': 'Jun',\r\n    '07': 'Jul',\r\n    '08': 'Aug',\r\n    '09': 'Sep',\r\n    '10': 'Oct',\r\n    '11': 'Nov',\r\n    '12': 'Dec',\r\n  };\r\n\r\n  const weekDays: { [key: string]: string } = {\r\n    '0': 'Sun',\r\n    '1': 'Mon',\r\n    '2': 'Tue',\r\n    '3': 'Wed',\r\n    '4': 'Thu',\r\n    '5': 'Fri',\r\n    '6': 'Sat',\r\n  };\r\n\r\n  return format\r\n    .replace('MMM', monthNames[month])\r\n    .replace('DDD', weekDays[weekDayIndex])\r\n    .replace('YYYY', year)\r\n    .replace('MM', month)\r\n    .replace('DD', day);\r\n}\r\n\r\nexport function getDateRange(date1: Date, date2: Date, interval: 'year' | 'month' | 'day') {\r\n  const range = [date1, ...d3.timeDay.range(date1, date2)];\r\n\r\n  const daysInMonth = (date: Date) =>\r\n    new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();\r\n\r\n  const sameDay = date1.getDate() === date2.getDate();\r\n  const sameMonth = date1.getMonth() === date2.getMonth();\r\n\r\n  const numberOfMonths = d3.timeMonth.count(date1, date2);\r\n  const numberOfYears = d3.timeYear.count(date1, date2);\r\n\r\n  let outputRange: Date[] = [];\r\n\r\n  if (interval === 'year') {\r\n    if (sameMonth && sameDay) {\r\n      outputRange = range.filter((date) => {\r\n        if (date.getMonth() === date1.getMonth()) {\r\n          if (date.getDate() === date1.getDate()) return true;\r\n          if (date1.getDate() > daysInMonth(date)) {\r\n            return date.getDate() === daysInMonth(date);\r\n          }\r\n        }\r\n        return false;\r\n      });\r\n    } else {\r\n      outputRange = range.filter(\r\n        (date) => range.indexOf(date) % Math.round(range.length / numberOfYears) === 0,\r\n      );\r\n    }\r\n  } else if (interval === 'month') {\r\n    if (sameDay) {\r\n      outputRange = range.filter((date) => {\r\n        if (date.getDate() === date1.getDate()) return true;\r\n        if (date1.getDate() > daysInMonth(date)) {\r\n          return date.getDate() === daysInMonth(date);\r\n        }\r\n        return false;\r\n      });\r\n    } else {\r\n      outputRange = range.filter(\r\n        (date) => range.indexOf(date) % Math.round(range.length / numberOfMonths) === 0,\r\n      );\r\n    }\r\n  } else if (interval === 'day') {\r\n    outputRange = range;\r\n  }\r\n\r\n  if (outputRange.length === 0) {\r\n    outputRange = [date1, date2];\r\n  }\r\n  if (getDateString(date1) !== getDateString(outputRange[0])) {\r\n    outputRange = [date1, ...outputRange];\r\n  }\r\n  if (getDateString(date2) !== getDateString(outputRange[outputRange.length - 1])) {\r\n    outputRange = [...outputRange, date2];\r\n  }\r\n\r\n  return outputRange;\r\n}\r\n","import { DataAction, DataCollections } from './data.models';\r\n\r\nexport const actionTypes = {\r\n  dataLoaded: 'data/loaded',\r\n  addFilter: 'data/addFilter',\r\n  removeFilter: 'data/removeFilter',\r\n  toggleFilter: 'data/toggleFilter',\r\n  resetFilters: 'data/resetFilters',\r\n  allExceptFilter: 'data/allExceptFilter',\r\n  addSelection: 'data/addSelection',\r\n  removeSelection: 'data/removeSelection',\r\n  toggleSelection: 'data/toggleSelection',\r\n  resetSelections: 'data/resetSelections',\r\n};\r\n\r\nexport const dataLoaded = (dataCollections: DataCollections): DataAction => ({\r\n  type: actionTypes.dataLoaded,\r\n  payload: dataCollections,\r\n});\r\n\r\nexport const addFilter = (group: string): DataAction => ({\r\n  type: actionTypes.addFilter,\r\n  payload: group,\r\n});\r\n\r\nexport const removeFilter = (group: string): DataAction => ({\r\n  type: actionTypes.removeFilter,\r\n  payload: group,\r\n});\r\n\r\nexport const toggleFilter = (group: string): DataAction => ({\r\n  type: actionTypes.toggleFilter,\r\n  payload: group,\r\n});\r\n\r\nexport const resetFilters = (): DataAction => ({\r\n  type: actionTypes.resetFilters,\r\n});\r\n\r\nexport const allExceptFilter = (group: string): DataAction => ({\r\n  type: actionTypes.allExceptFilter,\r\n  payload: group,\r\n});\r\n\r\nexport const addSelection = (selection: string): DataAction => ({\r\n  type: actionTypes.addSelection,\r\n  payload: selection,\r\n});\r\n\r\nexport const removeSelection = (selection: string): DataAction => ({\r\n  type: actionTypes.removeSelection,\r\n  payload: selection,\r\n});\r\n\r\nexport const toggleSelection = (selection: string): DataAction => ({\r\n  type: actionTypes.toggleSelection,\r\n  payload: selection,\r\n});\r\n\r\nexport const resetSelections = (): DataAction => ({\r\n  type: actionTypes.resetSelections,\r\n});\r\n","import { actionTypes } from './data.actions';\r\nimport { DataState, DataAction, DataCollections } from './data.models';\r\n\r\nconst initialState: DataState = {\r\n  names: [],\r\n  groups: [],\r\n  groupFilter: [],\r\n  selected: [],\r\n};\r\n\r\nexport function dataReducer(state = initialState, action: DataAction): DataState {\r\n  switch (action.type) {\r\n    case actionTypes.dataLoaded: {\r\n      const collections = action.payload as DataCollections;\r\n      return {\r\n        ...state,\r\n        names: [...collections.names],\r\n        groups: [...collections.groups],\r\n      };\r\n    }\r\n\r\n    case actionTypes.addFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: addToArray(state.groupFilter, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.removeFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: removeFromArray(state.groupFilter, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.toggleFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: toggleItem(state.groupFilter, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.resetFilters:\r\n      return {\r\n        ...state,\r\n        groupFilter: [],\r\n      };\r\n\r\n    case actionTypes.allExceptFilter:\r\n      return {\r\n        ...state,\r\n        groupFilter: removeFromArray(state.groups, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.addSelection:\r\n      return {\r\n        ...state,\r\n        selected: addToArray(state.selected, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.removeSelection:\r\n      return {\r\n        ...state,\r\n        selected: removeFromArray(state.selected, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.toggleSelection:\r\n      return {\r\n        ...state,\r\n        selected: toggleItem(state.selected, action.payload as string),\r\n      };\r\n\r\n    case actionTypes.resetSelections:\r\n      return {\r\n        ...state,\r\n        selected: [],\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction addToArray(array: string[], item: string) {\r\n  const arr = [...array];\r\n  if (!arr.includes(item)) {\r\n    arr.push(item);\r\n  }\r\n  return arr;\r\n}\r\n\r\nfunction removeFromArray(array: string[], item: string) {\r\n  return array.filter((x) => x !== item);\r\n}\r\n\r\nfunction toggleItem(array: string[], item: string) {\r\n  return array.includes(item) ? removeFromArray(array, item) : addToArray(array, item);\r\n}\r\n","import { Options, OptionsAction } from './options.models';\r\n\r\nexport const actionTypes = {\r\n  optionsLoaded: 'options/loaded',\r\n  changeOptions: 'options/change',\r\n  optionsChanged: 'options/changed',\r\n};\r\n\r\nexport const optionsLoaded = (options: Partial<Options>): OptionsAction => ({\r\n  type: actionTypes.optionsLoaded,\r\n  payload: options,\r\n});\r\n\r\nexport const changeOptions = (options: Partial<Options>): OptionsAction => ({\r\n  type: actionTypes.changeOptions,\r\n  payload: options,\r\n});\r\n","import { getDateString } from '../dates';\nimport { Options, OptionsAction } from './options.models';\nimport { actionTypes } from './options.actions';\n\nconst initialState: Options = {\n  selector: '#race',\n  dataShape: 'long',\n  dataTransform: null,\n  fillDateGapsInterval: null,\n  fillDateGapsValue: 'interpolate',\n  startDate: '',\n  endDate: '',\n  colorSeed: '',\n  showGroups: false,\n  tickDuration: 500,\n  topN: 10,\n  mouseControls: false,\n  keyboardControls: false,\n  autorun: true,\n  loop: false,\n  injectStyles: true,\n  title: '',\n  subTitle: '',\n  caption: '',\n  dateCounter: 'MM/YYYY',\n  labelsPosition: 'inside',\n  labelsWidth: 150,\n  showIcons: false,\n  controlButtons: 'all',\n  overlays: 'none',\n  inputHeight: '',\n  inputWidth: '',\n  minHeight: 300,\n  minWidth: 500,\n  height: '',\n  width: '',\n  marginTop: 0,\n  marginRight: 20,\n  marginBottom: 5,\n  marginLeft: 0,\n  theme: 'light',\n  colorMap: {},\n  fixedScale: false,\n  fixedOrder: [],\n  highlightBars: false,\n  selectBars: false,\n};\n\nexport function optionsReducer(state = initialState, action: OptionsAction): Options {\n  switch (action.type) {\n    case actionTypes.optionsLoaded: {\n      const excludedKeys = ['inputHeight', 'inputWidth', 'minHeight', 'minWidth'];\n      const options: Partial<Options> = {};\n\n      // remove null, undefined and excluded keys\n      (Object.keys(action.payload) as Array<keyof Options>).forEach((key) => {\n        if (!excludedKeys.includes(key)) {\n          (options[key] as any) = action.payload[key] ?? state[key];\n        }\n      });\n\n      const startDate = options.startDate ? getDateString(options.startDate) : '';\n      const endDate = options.endDate ? getDateString(options.endDate) : '';\n\n      const inputHeight = options.height || state.inputHeight;\n      const inputWidth = options.width || state.inputWidth;\n\n      const fixedOrder = Array.isArray(options.fixedOrder)\n        ? [...options.fixedOrder]\n        : state.fixedOrder;\n\n      const colorMap = Array.isArray(options.colorMap)\n        ? ([...options.colorMap] as string[])\n        : typeof options.colorMap === 'object'\n        ? { ...options.colorMap }\n        : state.colorMap;\n\n      let topN = state.topN;\n      if (Number(options.topN)) {\n        topN = Number(options.topN);\n      }\n      if (fixedOrder.length > 0 && topN > fixedOrder.length) {\n        topN = fixedOrder.length;\n      }\n\n      const tickDuration = Number(options.tickDuration) || state.tickDuration;\n      const labelsWidth = Number(options.labelsWidth) || state.labelsWidth;\n      const marginTop = Number(options.marginTop) || state.marginTop;\n      const marginRight = Number(options.marginRight) || state.marginRight;\n      const marginBottom = Number(options.marginBottom) || state.marginBottom;\n      const marginLeft = Number(options.marginLeft) || state.marginLeft;\n      return {\n        ...state,\n        ...options,\n        startDate,\n        endDate,\n        inputHeight,\n        inputWidth,\n        fixedOrder,\n        colorMap,\n        topN,\n        tickDuration,\n        labelsWidth,\n        marginTop,\n        marginRight,\n        marginBottom,\n        marginLeft,\n      };\n    }\n    case actionTypes.changeOptions:\n      return {\n        ...state,\n        ...action.payload,\n      };\n\n    default:\n      return state;\n  }\n}\n","import { TickerAction, TickerEvent } from './ticker.models';\r\n\r\nexport const actionTypes = {\r\n  initialize: 'ticker/initialize',\r\n  updateDate: 'ticker/updateDate',\r\n  setRunning: 'ticker/setRunning',\r\n  setFirst: 'ticker/setFirst',\r\n  setLast: 'ticker/setLast',\r\n  inc: 'ticker/inc',\r\n  dec: 'ticker/dec',\r\n};\r\n\r\nexport const initialize = (dates: string[]): TickerAction => ({\r\n  type: actionTypes.initialize,\r\n  payload: dates,\r\n  event: 'initial',\r\n});\r\n\r\nexport const updateDate = (currentDate: string, event: TickerEvent): TickerAction => ({\r\n  type: actionTypes.updateDate,\r\n  payload: currentDate,\r\n  event,\r\n});\r\n\r\nexport const setRunning = (running: boolean, event: TickerEvent): TickerAction => ({\r\n  type: actionTypes.setRunning,\r\n  payload: running,\r\n  event,\r\n});\r\n\r\nexport const setFirst = (event: TickerEvent): TickerAction => ({\r\n  type: actionTypes.setFirst,\r\n  event,\r\n});\r\n\r\nexport const setLast = (event: TickerEvent): TickerAction => ({\r\n  type: actionTypes.setLast,\r\n  event,\r\n});\r\n\r\nexport const inc = (event: TickerEvent, value = 1): TickerAction => ({\r\n  type: actionTypes.inc,\r\n  payload: value,\r\n  event,\r\n});\r\n\r\nexport const dec = (event: TickerEvent, value = 1): TickerAction => ({\r\n  type: actionTypes.dec,\r\n  payload: value,\r\n  event,\r\n});\r\n","import { TickerState, TickerAction } from './ticker.models';\r\nimport { actionTypes } from './ticker.actions';\r\n\r\nconst initialState: TickerState = {\r\n  event: 'initial',\r\n  isRunning: false,\r\n  currentDate: '',\r\n  isFirstDate: true,\r\n  isLastDate: false,\r\n  dates: [],\r\n};\r\n\r\nexport function tickerReducer(state = initialState, action: TickerAction): TickerState {\r\n  switch (action.type) {\r\n    case actionTypes.initialize: {\r\n      const dates = action.payload as string[];\r\n      return {\r\n        ...state,\r\n        isRunning: false,\r\n        currentDate: dates[0],\r\n        isFirstDate: true,\r\n        isLastDate: false,\r\n        dates,\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    case actionTypes.updateDate: {\r\n      const currentDate = action.payload as string;\r\n      if (state.dates.indexOf(currentDate) === -1) {\r\n        return { ...state };\r\n      }\r\n      return {\r\n        ...state,\r\n        currentDate,\r\n        isFirstDate: currentDate === state.dates[0],\r\n        isLastDate: currentDate === state.dates[state.dates.length - 1],\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setRunning: {\r\n      return {\r\n        ...state,\r\n        isRunning: action.payload as boolean,\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setFirst: {\r\n      return {\r\n        ...state,\r\n        currentDate: state.dates[0],\r\n        isFirstDate: true,\r\n        isLastDate: false,\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    case actionTypes.setLast: {\r\n      return {\r\n        ...state,\r\n        currentDate: state.dates[state.dates.length - 1],\r\n        isFirstDate: false,\r\n        isLastDate: true,\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    case actionTypes.inc: {\r\n      const currentIndex = state.dates.indexOf(state.currentDate);\r\n      const lastIndex = state.dates.length - 1;\r\n      const incValue = action.payload as number;\r\n      const newDate =\r\n        currentIndex + incValue > lastIndex\r\n          ? state.dates[lastIndex]\r\n          : state.dates[currentIndex + incValue];\r\n      return {\r\n        ...state,\r\n        currentDate: newDate,\r\n        isFirstDate: newDate === state.dates[0],\r\n        isLastDate: newDate === state.dates[lastIndex],\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    case actionTypes.dec: {\r\n      const currentIndex = state.dates.indexOf(state.currentDate);\r\n      const decValue = action.payload as number;\r\n      const newDate =\r\n        currentIndex - decValue < 0 ? state.dates[0] : state.dates[currentIndex - decValue];\r\n      return {\r\n        ...state,\r\n        currentDate: newDate,\r\n        isFirstDate: newDate === state.dates[0],\r\n        isLastDate: newDate === state.dates[state.dates.length - 1],\r\n        event: action.event,\r\n      };\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n","import * as d3 from '../d3';\r\nimport { actions, Store } from '../store';\r\nimport { Ticker, TickerEvent } from './ticker.models';\r\n\r\nexport function createTicker(store: Store): Ticker {\r\n  let ticker: d3.Timer;\r\n\r\n  function start(event: TickerEvent) {\r\n    ticker = d3.interval(showRace, store.getState().options.tickDuration);\r\n    store.dispatch(actions.ticker.setRunning(true, event));\r\n\r\n    function showRace(_: number) {\r\n      if (store.getState().ticker.isLastDate) {\r\n        if (\r\n          store.getState().options.loop ||\r\n          store.getState().ticker.event === 'playButton' ||\r\n          store.getState().ticker.event === 'apiStart' ||\r\n          store.getState().ticker.event === 'keyboardToggle' ||\r\n          store.getState().ticker.event === 'mouseClick'\r\n        ) {\r\n          loop();\r\n        } else {\r\n          stop('end');\r\n        }\r\n      } else {\r\n        store.dispatch(actions.ticker.inc('running'));\r\n      }\r\n    }\r\n  }\r\n\r\n  function stop(event: TickerEvent) {\r\n    if (ticker) {\r\n      ticker.stop();\r\n    }\r\n    store.dispatch(actions.ticker.setRunning(false, event));\r\n  }\r\n\r\n  function skipBack(event: TickerEvent) {\r\n    stop(event);\r\n    store.dispatch(actions.ticker.setFirst(event));\r\n  }\r\n\r\n  function loop() {\r\n    store.dispatch(actions.ticker.setFirst('loop'));\r\n  }\r\n\r\n  function skipForward(event: TickerEvent) {\r\n    stop(event);\r\n    store.dispatch(actions.ticker.setLast(event));\r\n    store.dispatch(actions.ticker.setLast(event)); // workaround to avoid showing lastValue\r\n  }\r\n\r\n  function toggle(event: TickerEvent) {\r\n    if (store.getState().ticker.isLastDate) {\r\n      skipBack(event);\r\n      start(event);\r\n    } else if (store.getState().ticker.isRunning) {\r\n      stop(event);\r\n    } else {\r\n      // if (!store.getState().ticker.isFirstDate) {\r\n      //   // to avoid lastValue flicker\r\n      //   store.dispatch(actions.ticker.inc(event));\r\n      // }\r\n      start(event);\r\n    }\r\n  }\r\n\r\n  function goToDate(date: string, event: TickerEvent) {\r\n    store.dispatch(actions.ticker.updateDate(date, event));\r\n  }\r\n\r\n  return {\r\n    start,\r\n    stop,\r\n    skipBack,\r\n    loop,\r\n    skipForward,\r\n    toggle,\r\n    goToDate,\r\n  };\r\n}\r\n","import * as data from '../data';\r\nimport * as options from '../options';\r\nimport * as ticker from '../ticker';\r\n\r\nexport const actions = {\r\n  data,\r\n  options,\r\n  ticker,\r\n};\r\n","import { optionsReducer, OptionsAction } from '../options';\r\nimport { tickerReducer, TickerAction } from '../ticker';\r\nimport { dataReducer, DataAction } from '../data';\r\nimport { Action, State } from './models';\r\n\r\nexport function rootReducer(state: State, action: Action): State {\r\n  return {\r\n    data: dataReducer(state.data, action as DataAction),\r\n    options: optionsReducer(state.options, action as OptionsAction),\r\n    ticker: tickerReducer(state.ticker, action as TickerAction),\r\n  };\r\n}\r\n","import { Action, Reducer, State, Subscriber } from './models';\nimport { rootReducer } from './reducer';\n\nexport function createStore(reducer: Reducer = rootReducer, preloadedState?: State) {\n  let state = {} as State;\n\n  if (preloadedState) {\n    state = preloadedState;\n  }\n\n  function dispatch(action: Action) {\n    state = reducer(state, action);\n    notifySubscribers();\n    return action;\n  }\n\n  function getState() {\n    return state;\n  }\n\n  const subscribers: Subscriber[] = [];\n\n  function subscribe(fn: Subscriber) {\n    subscribers.push(fn);\n    const index = subscribers.length - 1;\n\n    return {\n      unsubscribe: () => {\n        subscribers.splice(index, 1);\n      },\n    };\n  }\n\n  function notifySubscribers() {\n    subscribers.forEach((fn: Subscriber) => {\n      fn();\n    });\n  }\n\n  function unubscribeAll() {\n    subscribers.length = 0;\n  }\n\n  return {\n    getState,\n    dispatch,\n    subscribe,\n    unubscribeAll,\n  };\n}\n","import * as d3 from './d3';\r\n\r\nimport { getDateString, getDates, getDateRange } from './dates';\r\nimport { Data, WideData } from './data';\r\nimport { actions, Store } from './store';\r\nimport { Options } from './options';\r\n\r\nexport function prepareData(rawData: Data[], store: Store) {\r\n  const options = store.getState().options;\r\n\r\n  let data = rawData;\r\n\r\n  if (options.dataTransform && typeof options.dataTransform === 'function') {\r\n    data = options.dataTransform(data) as Data[];\r\n  }\r\n\r\n  data = data\r\n    .map((d) => ({ ...d, date: getDateString(d.date) }))\r\n    .filter((d) => (options.startDate ? d.date >= options.startDate : true))\r\n    .filter((d) => (options.endDate ? d.date <= options.endDate : true));\r\n\r\n  if (options.dataShape === 'wide') {\r\n    data = wideDataToLong(data);\r\n  }\r\n\r\n  if (options.fixedOrder.length > 0) {\r\n    data = data\r\n      .filter((d) => options.fixedOrder.includes(d.name))\r\n      .map((d) => ({ ...d, rank: options.fixedOrder.indexOf(d.name) }));\r\n  }\r\n\r\n  data = data\r\n    .map((d) => {\r\n      const name = d.name ? d.name : '';\r\n      const value = isNaN(+d.value) ? 0 : +d.value;\r\n      return { ...d, name, value };\r\n    })\r\n    .sort((a, b) => a.date.localeCompare(b.date) || a.name.localeCompare(b.name));\r\n\r\n  if (options.fillDateGapsInterval) {\r\n    data = fillGaps(data, options.fillDateGapsInterval, options.fillDateGapsValue, options.topN);\r\n  }\r\n\r\n  data = calculateLastValues(data);\r\n\r\n  storeDataCollections(data, store);\r\n\r\n  return data;\r\n}\r\n\r\nfunction storeDataCollections(data: Data[], store: Store) {\r\n  const names = Array.from(new Set(data.map((d) => d.name))).sort() as string[];\r\n  const groups = Array.from(new Set(data.map((d) => d.group)))\r\n    .filter(Boolean)\r\n    .sort() as string[];\r\n  const dates = getDates(data);\r\n\r\n  store.dispatch(actions.data.dataLoaded({ names, groups }));\r\n  store.dispatch(actions.ticker.initialize(dates));\r\n}\r\n\r\nfunction calculateLastValues(data: Data[]) {\r\n  return data\r\n    .sort((a, b) => a.name.localeCompare(b.name) || a.date.localeCompare(b.date))\r\n    .reduce((acc: Data[], curr) => {\r\n      if (acc.length === 0) {\r\n        curr.lastValue = curr.value;\r\n      } else {\r\n        const last = acc[acc.length - 1];\r\n        if (curr.name === last.name) {\r\n          curr.lastValue = last.value;\r\n        } else {\r\n          curr.lastValue = curr.value;\r\n        }\r\n      }\r\n      return [...acc, curr];\r\n    }, []);\r\n}\r\n\r\nfunction wideDataToLong(wide: WideData[], nested = false) {\r\n  const long = [] as Data[];\r\n  wide.forEach((row) => {\r\n    for (const [key, value] of Object.entries(row)) {\r\n      if (key === 'date') {\r\n        continue;\r\n      }\r\n\r\n      let item: any = {\r\n        date: row.date,\r\n        name: key,\r\n      };\r\n      if (nested) {\r\n        item = {\r\n          ...item,\r\n          ...value,\r\n        };\r\n      } else {\r\n        item = {\r\n          ...item,\r\n          value,\r\n        };\r\n      }\r\n      long.push(item);\r\n    }\r\n  });\r\n  return long;\r\n}\r\n\r\nfunction longDataToWide(long: Data[]) {\r\n  const wide = [] as any[];\r\n  long.forEach((item) => {\r\n    const dateRow = wide.filter((r) => r.date === item.date);\r\n    const row = dateRow.length > 0 ? dateRow[0] : {};\r\n    const { date, ...details } = item;\r\n    row[item.name] = details;\r\n    if (dateRow.length === 0) {\r\n      row.date = item.date;\r\n      wide.push(row);\r\n    }\r\n  });\r\n  return wide;\r\n}\r\n\r\nfunction fillGaps(\r\n  data: Data[],\r\n  interval: Options['fillDateGapsInterval'],\r\n  fillValue: Options['fillDateGapsValue'],\r\n  topN: number,\r\n) {\r\n  if (!interval) {\r\n    return data;\r\n  }\r\n\r\n  const wideData = longDataToWide(data).map((d) => ({ ...d, date: new Date(d.date) }));\r\n\r\n  const allData = wideData\r\n    .reduce(\r\n      (acc: any[], row, i) => {\r\n        const lastDate = acc[acc.length - 1].date;\r\n        const range = getDateRange(lastDate, row.date, interval).slice(1);\r\n\r\n        const rangeStep = 1 / range.length;\r\n        if (i < wideData.length) {\r\n          const iData = interpolateTopN(wideData[i - 1], wideData[i], topN);\r\n          const newData: any[] = [];\r\n          range.forEach((_, j) => {\r\n            const values = fillValue === 'last' ? iData(0) : iData((j + 1) * rangeStep);\r\n            const newRow: any = { date: range[j] };\r\n            for (const [key, value] of Object.entries(values)) {\r\n              if (key !== 'date') {\r\n                newRow[key] = { ...(value as any) };\r\n              }\r\n            }\r\n            newData.push(getDateString(row.date) === getDateString(newRow.date) ? row : newRow);\r\n          });\r\n          return [...acc, ...newData];\r\n        } else {\r\n          return [...acc];\r\n        }\r\n      },\r\n      [wideData[0]],\r\n    )\r\n    .map((d) => ({ ...d, date: getDateString(d.date) }));\r\n\r\n  return wideDataToLong(allData, true);\r\n}\r\n\r\n/** Interpolate only topN before and after the date range to improve performace */\r\nfunction interpolateTopN(\r\n  data1: Partial<WideData> = {},\r\n  data2: Partial<WideData> = {},\r\n  topN: number,\r\n) {\r\n  const topData1 = getTopN(data1, topN);\r\n  const topData2 = getTopN(data2, topN);\r\n  const topNames = Array.from(new Set([...topData1, ...topData2]));\r\n\r\n  const filteredData1 = topNames.reduce((obj, curr) => {\r\n    obj[curr] = data1[curr];\r\n    return obj;\r\n  }, {} as WideData);\r\n\r\n  const filteredData2 = topNames.reduce((obj, curr) => {\r\n    obj[curr] = data2[curr];\r\n    return obj;\r\n  }, {} as WideData);\r\n\r\n  return d3.interpolate(filteredData1, filteredData2);\r\n\r\n  function getTopN(data: { [key: string]: { name: string; value: number } } = {}, topN: number) {\r\n    return Object.keys(data)\r\n      .filter((key) => key !== 'date')\r\n      .map((key) => data[key])\r\n      .sort(function (a, b) {\r\n        return b.value - a.value;\r\n      })\r\n      .slice(0, topN)\r\n      .map((d) => d.name);\r\n  }\r\n}\r\n\r\nexport function getDateSlice(data: Data[], date: string, groupFilter: string[]) {\r\n  const slice = data\r\n    .filter((d) => d.date === date && !isNaN(d.value))\r\n    .filter((d) => (!!d.group ? !groupFilter.includes(d.group) : true))\r\n    .sort((a, b) => b.value - a.value)\r\n    .map((d, i) => ({ ...d, rank: d.rank ?? i }));\r\n\r\n  const emptyData = [{ name: '', value: 0, lastValue: 0, date, rank: 1 }];\r\n\r\n  return slice.length > 0 ? slice : emptyData;\r\n}\r\n","import * as d3 from '../d3';\n\nimport { Data } from '../data';\nimport { Store } from '../store';\nimport { getHeight, getWidth } from '../utils';\nimport { RenderOptions } from './render-options';\n\nexport function calculateDimensions(store: Store, renderOptions: RenderOptions) {\n  const {\n    minHeight,\n    inputHeight,\n    minWidth,\n    inputWidth,\n    title,\n    subTitle,\n    showGroups,\n    controlButtons,\n    marginTop,\n    marginRight,\n    marginBottom,\n    marginLeft,\n    labelsPosition,\n    labelsWidth,\n    topN,\n    showIcons,\n  } = store.getState().options;\n  const { root, maxValue } = renderOptions;\n\n  const height = (renderOptions.height = getHeight(root, minHeight, inputHeight));\n  const width = (renderOptions.width = getWidth(root, minWidth, inputWidth));\n\n  const titlePadding = 5;\n  const titleHeight = title ? 55 : 0;\n  const subTitleHeight = !subTitle ? 0 : title ? 20 : 40;\n  const groupsHeight = !showGroups ? 0 : titleHeight || subTitleHeight ? 20 : 30;\n  const controlsHeight = controlButtons !== 'none' ? 50 : 0;\n\n  const headerHeight = Math.max(\n    titleHeight + subTitleHeight + groupsHeight,\n    controlsHeight + groupsHeight,\n    10,\n  );\n\n  const labelsArea = labelsPosition === 'inside' ? 0 : labelsWidth;\n  const topAxisPadding = 15;\n\n  const margin = {\n    top: marginTop + headerHeight + topAxisPadding,\n    right: marginRight,\n    bottom: marginBottom,\n    left: marginLeft + labelsArea,\n  };\n\n  const x = (renderOptions.x = d3\n    .scaleLinear()\n    .domain([0, maxValue])\n    .range([margin.left, width - margin.right - 65]));\n\n  const y = (renderOptions.y = d3\n    .scaleLinear()\n    .domain([topN, 0])\n    .range([height - margin.bottom, margin.top]));\n\n  const barPadding = (renderOptions.barPadding =\n    (height - (margin.bottom + margin.top)) / (topN * 5));\n  const labelPadding = (renderOptions.labelPadding = 8);\n  renderOptions.barWidth = (d: Data) => Math.abs(x(d.value) - x(0) - 1);\n  const barHeight = (renderOptions.barHeight = y(1) - y(0) - barPadding);\n  renderOptions.barHalfHeight = (y(1) - y(0)) / 2 + 1;\n  renderOptions.barY = (d: Data) => y(d.rank as number) + 5;\n  const iconSize = (renderOptions.iconSize = showIcons ? barHeight * 0.9 : 0);\n  const iconSpace = (renderOptions.iconSpace = showIcons ? iconSize + labelPadding : 0);\n  renderOptions.labelX =\n    labelsPosition === 'inside'\n      ? (d: Data) => x(d.value) - labelPadding - iconSpace\n      : margin.left - labelPadding;\n\n  renderOptions.titlePadding = titlePadding;\n  renderOptions.titleHeight = titleHeight;\n  renderOptions.margin = margin;\n}\n","import * as d3 from '../d3';\n\nimport { safeName, toggleClass, getClicks } from '../utils';\nimport { Store, actions } from '../store';\nimport { Data } from '../data';\nimport { RenderOptions } from './render-options';\n\nexport function halo(text: any, renderOptions: RenderOptions) {\n  renderOptions.svg //\n    .selectAll('.halo')\n    .remove();\n\n  text\n    .select(function () {\n      return this.parentNode.insertBefore(this.cloneNode(true), this);\n    })\n    .classed('halo', true);\n}\n\nexport function legendClick(d: string, store: Store) {\n  getClicks(d3.event, function (event: any) {\n    const clicks = event.detail;\n    if (clicks === 3) {\n      store.dispatch(actions.data.resetFilters());\n    } else if (clicks === 2) {\n      store.dispatch(actions.data.allExceptFilter(d));\n    } else {\n      store.dispatch(actions.data.toggleFilter(d));\n    }\n  });\n}\n\nexport function highlightFn(d: Data, store: Store, renderOptions: RenderOptions) {\n  if (store.getState().options.highlightBars) {\n    toggleClass(renderOptions.root, 'rect.' + safeName(d.name), 'highlight');\n  }\n}\n\nexport function selectFn(d: Data, store: Store, renderOptions: RenderOptions) {\n  if (store.getState().options.selectBars) {\n    toggleClass(renderOptions.root, 'rect.' + safeName(d.name), 'selected');\n    store.dispatch(actions.data.toggleSelection(d.name));\n  }\n}\n","import * as d3 from '../d3';\n\nimport { Data } from '../data';\nimport { Store } from '../store';\nimport { getText, getColor } from '../utils';\nimport { RenderOptions } from './render-options';\nimport { legendClick } from './helpers';\n\nexport function renderHeader(\n  store: Store,\n  renderOptions: RenderOptions,\n  CompleteDateSlice: Data[],\n) {\n  const groups = store.getState().data.groups;\n  const dates = store.getState().ticker.dates;\n  const currentDate = store.getState().ticker.currentDate;\n  const { title, subTitle, marginTop, marginLeft, showGroups } = store.getState().options;\n  const { svg, margin, width, titlePadding, titleHeight } = renderOptions;\n\n  renderOptions.titleText = svg\n    .append('text')\n    .attr('class', 'title')\n    .attr('x', marginLeft + titlePadding)\n    .attr('y', marginTop + 24)\n    .html(getText(title, currentDate, CompleteDateSlice, dates));\n\n  renderOptions.subTitleText = svg\n    .append('text')\n    .attr('class', 'subTitle')\n    .attr('x', marginLeft + titlePadding)\n    .attr('y', marginTop + (titleHeight || 24))\n    .html(getText(subTitle, currentDate, CompleteDateSlice, dates));\n\n  if (showGroups) {\n    const legendsWrapper = svg.append('g');\n    const legends = legendsWrapper\n      .selectAll('.legend-wrapper')\n      .data(groups)\n      .enter()\n      .append('g')\n      .attr('class', 'legend legend-wrapper')\n      .style('cursor', 'pointer')\n      .style('opacity', (d: string) => (store.getState().data.groupFilter.includes(d) ? 0.3 : 1))\n      .on('click', (d: string) => legendClick(d, store));\n\n    legends\n      .append('rect')\n      .attr('class', 'legend legend-color')\n      .attr('width', 10)\n      .attr('height', 10)\n      .attr('y', margin.top - 35)\n      .style('fill', (d: string) => getColor({ group: d } as Data, store) as string);\n\n    legends\n      .append('text')\n      .attr('class', 'legend legend-text')\n      .attr('x', 20)\n      .attr('y', margin.top - 25)\n      .html((d: string) => d);\n\n    let legendX = margin.left + titlePadding;\n    let legendY = 0;\n    legends.each(function () {\n      const wrapper = d3.select(this);\n      const text = wrapper.select('text') as any;\n      const bbox = text.node().getBBox();\n      if (legendX + bbox.width > width) {\n        legendX = margin.left + titlePadding;\n        legendY += 30;\n      }\n      wrapper.attr('transform', 'translate(' + legendX + ', ' + legendY + ')');\n      legendX += bbox.width + 40;\n    });\n\n    margin.top += legendY;\n  }\n}\n","export const elements = {\r\n  controls: 'controls',\r\n  skipBack: 'skipBack',\r\n  play: 'play',\r\n  pause: 'pause',\r\n  skipForward: 'skipForward',\r\n  overlay: 'overlay',\r\n  overlayPlay: 'overlayPlay',\r\n  overlayRepeat: 'overlayRepeat',\r\n};\r\n","export const buttons = {\n  skipBack: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M28.46,4a3,3,0,0,0-3,.07l-15.2,9.41A3,3,0,0,0,9,15V5A3,3,0,0,0,6,2H5A3,3,0,0,0,2,5V27a3,3,0,0,0,3,3H6a3,3,0,0,0,3-3V17a3,3,0,0,0,1.22,1.53L25.42,28a3,3,0,0,0,1.58.46,3,3,0,0,0,3-3V6.59A3,3,0,0,0,28.46,4Z\"/></g></svg>`,\n  play: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\n  pause: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns:svg=\"http://www.w3.org/2000/svg\"><g transform=\"translate(-17)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g><g transform=\"translate(-4)\"><path d=\"m 27,2 h -1 c -1.656854,0 -3,1.3431458 -3,3 v 12 c -0.04755,3.269656 0,6.666667 0,10 0,1.656854 1.343146,3 3,3 h 1 c 1.656854,0 3,-1.343146 3,-3 V 5 C 30,3.3431458 28.656854,2 27,2 Z\" /></g></svg>`,\n  skipForward: `<svg viewBox=\"0 0 32 32\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" fill=\"none\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M27,2H26a3,3,0,0,0-3,3V15a3,3,0,0,0-1.22-1.53L6.58,4A3,3,0,0,0,2,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,6.58,28l15.2-9.41A3,3,0,0,0,23,17V27a3,3,0,0,0,3,3h1a3,3,0,0,0,3-3V5A3,3,0,0,0,27,2Z\"/></g></svg>`,\n  overlayPlay: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M26.78,13.45,11.58,4A3,3,0,0,0,7,6.59V25.41a3,3,0,0,0,3,3A3,3,0,0,0,11.58,28l15.2-9.41a3,3,0,0,0,0-5.1Z\"/></g></svg>`,\n  overlayRepeat: `<svg viewBox=\"0 0 32 32\" fill=\"currentColor\" stroke=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\"><g><path d=\"M18,4A12,12,0,0,0,6.05,15H3a1,1,0,0,0-.88.53,1,1,0,0,0,0,1l4,6a1,1,0,0,0,1.66,0l4-6a1,1,0,0,0,.05-1A1,1,0,0,0,11,15H8.05A10,10,0,1,1,18,26a1,1,0,0,0,0,2A12,12,0,0,0,18,4Z\"/></g></svg>`,\n};\n","import * as d3 from '../d3';\n\nimport { Store } from '../store';\nimport { hideElement, showElement } from '../utils';\nimport { elements } from './elements';\nimport { buttons } from './buttons';\nimport { RenderOptions } from './render-options';\n\nexport function renderControls(store: Store, renderOptions: RenderOptions) {\n  const { marginTop, controlButtons } = store.getState().options;\n  const { root, width, margin, barPadding } = renderOptions;\n\n  const elementWidth = root.getBoundingClientRect().width;\n  const controlButtonIcons = [\n    { skipBack: buttons.skipBack },\n    { play: buttons.play },\n    { pause: buttons.pause },\n    { skipForward: buttons.skipForward },\n  ];\n\n  d3.select(root)\n    .append('div')\n    .classed('controls', true)\n    .style('position', 'absolute')\n    .style('top', marginTop + 'px')\n    .style('width', width)\n    .style('right', elementWidth - width + margin.right + barPadding + 'px')\n    .selectAll('div')\n    .data(controlButtonIcons)\n    .enter()\n    .append('div')\n    .html((d) => Object.values(d)[0] as string)\n    .attr('class', (d) => Object.keys(d)[0]);\n\n  if (controlButtons === 'play') {\n    hideElement(root, elements.skipBack);\n    hideElement(root, elements.skipForward);\n  }\n  if (controlButtons === 'none') {\n    hideElement(root, elements.controls);\n  }\n}\n\nexport function updateControls(store: Store, renderOptions: RenderOptions) {\n  const { overlays, loop } = store.getState().options;\n  const { root } = renderOptions;\n\n  if (store.getState().ticker.isRunning) {\n    showElement(root, elements.pause);\n    hideElement(root, elements.play);\n  } else {\n    showElement(root, elements.play);\n    hideElement(root, elements.pause);\n  }\n\n  if (\n    store.getState().ticker.isFirstDate &&\n    (overlays === 'all' || overlays === 'play') &&\n    !store.getState().ticker.isRunning\n  ) {\n    hideElement(root, elements.controls, true);\n    showElement(root, elements.overlay);\n    showElement(root, elements.overlayPlay);\n    hideElement(root, elements.overlayRepeat);\n  } else if (\n    store.getState().ticker.isLastDate &&\n    (overlays === 'all' || overlays === 'repeat') &&\n    !(loop && store.getState().ticker.isRunning)\n  ) {\n    hideElement(root, elements.controls, true);\n    showElement(root, elements.overlay);\n    showElement(root, elements.overlayRepeat);\n    hideElement(root, elements.overlayPlay);\n  } else {\n    showElement(root, elements.controls, true);\n    hideElement(root, elements.overlay);\n  }\n}\n\nexport function renderOverlays(store: Store, renderOptions: RenderOptions) {\n  const { minHeight, minWidth } = store.getState().options;\n  const { root } = renderOptions;\n\n  const overlayButtonIcons = [\n    { overlayPlay: buttons.overlayPlay },\n    { overlayRepeat: buttons.overlayRepeat },\n  ];\n\n  d3.select(root)\n    .append('div')\n    .classed('overlay', true)\n    .style('minHeight', minHeight + 'px')\n    .style('minWidth', minWidth + 'px')\n    .selectAll('div')\n    .data(overlayButtonIcons)\n    .enter()\n    .append('div')\n    .html((d) => Object.values(d)[0] as string)\n    .attr('class', (d) => Object.keys(d)[0]);\n}\n","import * as d3 from '../d3';\n\nimport { Store } from '../store';\nimport { Data } from '../data';\nimport { getDateSlice } from '../data-utils';\nimport { getText, getColor, safeName, getIconID } from '../utils';\nimport { RenderOptions } from './render-options';\nimport { calculateDimensions } from './calculate-dimensions';\nimport { renderHeader } from './render-header';\nimport { renderControls, renderOverlays, updateControls } from './controls';\nimport { selectFn, highlightFn, halo } from './helpers';\n\nexport function renderInitalView(data: Data[], store: Store, renderOptions: RenderOptions) {\n  const {\n    selector,\n    caption,\n    dateCounter,\n    labelsPosition,\n    showIcons,\n    fixedScale,\n    fixedOrder,\n  } = store.getState().options;\n  const dates = store.getState().ticker.dates;\n  renderOptions.lastDate = dates[0];\n\n  const root = (renderOptions.root = document.querySelector(selector) as HTMLElement);\n\n  const topN = fixedOrder.length > 0 ? fixedOrder.length : store.getState().options.topN;\n  const currentDate = store.getState().ticker.currentDate;\n  const CompleteDateSlice = getDateSlice(data, currentDate, store.getState().data.groupFilter);\n  const dateSlice = CompleteDateSlice.slice(0, topN);\n\n  if (!root || dateSlice.length === 0) return;\n\n  root.innerHTML = '';\n\n  renderInitialFrame();\n  renderControls(store, renderOptions);\n  renderOverlays(store, renderOptions);\n  updateControls(store, renderOptions);\n\n  function renderInitialFrame() {\n    renderOptions.maxValue = fixedScale\n      ? data.map((d) => d.value).reduce((max, val) => (max > val ? max : val), 0)\n      : (d3.max(dateSlice, (d: Data) => d.value) as number);\n\n    calculateDimensions(store, renderOptions);\n\n    const {\n      margin,\n      width,\n      height,\n      x,\n      y,\n      barWidth,\n      barHeight,\n      barY,\n      barHalfHeight,\n      labelX,\n      iconSize,\n      labelPadding,\n    } = renderOptions;\n\n    const svg: any = (renderOptions.svg = d3\n      .select(root)\n      .append('svg')\n      .attr('width', width)\n      .attr('height', height));\n\n    renderHeader(store, renderOptions, CompleteDateSlice);\n\n    const xAxis = (renderOptions.xAxis = d3\n      .axisTop(x)\n      .ticks(width > 500 ? 5 : 2)\n      .tickSize(-(height - (margin.top + margin.bottom)))\n      .tickFormat((n: number | { valueOf(): number }) => d3.format(',')(n)));\n\n    svg\n      .append('g')\n      .attr('class', 'axis xAxis')\n      .attr('transform', `translate(0, ${margin.top})`)\n      .call(xAxis)\n      .selectAll('.tick line')\n      .classed('origin', (d: unknown) => d === 0);\n\n    svg\n      .selectAll('rect.bar')\n      .data(dateSlice, (d: Data) => d.name)\n      .enter()\n      .append('rect')\n      .attr('class', (d: Data) => 'bar ' + safeName(d.name))\n      .classed('selected', (d: Data) => store.getState().data.selected.includes(d.name))\n      .attr('x', x(0) + 1)\n      .attr('width', barWidth)\n      .attr('y', barY)\n      .attr('height', barHeight)\n      .style('fill', (d: Data) => getColor(d, store))\n      .on('click', (d: Data) => selectFn(d, store, renderOptions))\n      .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\n      .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions));\n\n    svg\n      .selectAll('text.label')\n      .data(dateSlice, (d: Data) => d.name)\n      .enter()\n      .append('text')\n      .attr('class', 'label')\n      .classed('outside-bars', labelsPosition !== 'inside')\n      .attr('x', labelX)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight)\n      .style('text-anchor', 'end')\n      .html((d: Data) => d.name)\n      .on('click', (d: Data) => selectFn(d, store, renderOptions))\n      .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\n      .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions));\n\n    svg\n      .selectAll('text.valueLabel')\n      .data(dateSlice, (d: Data) => d.name)\n      .enter()\n      .append('text')\n      .attr('class', 'valueLabel')\n      .attr('x', (d: Data) => x(d.value) + 5)\n      .attr('y', (d: Data) => barY(d) + barHalfHeight)\n      .text((d: Data) => d3.format(',.0f')(d.lastValue as number));\n\n    if (showIcons) {\n      const defs = (renderOptions.defs = svg.append('svg:defs'));\n\n      defs\n        .selectAll('svg')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('svg:pattern')\n        .attr('class', 'svgpattern')\n        .attr('id', getIconID)\n        .attr('width', iconSize)\n        .attr('height', iconSize)\n        .append('svg:image')\n        .attr('xlink:href', (d: Data) => d.icon)\n        .attr('width', iconSize)\n        .attr('height', iconSize)\n        .attr('x', 0)\n        .attr('y', 0);\n\n      svg\n        .selectAll('circle')\n        .data(dateSlice, (d: Data) => d.name)\n        .enter()\n        .append('circle')\n        .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n        .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight)\n        .attr('r', iconSize / 2)\n        .style('fill', 'transparent')\n        .style('fill', (d: Data) => `url(#${getIconID(d)})`);\n    }\n\n    const endY = height - margin.bottom;\n    const endX = width - margin.right;\n    const dateCounterTextY = caption ? endY - 30 : endY - 5;\n    renderOptions.dateCounterText = svg\n      .append('text')\n      .attr('class', 'dateCounterText')\n      .attr('x', endX)\n      .attr('y', dateCounterTextY)\n      .style('text-anchor', 'end')\n      .html(getText(dateCounter, currentDate, CompleteDateSlice, dates, true))\n      .call((text: any) => halo(text, renderOptions));\n\n    renderOptions.captionText = svg\n      .append('text')\n      .attr('class', 'caption')\n      .attr('x', endX - 10)\n      .attr('y', endY - 5)\n      .style('text-anchor', 'end')\n      .html(getText(caption, currentDate, CompleteDateSlice, dates));\n  }\n}\n","import * as d3 from '../d3';\n\nimport { Data } from '../data';\nimport { Store } from '../store';\nimport { getDateSlice } from '../data-utils';\nimport { safeName, getColor, getIconID, getText } from '../utils';\nimport { RenderOptions } from './render-options';\nimport { selectFn, highlightFn, halo } from './helpers';\nimport { updateControls } from './controls';\n\nexport function renderFrame(data: Data[], store: Store, renderOptions: RenderOptions) {\n  const {\n    svg,\n    titleText,\n    subTitleText,\n    dateCounterText,\n    captionText,\n    x,\n    y,\n    xAxis,\n    labelPadding,\n    barWidth,\n    barHeight,\n    barHalfHeight,\n    barY,\n    iconSize,\n    labelX,\n    defs,\n    lastDate,\n  } = renderOptions;\n  const dates = store.getState().ticker.dates;\n  const { showGroups } = store.getState().options;\n\n  if (!x) {\n    return;\n  }\n\n  const {\n    tickDuration,\n    title,\n    subTitle,\n    caption,\n    dateCounter,\n    marginBottom,\n    fixedScale,\n    fixedOrder,\n    labelsPosition,\n  } = store.getState().options;\n\n  const topN = fixedOrder.length > 0 ? fixedOrder.length : store.getState().options.topN;\n  const currentDate = store.getState().ticker.currentDate;\n  const CompleteDateSlice = getDateSlice(data, currentDate, store.getState().data.groupFilter);\n  const dateSlice = CompleteDateSlice.slice(0, topN);\n\n  if (showGroups) {\n    svg\n      .selectAll('.legend-wrapper')\n      .style('opacity', (d: string) => (store.getState().data.groupFilter.includes(d) ? 0.3 : 1));\n  }\n\n  if (!fixedScale) {\n    x.domain([0, d3.max(dateSlice, (d: Data) => d.value) as number]);\n\n    svg //\n      .select('.xAxis')\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .call(xAxis);\n  }\n\n  const bars = svg //\n    .selectAll('.bar')\n    .data(dateSlice, (d: Data) => d.name);\n\n  bars\n    .enter()\n    .append('rect')\n    .attr('class', (d: Data) => 'bar ' + safeName(d.name))\n    .classed('selected', (d: Data) => store.getState().data.selected.includes(d.name))\n    .attr('x', x(0) + 1)\n    .attr('width', barWidth)\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\n    .attr('height', barHeight)\n    .style('fill', (d: Data) => getColor(d, store))\n    .on('click', (d: Data) => selectFn(d, store, renderOptions))\n    .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\n    .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions))\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('y', barY);\n\n  bars\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n    .attr('y', barY);\n\n  bars\n    .exit()\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('width', (d: Data) => Math.abs(x(d.value) - x(0) - 1))\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\n    .remove();\n\n  const labels = svg //\n    .selectAll('.label')\n    .data(dateSlice, (d: Data) => d.name);\n\n  labels\n    .enter()\n    .append('text')\n    .attr('class', 'label')\n    .classed('outside-bars', labelsPosition !== 'inside')\n    .attr('x', labelX)\n    .attr('y', () => y(topN + 1) + marginBottom + 5 + barHalfHeight)\n    .style('text-anchor', 'end')\n    .html((d: Data) => d.name)\n    .on('click', (d: Data) => selectFn(d, store, renderOptions))\n    .on('mouseover', (d: Data) => highlightFn(d, store, renderOptions))\n    .on('mouseout', (d: Data) => highlightFn(d, store, renderOptions))\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('y', (d: Data) => barY(d) + barHalfHeight);\n\n  labels\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('x', labelX)\n    .attr('y', (d: Data) => barY(d) + barHalfHeight);\n\n  labels\n    .exit()\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('x', labelX)\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\n    .remove();\n\n  const valueLabels = svg //\n    .selectAll('.valueLabel')\n    .data(dateSlice, (d: Data) => d.name);\n\n  valueLabels\n    .enter()\n    .append('text')\n    .attr('class', 'valueLabel')\n    .attr('x', (d: Data) => x(d.value) + 5)\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\n    .text((d: Data) => d3.format(',.0f')(d.lastValue as number))\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('y', (d: Data) => barY(d) + barHalfHeight);\n\n  const sameDate = lastDate === currentDate;\n  valueLabels\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('x', (d: Data) => x(d.value) + 5)\n    .attr('y', (d: Data) => barY(d) + barHalfHeight)\n    .tween('text', function (d: Data) {\n      const lastValue = sameDate ? d.value : (d.lastValue as number);\n      const i = d3.interpolateRound(lastValue, d.value);\n      return function (t: number) {\n        this.textContent = d3.format(',')(i(t));\n      };\n    });\n\n  valueLabels\n    .exit()\n    .transition()\n    .duration(tickDuration)\n    .ease(d3.easeLinear)\n    .attr('x', (d: Data) => x(d.value) + 5)\n    .attr('y', () => y(topN + 1) + marginBottom + 5)\n    .remove();\n\n  if (store.getState().options.showIcons) {\n    const iconPatterns = defs.selectAll('.svgpattern').data(dateSlice, (d: Data) => d.name);\n\n    iconPatterns\n      .enter()\n      .append('svg:pattern')\n      .attr('class', 'svgpattern')\n      .attr('id', getIconID)\n      .attr('width', iconSize)\n      .attr('height', iconSize)\n      .append('svg:image')\n      .attr('xlink:href', (d: Data) => d.icon)\n      .attr('width', iconSize)\n      .attr('height', iconSize)\n      .style('z-index', '99')\n      .attr('x', 0)\n      .attr('y', 0);\n\n    iconPatterns //\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .remove();\n\n    const icons = svg //\n      .selectAll('circle')\n      .data(dateSlice, (d: Data) => d.name);\n\n    icons\n      .enter()\n      .append('circle')\n      .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n      .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\n      .attr('r', iconSize / 2)\n      .style('z-index', '99')\n      .style('fill', 'transparent')\n      .style('fill', (d: Data) => `url(#${getIconID(d)})`)\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\n\n    icons\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n      .attr('cy', (d: Data) => y(d.rank as number) + barHalfHeight);\n\n    icons\n      .exit()\n      .transition()\n      .duration(tickDuration)\n      .ease(d3.easeLinear)\n      .attr('cx', (d: Data) => x(d.value) - iconSize / 2 - labelPadding)\n      .attr('cy', () => y(topN + 1) + iconSize + barHalfHeight)\n      .remove();\n  }\n\n  titleText.html(getText(title, currentDate, CompleteDateSlice, dates));\n  subTitleText.html(getText(subTitle, currentDate, CompleteDateSlice, dates));\n  captionText.html(getText(caption, currentDate, CompleteDateSlice, dates));\n  dateCounterText\n    .html(getText(dateCounter, currentDate, CompleteDateSlice, dates, true))\n    .call((text: any) => halo(text, renderOptions));\n\n  updateControls(store, renderOptions);\n\n  renderOptions.lastDate = currentDate;\n}\n","import { getHeight, getWidth } from '../utils';\nimport { Store } from '../store';\nimport { Data } from '../data';\nimport { RenderOptions } from './render-options';\nimport { renderInitalView } from './render-initial-view';\nimport { renderFrame } from './render-frame';\nimport { updateControls } from './controls';\n\nexport function resize(data: Data[], store: Store, renderOptions: RenderOptions) {\n  const { inputHeight, inputWidth, minHeight, minWidth } = store.getState().options;\n  const { root } = renderOptions;\n\n  if (!root) return;\n\n  if (\n    (!inputHeight && !inputWidth) ||\n    String(inputHeight).startsWith('window') ||\n    String(inputWidth).startsWith('window')\n  ) {\n    renderOptions.height = getHeight(root, minHeight, inputHeight);\n    renderOptions.width = getWidth(root, minWidth, inputWidth);\n\n    const currentPosition = root.style.position; // \"fixed\" if scrolling\n\n    renderInitalView(data, store, renderOptions);\n    renderFrame(data, store, renderOptions);\n    updateControls(store, renderOptions);\n\n    root.style.position = currentPosition;\n  }\n}\n","import { Renderer } from '../models';\nimport { Data } from '../data';\nimport { Store } from '../store';\nimport { renderInitalView } from './render-initial-view';\nimport { renderFrame } from './render-frame';\nimport { resize } from './resize';\nimport { RenderOptions } from './render-options';\n\nexport function createRenderer(data: Data[], store: Store): Renderer {\n  const renderOptions = {} as RenderOptions;\n\n  return {\n    renderInitalView: () => renderInitalView(data, store, renderOptions),\n    renderFrame: () => renderFrame(data, store, renderOptions),\n    resize: () => resize(data, store, renderOptions),\n  };\n}\n","// This file is auto-generated and will be over-written!\n// Please do NOT edit this file directly\n// You may edit files in this folder instead: src\\lib\\css\n\nexport const styles = `\n__selector__ text {\n  font-size: 16px;\n  font-family: Open Sans, sans-serif;\n}\n\n__selector__ text.title {\n  font-size: 24px;\n  font-weight: 500;\n}\n\n__selector__ text.subTitle {\n  font-weight: 500;\n}\n\n__selector__ text.caption {\n  font-weight: 400;\n  font-size: 24px;\n}\n__selector__ text.legend-text {\n  user-select: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n}\n__selector__ text.label {\n  font-weight: 600;\n}\n\n__selector__ text.valueLabel {\n  font-weight: 300;\n}\n\n__selector__ text.dateCounterText {\n  font-size: 64px;\n  font-weight: 700;\n}\n\n__selector__ .xAxis .tick:nth-child(2) text {\n  text-anchor: start;\n}\n\n__selector__ .tick line {\n  shape-rendering: CrispEdges;\n}\n\n__selector__ path.domain {\n  display: none;\n}\n\n__selector__ {\n  position: relative;\n}\n\n__selector__ .controls {\n  /*  position is set dynamically in renderer.ts */\n  display: flex;\n}\n\n__selector__ .controls div,\n__selector__ .overlay div {\n  cursor: pointer;\n  font-size: 24px;\n  font-weight: 700;\n  width: 38px;\n  height: 38px;\n  -moz-border-radius: 5px;\n  -webkit-border-radius: 5px;\n  border-radius: 5px;\n  margin: 5px;\n  text-align: center;\n}\n\n__selector__ .controls svg {\n  margin: 5px auto;\n  width: 28px;\n  height: 28px;\n}\n\n__selector__ .overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n__selector__ .overlay div {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 200px;\n  height: 200px;\n  -moz-border-radius: 100px;\n  -webkit-border-radius: 100px;\n  border-radius: 100px;\n}\n__selector__ .overlay svg {\n  height: 50%;\n  width: 50%;\n}\n`;\n\nexport const themes = {\n\"dark\": `\n__selector__ {\r\n  background-color: #313639;\r\n}\r\n\r\n__selector__ text.title {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ text.subTitle {\r\n  fill: #cccccc;\r\n}\r\n\r\n__selector__ text.dateCounterText {\r\n  fill: #cccccc;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.caption {\r\n  fill: #cccccc;\r\n}\r\n\r\n__selector__ .halo {\r\n  fill: #313639;\r\n  stroke: #313639;\r\n  stroke-width: 10;\r\n  stroke-linejoin: round;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.legend-text {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ text.label {\r\n  fill: #313639;\r\n}\r\n\r\n__selector__ text.label.outside-bars {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ text.valueLabel {\r\n  fill: #fafafa;\r\n}\r\n\r\n__selector__ .tick text {\r\n  fill: #cccccc;\r\n}\r\n\r\n__selector__ .tick line {\r\n  shape-rendering: CrispEdges;\r\n  stroke: #dddddd;\r\n}\r\n\r\n__selector__ .tick line.origin {\r\n  stroke: #aaaaaa;\r\n}\r\n\r\n__selector__ .controls div,\r\n__selector__ .overlay div {\r\n  color: #ffffff;\r\n  background: #777777;\r\n  border: 1px solid black;\r\n  opacity: 0.5;\r\n}\r\n\r\n__selector__ .controls div:hover,\r\n__selector__ .overlay div:hover {\r\n  background: #aaaaaa;\r\n  color: black;\r\n}\r\n\r\n__selector__ .overlay {\r\n  background-color: black;\r\n  opacity: 0.7;\r\n}\r\n\r\n__selector__ .highlight {\r\n  fill: #ff2727 !important;\r\n}\r\n\r\n__selector__ .selected {\r\n  fill: #d12020 !important;\r\n  stroke: #777777 !important;\r\n  stroke-width: 1 !important;\r\n}\r\n`,\n\"light\": `\n/* __selector__ {\r\n  background-color: #ffffff;\r\n}\r\n\r\n__selector__ text.title {\r\n  fill: #fafafa;\r\n} */\r\n\r\n__selector__ text.subTitle {\r\n  fill: #777777;\r\n}\r\n\r\n__selector__ text.dateCounterText {\r\n  fill: #bbbbbb;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.caption {\r\n  fill: #777777;\r\n}\r\n\r\n__selector__ .halo {\r\n  fill: #ffffff;\r\n  stroke: #ffffff;\r\n  stroke-width: 10;\r\n  stroke-linejoin: round;\r\n  opacity: 1;\r\n}\r\n\r\n__selector__ text.legend-text {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ text.label {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ text.label.outside-bars {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ text.valueLabel {\r\n  fill: #000000;\r\n}\r\n\r\n__selector__ .tick text {\r\n  fill: #777777;\r\n}\r\n\r\n__selector__ .tick line {\r\n  shape-rendering: CrispEdges;\r\n  stroke: #dddddd;\r\n}\r\n\r\n__selector__ .tick line.origin {\r\n  stroke: #aaaaaa;\r\n}\r\n\r\n__selector__ .controls div,\r\n__selector__ .overlay div {\r\n  color: #ffffff;\r\n  background: #777777;\r\n  border: 1px solid black;\r\n  opacity: 0.5;\r\n}\r\n\r\n__selector__ .controls div:hover,\r\n__selector__ .overlay div:hover {\r\n  background: #aaaaaa;\r\n  color: black;\r\n}\r\n\r\n__selector__ .overlay {\r\n  background-color: black;\r\n  opacity: 0.7;\r\n}\r\n\r\n__selector__ .highlight {\r\n  fill: #ff2727 !important;\r\n}\r\n\r\n__selector__ .selected {\r\n  fill: #d12020 !important;\r\n  stroke: #777777 !important;\r\n  stroke-width: 1 !important;\r\n}\r\n`,\n};\n","import { styles, themes } from './generated-styles';\r\n\r\n// modifed from https://github.com/egoist/style-inject\r\nexport function styleInject(selector: string, theme: string, insertAt = 'top') {\r\n  let css = styles + (themes as any)[theme];\r\n\r\n  if (!css || typeof document === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  // replace with selector\r\n  css = css.split('__selector__').join(selector);\r\n\r\n  const head = document.head || document.getElementsByTagName('head')[0];\r\n  const style = document.createElement('style') as HTMLStyleElement | any;\r\n  style.type = 'text/css';\r\n\r\n  if (insertAt === 'top') {\r\n    if (head.firstChild) {\r\n      head.insertBefore(style, head.firstChild);\r\n    } else {\r\n      head.appendChild(style);\r\n    }\r\n  } else {\r\n    head.appendChild(style);\r\n  }\r\n\r\n  if (style.styleSheet) {\r\n    style.styleSheet.cssText = css;\r\n  } else {\r\n    style.appendChild(document.createTextNode(css));\r\n  }\r\n}\r\n","import { elements } from './renderer';\nimport { Store } from './store';\nimport { Ticker } from './ticker';\nimport { hideElement, getElement, getClicks } from './utils';\nimport { DOMCustomEvent } from './models';\n\nexport function registerEvents(store: Store, ticker: Ticker) {\n  const root = document.querySelector(store.getState().options.selector) as HTMLElement;\n\n  registerControlButtonEvents();\n  registerOverlayEvents();\n  registerClickEvents();\n  registerKeyboardEvents();\n\n  function registerControlButtonEvents() {\n    addEventHandler(root, elements.skipBack, 'click', () => {\n      ticker.skipBack('skipBackButton');\n    });\n    addEventHandler(root, elements.play, 'click', () => {\n      ticker.start('playButton');\n    });\n    addEventHandler(root, elements.pause, 'click', () => {\n      ticker.stop('pauseButton');\n    });\n    addEventHandler(root, elements.skipForward, 'click', () => {\n      ticker.skipForward('skipForwardButton');\n    });\n  }\n\n  function registerOverlayEvents() {\n    addEventHandler(root, elements.overlayPlay, 'click', () => {\n      hideElement(root, elements.overlay);\n      ticker.start('playOverlay');\n    });\n    addEventHandler(root, elements.overlayRepeat, 'click', () => {\n      hideElement(root, elements.overlay);\n      ticker.skipBack('repeatOverlay');\n      ticker.start('repeatOverlay');\n    });\n  }\n\n  function registerClickEvents() {\n    if (store.getState().options.mouseControls) {\n      const svg = root.querySelector('svg') as SVGSVGElement;\n      svg.addEventListener('click', (clickEvent) => {\n        // ignore clicks to group legends\n        const target = clickEvent.target as HTMLElement;\n        if (!target || target.classList.contains('legend')) return;\n\n        getClicks(clickEvent, function (event: any) {\n          const clicks = event.detail;\n          if (clicks === 3) {\n            ticker.skipBack('mouseTripleClick');\n          } else if (clicks === 2) {\n            ticker.skipForward('mouseDoubleClick');\n          } else {\n            ticker.toggle('mouseClick');\n          }\n        });\n      });\n    }\n  }\n\n  function registerKeyboardEvents() {\n    if (store.getState().options.keyboardControls) {\n      document.addEventListener('keypress', function (e) {\n        // ignore keyboard when user is typing in input or textarea\n        const target = document.activeElement;\n        if (target && ['input', 'textarea'].includes(target.tagName.toLowerCase())) return;\n\n        const keyCodes = {\n          spacebar: 32,\n          A: 97,\n          S: 115,\n          D: 100,\n        };\n\n        // TODO: keyCode is deprecated\n        switch (e.keyCode) {\n          case keyCodes.spacebar:\n            ticker.toggle('keyboardToggle');\n            e.preventDefault(); // prevent scroll triggered by spacebar\n            break;\n          case keyCodes.A:\n            ticker.skipBack('keyboardSkipBack');\n            break;\n          case keyCodes.S:\n            ticker.toggle('keyboardToggle');\n            break;\n          case keyCodes.D:\n            ticker.skipForward('keyboardSkipForward');\n            break;\n        }\n      });\n    }\n  }\n}\n\nexport function addEventHandler(\n  root: HTMLElement,\n  className: string,\n  event: string,\n  handler: () => void,\n) {\n  const element = getElement(root, className);\n  if (element) {\n    element.addEventListener(event, handler);\n  }\n}\n\nfunction dispatchDOMEvent(store: Store) {\n  const element = document.querySelector(store.getState().options.selector) as HTMLElement;\n  if (!element) {\n    return;\n  }\n  element.dispatchEvent(\n    new CustomEvent('racingBars/dateChanged', {\n      bubbles: true,\n      detail: {\n        date: store.getState().ticker.currentDate,\n        isFirst: store.getState().ticker.isFirstDate,\n        isLast: store.getState().ticker.isLastDate,\n      },\n    } as DOMCustomEvent),\n  );\n}\n\nexport function DOMEventSubscriber(store: Store) {\n  let lastDate = '';\n  return function () {\n    const currentDate = store.getState().ticker.currentDate;\n    if (currentDate !== lastDate) {\n      dispatchDOMEvent(store);\n      lastDate = currentDate;\n    }\n  };\n}\n","import { actions, Store } from './store';\r\n\r\nexport function createScroller(element: HTMLElement, store: Store) {\r\n  const dates = store.getState().ticker.dates;\r\n  prepareDOM();\r\n\r\n  const step = document.body.clientHeight / dates.length;\r\n\r\n  subscribeToEvents();\r\n\r\n  function prepareDOM() {\r\n    element.style.position = 'fixed';\r\n    element.style.top = '0';\r\n\r\n    const scrollElement = document.createElement('div');\r\n    scrollElement.style.height = window.innerHeight * 10 + 'px';\r\n    document.body.appendChild(scrollElement);\r\n  }\r\n\r\n  function subscribeToEvents() {\r\n    window.addEventListener('scroll', goToDate);\r\n    // element.addEventListener(\"dateChanged\", scrollToPosition);\r\n  }\r\n\r\n  // function scrollToPosition(e: CustomEvent) {\r\n  //   let currentDate = getDateString(e.detail.date);\r\n  //   let index = dates.indexOf(currentDate);\r\n  //   ignoreNextScrollEvent = true;\r\n  //   window.scroll({\r\n  //     top: index * step,\r\n  //     behavior: \"smooth\",\r\n  //   });\r\n  // }\r\n\r\n  function goToDate() {\r\n    const index = Math.ceil(window.pageYOffset / step);\r\n    if (index < dates.length) {\r\n      store.dispatch(actions.ticker.updateDate(dates[index], 'scroll'));\r\n    } else {\r\n      store.dispatch(actions.ticker.setLast('scroll'));\r\n    }\r\n  }\r\n}\r\n","import * as d3 from './d3';\nimport { prepareData } from './data-utils';\nimport { getDateString } from './dates';\nimport { Data, WideData } from './data';\nimport { createRenderer } from './renderer';\nimport { createTicker } from './ticker';\nimport { styleInject } from './styles';\nimport { actions, createStore, rootReducer } from './store';\nimport { Options } from './options';\nimport { registerEvents, DOMEventSubscriber } from './events';\nimport { createScroller } from './scroller';\nimport { safeName } from './utils';\nimport { Race } from './models';\n\nexport function race(data: Data[] | WideData[], options: Partial<Options> = {}): Race {\n  const store = createStore(rootReducer);\n\n  store.dispatch(actions.options.optionsLoaded(options));\n  const { selector, injectStyles, theme, autorun } = store.getState().options;\n\n  const root = document.querySelector(selector) as HTMLElement;\n  if (!root) {\n    return (undefined as unknown) as Race;\n  }\n\n  if (injectStyles) {\n    styleInject(selector, theme, 'top');\n  }\n\n  const preparedData = prepareData(data as Data[], store);\n\n  const ticker = createTicker(store);\n\n  const renderer = createRenderer(preparedData, store);\n  renderer.renderInitalView();\n\n  store.subscribe(renderer.renderFrame);\n  store.subscribe(DOMEventSubscriber(store));\n\n  ticker.start('loaded');\n\n  if (!autorun) {\n    ticker.stop('loaded');\n  }\n\n  registerEvents(store, ticker);\n  window.addEventListener('resize', resize);\n\n  function resize() {\n    renderer.resize();\n    registerEvents(store, ticker);\n  }\n\n  let destroyed = false;\n  function destroy() {\n    ticker.stop('destroy');\n    store.unubscribeAll();\n    window.removeEventListener('resize', resize);\n    root.innerHTML = '';\n    destroyed = true;\n  }\n\n  return {\n    // TODO: validate user input\n    start: () => {\n      if (destroyed) return;\n      if (!store.getState().ticker.isRunning) {\n        ticker.start('apiStart');\n      }\n    },\n    stop: () => {\n      if (destroyed) return;\n      ticker.stop('apiStop');\n    },\n    rewind: () => {\n      if (destroyed) return;\n      ticker.skipBack('apiSkipBack');\n    },\n    fastforward: () => {\n      if (destroyed) return;\n      ticker.skipForward('apiSkipForward');\n    },\n    loop: () => {\n      if (destroyed) return;\n      ticker.loop();\n    },\n    inc: (value = 1) => {\n      if (destroyed) return;\n      store.dispatch(actions.ticker.inc('apiInc', value));\n    },\n    dec: (value = 1) => {\n      if (destroyed) return;\n      store.dispatch(actions.ticker.dec('apiDec', value));\n    },\n    getDate: () => (destroyed ? '' : store.getState().ticker.currentDate),\n    setDate: (inputDate: string | Date) => {\n      if (destroyed) return;\n      store.dispatch(actions.ticker.updateDate(getDateString(inputDate), 'apiSetDate'));\n    },\n    getAllDates: () => (destroyed ? [''] : [...store.getState().ticker.dates]),\n    createScroller: () => {\n      if (destroyed) return;\n      createScroller(root, store);\n    },\n    selections: {\n      select: (name: string) => {\n        if (destroyed) return;\n        d3.select(root)\n          .select('rect.' + safeName(name))\n          .classed('selected', true);\n        store.dispatch(actions.data.addSelection(name));\n      },\n      unselect: (name: string) => {\n        if (destroyed) return;\n        d3.select(root)\n          .select('rect.' + safeName(name))\n          .classed('selected', false);\n        store.dispatch(actions.data.removeSelection(name));\n      },\n      unselectAll: () => {\n        if (destroyed) return;\n        d3.select(root).selectAll('rect').classed('selected', false);\n        store.dispatch(actions.data.resetSelections());\n      },\n    },\n    groups: {\n      hide: (group: string) => {\n        if (destroyed) return;\n        store.dispatch(actions.data.addFilter(group));\n      },\n      show: (group: string) => {\n        if (destroyed) return;\n        store.dispatch(actions.data.removeFilter(group));\n      },\n      showOnly: (group: string) => {\n        if (destroyed) return;\n        store.dispatch(actions.data.allExceptFilter(group));\n      },\n      showAll: () => {\n        if (destroyed) return;\n        store.dispatch(actions.data.resetFilters());\n      },\n    },\n    destroy: () => {\n      if (destroyed) return;\n      destroy();\n    },\n  };\n}\n"],"names":["loadData","URL","type","d3","Error","getColor","d","store","getState","data","names","groups","options","showGroups","colorSeed","colorMap","color","useGroup","Boolean","group","length","values","shuffle","toNumber","currentValue","name","index","indexOf","Array","isArray","negativeIfOdd","lumVariation","random","HueSpacing","hue","getIconID","safeName","zeroPad","n","w","toString","s","String","nums","i","charCodeAt","InputSeed","seed","x","Math","sin","floor","arr","array","m","t","getHeight","element","minHeight","height","newHeight","getBoundingClientRect","startsWith","scale","split","window","innerHeight","getWidth","minWidth","width","newWidth","innerWidth","getElement","root","className","querySelector","showElement","useVisibility","style","visibility","display","hideElement","getText","param","currentDate","dateSlice","dates","isDate","formatDate","replace","toggleClass","selector","select","classed","debounce","func","wait","immediate","timeout","_clicks","_Fn","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","getClicks","event","Fn","getDates","from","Set","map","date","sort","getDateString","inputDate","Date","isNaN","year","getFullYear","month","getMonth","day","getDate","dateStr","format","slice","weekDayIndex","getDay","monthNames","weekDays","getDateRange","date1","date2","interval","range","daysInMonth","sameDay","sameMonth","numberOfMonths","count","numberOfYears","outputRange","filter","round","actionTypes","dataLoaded","addFilter","removeFilter","toggleFilter","resetFilters","allExceptFilter","addSelection","removeSelection","toggleSelection","resetSelections","dataCollections","payload","selection","initialState","groupFilter","selected","dataReducer","state","action","collections","addToArray","removeFromArray","toggleItem","item","includes","push","optionsLoaded","changeOptions","optionsChanged","dataShape","dataTransform","fillDateGapsInterval","fillDateGapsValue","startDate","endDate","tickDuration","topN","mouseControls","keyboardControls","autorun","loop","injectStyles","title","subTitle","caption","dateCounter","labelsPosition","labelsWidth","showIcons","controlButtons","overlays","inputHeight","inputWidth","marginTop","marginRight","marginBottom","marginLeft","theme","fixedScale","fixedOrder","highlightBars","selectBars","optionsReducer","excludedKeys","Object","keys","forEach","key","Number","initialize","updateDate","setRunning","setFirst","setLast","inc","dec","running","value","isRunning","isFirstDate","isLastDate","tickerReducer","currentIndex","lastIndex","incValue","newDate","decValue","createTicker","ticker","start","showRace","dispatch","actions","_","stop","skipBack","skipForward","toggle","goToDate","rootReducer","createStore","reducer","preloadedState","notifySubscribers","subscribers","subscribe","fn","unsubscribe","splice","unubscribeAll","prepareData","rawData","wideDataToLong","rank","a","b","localeCompare","fillGaps","calculateLastValues","storeDataCollections","reduce","acc","curr","lastValue","last","wide","nested","long","row","entries","longDataToWide","dateRow","r","details","fillValue","wideData","allData","lastDate","rangeStep","iData","interpolateTopN","newData","j","newRow","data1","data2","topData1","getTopN","topData2","topNames","filteredData1","obj","filteredData2","getDateSlice","emptyData","calculateDimensions","renderOptions","maxValue","titlePadding","titleHeight","subTitleHeight","groupsHeight","controlsHeight","headerHeight","max","labelsArea","topAxisPadding","margin","top","right","bottom","left","domain","y","barPadding","labelPadding","barWidth","abs","barHeight","barHalfHeight","barY","iconSize","iconSpace","labelX","halo","text","svg","selectAll","remove","parentNode","insertBefore","cloneNode","legendClick","clicks","detail","highlightFn","selectFn","renderHeader","CompleteDateSlice","titleText","append","attr","html","subTitleText","legendsWrapper","legends","enter","on","legendX","legendY","each","wrapper","bbox","node","getBBox","elements","controls","play","pause","overlay","overlayPlay","overlayRepeat","buttons","renderControls","elementWidth","controlButtonIcons","updateControls","renderOverlays","overlayButtonIcons","renderInitalView","document","innerHTML","renderInitialFrame","val","xAxis","ticks","tickSize","tickFormat","call","defs","icon","endY","endX","dateCounterTextY","dateCounterText","captionText","renderFrame","transition","duration","ease","bars","exit","labels","valueLabels","sameDate","tween","textContent","iconPatterns","icons","resize","currentPosition","position","createRenderer","styles","themes","styleInject","insertAt","css","join","head","getElementsByTagName","createElement","firstChild","appendChild","styleSheet","cssText","createTextNode","registerEvents","registerControlButtonEvents","registerOverlayEvents","registerClickEvents","registerKeyboardEvents","addEventHandler","addEventListener","clickEvent","target","classList","contains","e","activeElement","tagName","toLowerCase","keyCodes","spacebar","A","S","D","keyCode","preventDefault","handler","dispatchDOMEvent","dispatchEvent","CustomEvent","bubbles","isFirst","isLast","DOMEventSubscriber","createScroller","prepareDOM","step","body","clientHeight","subscribeToEvents","scrollElement","ceil","pageYOffset","race","undefined","preparedData","renderer","destroyed","destroy","removeEventListener","rewind","fastforward","setDate","getAllDates","selections","unselect","unselectAll","hide","show","showOnly","showAll"],"mappings":"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"}